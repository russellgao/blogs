[{"categories":null,"content":"openresty é…ç½®æ–‡ä»¶ ï¼ˆä¸€ï¼‰","date":"2020-11-22","objectID":"/openresty-nginx.conf/","tags":["nginx","openresty","nginx.conf"],"title":"openresty é…ç½®æ–‡ä»¶ ï¼ˆä¸€ï¼‰","uri":"/openresty-nginx.conf/"},{"categories":null,"content":"å¯¼è¯» openrestyï¼ˆnginx plusï¼‰ åœ¨æ—¥å¸¸å·¥ä½œä¸­ç”¨çš„åº”è¯¥æ¯”è¾ƒå¤šï¼Œè¦æƒ³çœŸæ­£äº†è§£æ¸…æ¥šå…¶åŸç†å¹¶ä¸å®¹æ˜“ã€‚æˆ‘å°è¯•ç€ä»é…ç½®çš„è§’åº¦å»åˆ†æ nginx çš„åŸºæœ¬åŸç†ã€‚è¿™ç¯‡ä¸»è¦ä»‹ç» nginx.conf è¿™ä¸ªé…ç½®æ–‡ä»¶ï¼Œåç»­å†ä»‹ç»å…¶ä»–çš„é…ç½®æ–‡ä»¶ã€‚ nginx.conf ä¸­ä¸»è¦é…ç½®å…¨å±€é…ç½®ï¼Œé…ç½®å¥½ä¹‹åä¸€èˆ¬å¾ˆå°‘æ”¹åŠ¨ã€‚ ","date":"2020-11-22","objectID":"/openresty-nginx.conf/:1:0","tags":["nginx","openresty","nginx.conf"],"title":"openresty é…ç½®æ–‡ä»¶ ï¼ˆä¸€ï¼‰","uri":"/openresty-nginx.conf/"},{"categories":null,"content":"nginx.conf é…ç½®é¡¹è¯´æ˜ #å®šä¹‰Nginxè¿è¡Œçš„ç”¨æˆ·å’Œç”¨æˆ·ç»„ #user nobody; #nginxè¿›ç¨‹æ•°ï¼Œå»ºè®®è®¾ç½®ä¸ºç­‰äºCPUæ€»æ ¸å¿ƒæ•°ã€‚ worker_processes 1; #å…¨å±€é”™è¯¯æ—¥å¿—å®šä¹‰ç±»å‹ï¼Œ[ debug | info | notice | warn | error | crit ] #error_log logs/error.log; #error_log logs/error.log notice; #error_log logs/error.log info; #è¿›ç¨‹æ–‡ä»¶ #pid logs/nginx.pid; #æŒ‡å®šè¿›ç¨‹å¯ä»¥æ‰“å¼€çš„æœ€å¤§æè¿°ç¬¦ #å·¥ä½œæ¨¡å¼ä¸è¿æ¥æ•°ä¸Šé™ ##è¿™ä¸ªæŒ‡ä»¤æ˜¯æŒ‡å½“ä¸€ä¸ªnginxè¿›ç¨‹æ‰“å¼€çš„æœ€å¤šæ–‡ä»¶æè¿°ç¬¦æ•°ç›®ï¼Œç†è®ºå€¼åº”è¯¥æ˜¯æœ€å¤šæ‰“å¼€æ–‡ä»¶æ•°ï¼ˆulimit -nï¼‰ä¸nginxè¿›ç¨‹æ•°ç›¸é™¤ï¼Œä½†æ˜¯nginxåˆ†é…è¯·æ±‚å¹¶ä¸æ˜¯é‚£ä¹ˆå‡åŒ€ï¼Œæ‰€ä»¥æœ€å¥½ä¸ulimit -n çš„å€¼ä¿æŒä¸€è‡´ã€‚ #è¿™æ˜¯å› ä¸ºnginxè°ƒåº¦æ—¶åˆ†é…è¯·æ±‚åˆ°è¿›ç¨‹å¹¶ä¸æ˜¯é‚£ä¹ˆçš„å‡è¡¡ï¼Œæ‰€ä»¥å‡å¦‚å¡«å†™10240ï¼Œæ€»å¹¶å‘é‡è¾¾åˆ°3-4ä¸‡æ—¶å°±æœ‰è¿›ç¨‹å¯èƒ½è¶…è¿‡10240äº†ï¼Œè¿™æ—¶ä¼šè¿”å›502é”™è¯¯ã€‚ worker_rlimit_nofile 65535; events { #å‚è€ƒäº‹ä»¶æ¨¡å‹ï¼Œuse [ kqueue | rtsig | epoll | /dev/poll | select | poll ]; epollæ¨¡å‹ #æ˜¯Linux 2.6ä»¥ä¸Šç‰ˆæœ¬å†…æ ¸ä¸­çš„é«˜æ€§èƒ½ç½‘ç»œI/Oæ¨¡å‹ï¼Œlinuxå»ºè®®epollï¼Œå¦‚æœè·‘åœ¨FreeBSDä¸Šé¢ï¼Œå°±ç”¨kqueueæ¨¡å‹ã€‚ #è¡¥å……è¯´æ˜ï¼š #ä¸apacheç›¸ç±»ï¼Œnginxé’ˆå¯¹ä¸åŒçš„æ“ä½œç³»ç»Ÿï¼Œæœ‰ä¸åŒçš„äº‹ä»¶æ¨¡å‹ #Aï¼‰æ ‡å‡†äº‹ä»¶æ¨¡å‹ #Selectã€pollå±äºæ ‡å‡†äº‹ä»¶æ¨¡å‹ï¼Œå¦‚æœå½“å‰ç³»ç»Ÿä¸å­˜åœ¨æ›´æœ‰æ•ˆçš„æ–¹æ³•ï¼Œnginxä¼šé€‰æ‹©selectæˆ–poll #Bï¼‰é«˜æ•ˆäº‹ä»¶æ¨¡å‹ #Kqueueï¼šä½¿ç”¨äºFreeBSD 4.1+, OpenBSD 2.9+, NetBSD 2.0 å’Œ MacOS X.ä½¿ç”¨åŒå¤„ç†å™¨çš„MacOS Xç³»ç»Ÿä½¿ç”¨kqueueå¯èƒ½ä¼šé€ æˆå†…æ ¸å´©æºƒã€‚ #Epollï¼šä½¿ç”¨äºLinuxå†…æ ¸2.6ç‰ˆæœ¬åŠä»¥åçš„ç³»ç»Ÿã€‚ #/dev/pollï¼šä½¿ç”¨äºSolaris 7 11/99+ï¼ŒHP/UX 11.22+ (eventport)ï¼ŒIRIX 6.5.15+ å’Œ Tru64 UNIX 5.1A+ã€‚ #Eventportï¼šä½¿ç”¨äºSolaris 10ã€‚ ä¸ºäº†é˜²æ­¢å‡ºç°å†…æ ¸å´©æºƒçš„é—®é¢˜ï¼Œ æœ‰å¿…è¦å®‰è£…å®‰å…¨è¡¥ä¸ã€‚ use epoll #å•ä¸ªè¿›ç¨‹æœ€å¤§è¿æ¥æ•°ï¼ˆæœ€å¤§è¿æ¥æ•°=è¿æ¥æ•°+è¿›ç¨‹æ•°ï¼‰ worker_connections 65535; #keepalive è¶…æ—¶æ—¶é—´ keepalive_timeout 60; #å®¢æˆ·ç«¯è¯·æ±‚å¤´éƒ¨çš„ç¼“å†²åŒºå¤§å°ã€‚è¿™ä¸ªå¯ä»¥æ ¹æ®ä½ çš„ç³»ç»Ÿåˆ†é¡µå¤§å°æ¥è®¾ç½®ï¼Œä¸€èˆ¬ä¸€ä¸ªè¯·æ±‚å¤´çš„å¤§å°ä¸ä¼šè¶…è¿‡1kï¼Œä¸è¿‡ç”±äºä¸€èˆ¬ç³»ç»Ÿåˆ†é¡µéƒ½è¦å¤§äº1kï¼Œæ‰€ä»¥è¿™é‡Œè®¾ç½®ä¸ºåˆ†é¡µå¤§å°ã€‚ #åˆ†é¡µå¤§å°å¯ä»¥ç”¨å‘½ä»¤getconf PAGESIZE å–å¾—ã€‚ #[root@web001 ~]# getconf PAGESIZE #ä½†ä¹Ÿæœ‰client_header_buffer_sizeè¶…è¿‡4kçš„æƒ…å†µï¼Œä½†æ˜¯client_header_buffer_sizeè¯¥å€¼å¿…é¡»è®¾ç½®ä¸ºâ€œç³»ç»Ÿåˆ†é¡µå¤§å°â€çš„æ•´å€æ•°ã€‚ client_header_buffer_size 4k; #è¿™ä¸ªå°†ä¸ºæ‰“å¼€æ–‡ä»¶æŒ‡å®šç¼“å­˜ï¼Œé»˜è®¤æ˜¯æ²¡æœ‰å¯ç”¨çš„ï¼ŒmaxæŒ‡å®šç¼“å­˜æ•°é‡ï¼Œå»ºè®®å’Œæ‰“å¼€æ–‡ä»¶æ•°ä¸€è‡´ï¼Œinactiveæ˜¯æŒ‡ç»è¿‡å¤šé•¿æ—¶é—´æ–‡ä»¶æ²¡è¢«è¯·æ±‚ååˆ é™¤ç¼“å­˜ã€‚ open_file_cache max=65535 inactive=60s; #è¿™ä¸ªæ˜¯æŒ‡å¤šé•¿æ—¶é—´æ£€æŸ¥ä¸€æ¬¡ç¼“å­˜çš„æœ‰æ•ˆä¿¡æ¯ã€‚ #è¯­æ³•:open_file_cache_valid time é»˜è®¤å€¼:open_file_cache_valid 60 ä½¿ç”¨å­—æ®µ:http, server, location è¿™ä¸ªæŒ‡ä»¤æŒ‡å®šäº†ä½•æ—¶éœ€è¦æ£€æŸ¥open_file_cacheä¸­ç¼“å­˜é¡¹ç›®çš„æœ‰æ•ˆä¿¡æ¯. open_file_cache_valid 80s; #open_file_cacheæŒ‡ä»¤ä¸­çš„inactiveå‚æ•°æ—¶é—´å†…æ–‡ä»¶çš„æœ€å°‘ä½¿ç”¨æ¬¡æ•°ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ•°å­—ï¼Œæ–‡ä»¶æè¿°ç¬¦ä¸€ç›´æ˜¯åœ¨ç¼“å­˜ä¸­æ‰“å¼€çš„ï¼Œå¦‚ä¸Šä¾‹ï¼Œå¦‚æœæœ‰ä¸€ä¸ªæ–‡ä»¶åœ¨inactiveæ—¶é—´å†…ä¸€æ¬¡æ²¡è¢«ä½¿ç”¨ï¼Œå®ƒå°†è¢«ç§»é™¤ã€‚ #è¯­æ³•:open_file_cache_min_uses number é»˜è®¤å€¼:open_file_cache_min_uses 1 ä½¿ç”¨å­—æ®µ:http, server, location è¿™ä¸ªæŒ‡ä»¤æŒ‡å®šäº†åœ¨open_file_cacheæŒ‡ä»¤æ— æ•ˆçš„å‚æ•°ä¸­ä¸€å®šçš„æ—¶é—´èŒƒå›´å†…å¯ä»¥ä½¿ç”¨çš„æœ€å°æ–‡ä»¶æ•°,å¦‚æœä½¿ç”¨æ›´å¤§çš„å€¼,æ–‡ä»¶æè¿°ç¬¦åœ¨cacheä¸­æ€»æ˜¯æ‰“å¼€çŠ¶æ€. open_file_cache_min_uses 1; #è¯­æ³•:open_file_cache_errors on | off é»˜è®¤å€¼:open_file_cache_errors off ä½¿ç”¨å­—æ®µ:http, server, location è¿™ä¸ªæŒ‡ä»¤æŒ‡å®šæ˜¯å¦åœ¨æœç´¢ä¸€ä¸ªæ–‡ä»¶æ˜¯è®°å½•cacheé”™è¯¯. open_file_cache_errors on; #é»˜è®¤æ˜¯onã€‚è®¾ç½®ä¸ºonåï¼Œå¤šä¸ªworkeræŒ‰ä¸²è¡Œæ–¹å¼æ¥å¤„ç†è¿æ¥ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªè¿æ¥åªæœ‰ä¸€ä¸ªworkerè¢«å”¤é†’ï¼Œå…¶ä»–çš„å¤„äºä¼‘çœ çŠ¶æ€ã€‚ #è®¾ç½®ä¸ºoffåï¼Œå¤šä¸ªworkeræŒ‰å¹¶è¡Œæ–¹å¼æ¥å¤„ç†è¿æ¥ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªè¿æ¥ä¼šå”¤é†’æ‰€æœ‰çš„workerï¼ŒçŸ¥é“è¿æ¥åˆ†é…å®Œæ¯•ï¼Œæ²¡æœ‰å–å¾—è¿æ¥çš„ç»§ç»­ä¼‘çœ ã€‚ #å½“ä½ çš„æœåŠ¡å™¨è¿æ¥æ•°ä¸å¤šæ—¶ï¼Œå¼€å¯è¿™ä¸ªå‚æ•°ä¼šè®©è´Ÿè½½æœ‰ä¸€å®šç¨‹åº¦çš„é™ä½ã€‚ä½†æ˜¯å½“æœåŠ¡å™¨çš„ååé‡å¾ˆå¤§æ—¶ï¼Œä¸ºäº†æ•ˆç‡ï¼Œè¯·å…³é—­è¿™ä¸ªå‚æ•°ã€‚ multi_accept off; } #è®¾å®šhttpæœåŠ¡å™¨ http { #æ–‡ä»¶æ‰©å±•åä¸æ–‡ä»¶ç±»å‹æ˜ å°„è¡¨ include mime.types; #é»˜è®¤æ–‡ä»¶ç±»å‹ default_type application/octet-stream; # å¢åŠ  header add_header Access-Control-Allow-Origin *; add_header Access-Control-Allow-Methods \"GET, POST, OPTIONS\"; #é»˜è®¤ç¼–ç  charset utf-8; #æœåŠ¡å™¨åå­—çš„hashè¡¨å¤§å° #ä¿å­˜æœåŠ¡å™¨åå­—çš„hashè¡¨æ˜¯ç”±æŒ‡ä»¤server_names_hash_max_size å’Œserver_names_hash_bucket_sizeæ‰€æ§åˆ¶çš„ã€‚å‚æ•°hash bucket sizeæ€»æ˜¯ç­‰äºhashè¡¨çš„å¤§å°ï¼Œå¹¶ä¸”æ˜¯ä¸€è·¯å¤„ç†å™¨ç¼“å­˜å¤§å°çš„å€æ•°ã€‚åœ¨å‡å°‘äº†åœ¨å†…å­˜ä¸­çš„å­˜å–æ¬¡æ•°åï¼Œä½¿åœ¨å¤„ç†å™¨ä¸­åŠ é€ŸæŸ¥æ‰¾hashè¡¨é”®å€¼æˆä¸ºå¯èƒ½ã€‚å¦‚æœhash bucket sizeç­‰äºä¸€è·¯å¤„ç†å™¨ç¼“å­˜çš„å¤§å°ï¼Œé‚£ä¹ˆåœ¨æŸ¥æ‰¾é”®çš„æ—¶å€™ï¼Œæœ€åçš„æƒ…å†µä¸‹åœ¨å†…å­˜ä¸­æŸ¥æ‰¾çš„æ¬¡æ•°ä¸º2ã€‚ç¬¬ä¸€æ¬¡æ˜¯ç¡®å®šå­˜å‚¨å•å…ƒçš„åœ°å€ï¼Œç¬¬äºŒæ¬¡æ˜¯åœ¨å­˜å‚¨å•å…ƒä¸­æŸ¥æ‰¾é”® å€¼ã€‚å› æ­¤ï¼Œå¦‚æœNginxç»™å‡ºéœ€è¦å¢å¤§hash max size æˆ– hash bucket sizeçš„æç¤ºï¼Œé‚£ä¹ˆé¦–è¦çš„æ˜¯å¢å¤§å‰ä¸€ä¸ªå‚æ•°çš„å¤§å°. server_names_hash_bucket_size 128; #å®¢æˆ·ç«¯è¯·æ±‚å¤´éƒ¨çš„ç¼“å†²åŒºå¤§å°ã€‚è¿™ä¸ªå¯ä»¥æ ¹æ®ä½ çš„ç³»ç»Ÿåˆ†é¡µå¤§å°æ¥è®¾ç½®ï¼Œä¸€èˆ¬ä¸€ä¸ªè¯·æ±‚çš„å¤´éƒ¨å¤§å°ä¸ä¼šè¶…è¿‡1kï¼Œä¸è¿‡ç”±äºä¸€èˆ¬ç³»ç»Ÿåˆ†é¡µéƒ½è¦å¤§äº1kï¼Œæ‰€ä»¥è¿™é‡Œè®¾ç½®ä¸ºåˆ†é¡µå¤§å°ã€‚åˆ†é¡µå¤§å°å¯ä»¥ç”¨å‘½ä»¤getconf PAGESIZEå–å¾—ã€‚ client_header_buffer_size 32k; #å®¢æˆ·è¯·æ±‚å¤´ç¼“å†²å¤§å°ã€‚nginxé»˜è®¤ä¼šç”¨client_header_buffer_sizeè¿™ä¸ªbufferæ¥è¯»å–headerå€¼ï¼Œå¦‚æœheaderè¿‡å¤§ï¼Œå®ƒä¼šä½¿ç”¨large_client_header_buffersæ¥è¯»å–ã€‚ large_client_header_buffers 4 64k; #è®¾å®šé€šè¿‡nginxä¸Šä¼ æ–‡ä»¶çš„å¤§å° client_max_body_size 8m; #å¼€å¯ç›®å½•åˆ—è¡¨è®¿é—®ï¼Œåˆé€‚ä¸‹è½½æœåŠ¡å™¨ï¼Œé»˜è®¤å…³é—­ã€‚ autoindex on; # é™æµ limit_req_zone $server_name zone=xiaozhi_log:50m rate=40r/s; limit_req_zone $server_name zone=tico_log:50m rate=40r/s; # æ—¥å¿—æ ¼å¼å®šä¹‰ï¼Œè¿™é‡Œå¯ä»¥æ ¹æ®è‡ªå·±çš„æ—¥å¿—è§„èŒƒè¿›è¡Œè‡ªå®šä¹‰ #log_format main '$remote_addr - $remote_user [$time_local] \"$request\" ' # '$status $body_bytes_sent \"$http_referer\" ' # '\"$http_user_agent\" \"$http_x_forwarded_for\"'; # è¿™é‡Œæ¨èä¸€ä¸ªæ—¥å¿—æ ¼å¼ log_format custom '[$time_local] $remote_addr $remote_user $request ' '$status $upstream_response_time $request_time $body_bytes_sent $http_referer ' '$http_user_agent $http_x_forwarded_for ' ; #access_log logs/access.log main; #å¼€å¯é«˜æ•ˆæ–‡ä»¶ä¼ è¾“æ¨¡å¼ï¼ŒsendfileæŒ‡ä»¤æŒ‡å®šnginxæ˜¯å¦è°ƒç”¨sendfileå‡½æ•°æ¥è¾“å‡ºæ–‡ä»¶ï¼Œå¯¹äºæ™®é€šåº”ç”¨è®¾ä¸º onï¼Œå¦‚æœç”¨æ¥è¿›è¡Œä¸‹è½½ç­‰åº”ç”¨ç£ç›˜IOé‡è´Ÿè½½åº”ç”¨ï¼Œ","date":"2020-11-22","objectID":"/openresty-nginx.conf/:2:0","tags":["nginx","openresty","nginx.conf"],"title":"openresty é…ç½®æ–‡ä»¶ ï¼ˆä¸€ï¼‰","uri":"/openresty-nginx.conf/"},{"categories":null,"content":"nginx.conf æ ·ä¾‹ worker_processes 2; events { worker_connections 65535; } http { include mime.types; default_type application/octet-stream; log_format custom '[$time_local] $remote_addr $remote_user $request ' '$status $upstream_response_time $request_time $body_bytes_sent $http_referer ' '$http_user_agent $http_x_forwarded_for ' ; client_body_temp_path /var/run/openresty/nginx-client-body; proxy_temp_path /var/run/openresty/nginx-proxy; fastcgi_temp_path /var/run/openresty/nginx-fastcgi; uwsgi_temp_path /var/run/openresty/nginx-uwsgi; scgi_temp_path /var/run/openresty/nginx-scgi; sendfile on; keepalive_timeout 90; include /etc/nginx/conf.d/*.conf; } ","date":"2020-11-22","objectID":"/openresty-nginx.conf/:3:0","tags":["nginx","openresty","nginx.conf"],"title":"openresty é…ç½®æ–‡ä»¶ ï¼ˆä¸€ï¼‰","uri":"/openresty-nginx.conf/"},{"categories":null,"content":"æ¥ä¸‹æ¥ è¿™æ˜¯ openresty é…ç½®æ–‡ä»¶ç³»åˆ—ç¯‡ï¼Œè¿™ç¯‡ä»‹ç»äº† nginx.conf (å…¨å±€é…ç½®) ï¼Œæ¥ä¸‹æ¥è¿˜æœ‰ server ã€ upstreamã€location ç­‰ä»‹ç»ã€‚ æ¯å¤©æŒæ¡ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œç§¯å°‘æˆå¤šï¼Œä¸€å‘¨ç©è½¬ openresty ã€‚ ","date":"2020-11-22","objectID":"/openresty-nginx.conf/:4:0","tags":["nginx","openresty","nginx.conf"],"title":"openresty é…ç½®æ–‡ä»¶ ï¼ˆä¸€ï¼‰","uri":"/openresty-nginx.conf/"},{"categories":null,"content":"å‚è€ƒ https://juejin.cn/post/6844903741678698510 ","date":"2020-11-22","objectID":"/openresty-nginx.conf/:5:0","tags":["nginx","openresty","nginx.conf"],"title":"openresty é…ç½®æ–‡ä»¶ ï¼ˆä¸€ï¼‰","uri":"/openresty-nginx.conf/"},{"categories":null,"content":"openresty é…ç½®æ–‡ä»¶ ï¼ˆäºŒï¼‰","date":"2020-11-22","objectID":"/openresty-server/","tags":["nginx","openresty","server","location"],"title":"openresty é…ç½®æ–‡ä»¶ ï¼ˆäºŒï¼‰","uri":"/openresty-server/"},{"categories":null,"content":"å¯¼è¯» ","date":"2020-11-22","objectID":"/openresty-server/:1:0","tags":["nginx","openresty","server","location"],"title":"openresty é…ç½®æ–‡ä»¶ ï¼ˆäºŒï¼‰","uri":"/openresty-server/"},{"categories":null,"content":"kubernetes ä¸­patchä¸updateæ¯”è¾ƒ","date":"2020-11-21","objectID":"/kubernetes/patch-update/","tags":["kubernetes","api","patch","update"],"title":"kubernetes ä¸­patchä¸updateæ¯”è¾ƒ","uri":"/kubernetes/patch-update/"},{"categories":null,"content":"å¯¼è¯» ä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰æƒ³è¿‡ä¸€ä¸ªé—®é¢˜ï¼šå¯¹äºä¸€ä¸ª K8s èµ„æºå¯¹è±¡æ¯”å¦‚ Deploymentï¼Œæˆ‘ä»¬å°è¯•åœ¨ä¿®æ”¹å…¶ä¸­ image é•œåƒæ—¶ï¼Œå¦‚æœæœ‰å…¶ä»–äººåŒæ—¶ä¹Ÿåœ¨å¯¹è¿™ä¸ª Deployment åšä¿®æ”¹ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ å½“ç„¶ï¼Œè¿™é‡Œè¿˜å¯ä»¥å¼•ç”³å‡ºä¸¤ä¸ªé—®é¢˜ï¼š å¦‚æœåŒæ–¹ä¿®æ”¹çš„æ˜¯åŒä¸€ä¸ªå­—æ®µï¼Œæ¯”å¦‚ image å­—æ®µï¼Œç»“æœä¼šæ€æ ·ï¼Ÿ å¦‚æœåŒæ–¹ä¿®æ”¹çš„æ˜¯ä¸åŒå­—æ®µï¼Œæ¯”å¦‚ä¸€ä¸ªä¿®æ”¹ imageï¼Œå¦ä¸€ä¸ªä¿®æ”¹ replicasï¼Œåˆä¼šæ€ä¹ˆæ ·ï¼Ÿ å…¶å®ï¼Œå¯¹ä¸€ä¸ª Kubernetes èµ„æºå¯¹è±¡åšâ€œæ›´æ–°â€æ“ä½œï¼Œç®€å•æ¥è¯´å°±æ˜¯é€šçŸ¥ kube-apiserver ç»„ä»¶æˆ‘ä»¬å¸Œæœ›å¦‚ä½•ä¿®æ”¹è¿™ä¸ªå¯¹è±¡ã€‚è€Œ K8s ä¸ºè¿™ç±»éœ€æ±‚å®šä¹‰äº†ä¸¤ç§â€œé€šçŸ¥â€æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯ update å’Œ patchã€‚åœ¨ update è¯·æ±‚ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å°†æ•´ä¸ªä¿®æ”¹åçš„å¯¹è±¡æäº¤ç»™ K8sï¼›è€Œå¯¹äº patch è¯·æ±‚ï¼Œæˆ‘ä»¬åªéœ€è¦å°†å¯¹è±¡ä¸­æŸäº›å­—æ®µçš„ä¿®æ”¹æäº¤ç»™ K8sã€‚ ","date":"2020-11-21","objectID":"/kubernetes/patch-update/:1:0","tags":["kubernetes","api","patch","update"],"title":"kubernetes ä¸­patchä¸updateæ¯”è¾ƒ","uri":"/kubernetes/patch-update/"},{"categories":null,"content":"Update æœºåˆ¶ Kubernetes ä¸­çš„æ‰€æœ‰èµ„æºå¯¹è±¡ï¼Œéƒ½æœ‰ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„ç‰ˆæœ¬å·ï¼ˆmetadata.resourceVersionï¼‰ã€‚æ¯ä¸ªèµ„æºå¯¹è±¡ä»åˆ›å»ºå¼€å§‹å°±ä¼šæœ‰ä¸€ä¸ªç‰ˆæœ¬å·ï¼Œè€Œåæ¯æ¬¡è¢«ä¿®æ”¹ï¼ˆä¸ç®¡æ˜¯ update è¿˜æ˜¯ patch ä¿®æ”¹ï¼‰ï¼Œç‰ˆæœ¬å·éƒ½ä¼šå‘ç”Ÿå˜åŒ–ã€‚ å®˜æ–¹æ–‡æ¡£ å‘Šè¯‰æˆ‘ä»¬ï¼Œè¿™ä¸ªç‰ˆæœ¬å·æ˜¯ä¸€ä¸ª K8s çš„å†…éƒ¨æœºåˆ¶ï¼Œç”¨æˆ·ä¸åº”è¯¥å‡è®¾å®ƒæ˜¯ä¸€ä¸ªæ•°å­—æˆ–è€…é€šè¿‡æ¯”è¾ƒä¸¤ä¸ªç‰ˆæœ¬å·å¤§å°æ¥ç¡®å®šèµ„æºå¯¹è±¡çš„æ–°æ—§ï¼Œå”¯ä¸€èƒ½åšçš„å°±æ˜¯é€šè¿‡æ¯”è¾ƒç‰ˆæœ¬å·ç›¸ç­‰æ¥ç¡®å®šå¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªç‰ˆæœ¬ï¼ˆå³æ˜¯å¦å‘ç”Ÿäº†å˜åŒ–ï¼‰ã€‚è€Œ resourceVersion ä¸€ä¸ªé‡è¦çš„ç”¨å¤„ï¼Œå°±æ˜¯æ¥åš update è¯·æ±‚çš„ç‰ˆæœ¬æ§åˆ¶ã€‚ K8s è¦æ±‚ç”¨æˆ· update è¯·æ±‚ä¸­æäº¤çš„å¯¹è±¡å¿…é¡»å¸¦æœ‰ resourceVersionï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æäº¤ update çš„æ•°æ®å¿…é¡»å…ˆæ¥æºäº K8s ä¸­å·²ç»å­˜åœ¨çš„å¯¹è±¡ã€‚å› æ­¤ï¼Œä¸€æ¬¡å®Œæ•´çš„ update æ“ä½œæµç¨‹æ˜¯ï¼š é¦–å…ˆï¼Œä» K8s ä¸­æ‹¿åˆ°ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å¯¹è±¡ï¼ˆå¯ä»¥é€‰æ‹©ç›´æ¥ä» K8s ä¸­æŸ¥è¯¢ï¼›å¦‚æœåœ¨å®¢æˆ·ç«¯åšäº† list watchï¼Œæ¨èä»æœ¬åœ° informer ä¸­è·å–ï¼‰ï¼› ç„¶åï¼ŒåŸºäºè¿™ä¸ªå–å‡ºæ¥çš„å¯¹è±¡åšä¸€äº›ä¿®æ”¹ï¼Œæ¯”å¦‚å°† Deployment ä¸­çš„ replicas åšå¢å‡ï¼Œæˆ–æ˜¯å°† image å­—æ®µä¿®æ”¹ä¸ºä¸€ä¸ªæ–°ç‰ˆæœ¬çš„é•œåƒï¼› æœ€åï¼Œå°†ä¿®æ”¹åçš„å¯¹è±¡é€šè¿‡ update è¯·æ±‚æäº¤ç»™ K8sï¼› æ­¤æ—¶ï¼Œkube-apiserver ä¼šæ ¡éªŒç”¨æˆ· update è¯·æ±‚æäº¤å¯¹è±¡ä¸­çš„ resourceVersion ä¸€å®šè¦å’Œå½“å‰ K8s ä¸­è¿™ä¸ªå¯¹è±¡æœ€æ–°çš„ resourceVersion ä¸€è‡´ï¼Œæ‰èƒ½æ¥å—æœ¬æ¬¡ updateã€‚å¦åˆ™ï¼ŒK8s ä¼šæ‹’ç»è¯·æ±‚ï¼Œå¹¶å‘Šè¯‰ç”¨æˆ·å‘ç”Ÿäº†ç‰ˆæœ¬å†²çªï¼ˆConflictï¼‰ã€‚ ä¸Šå›¾å±•ç¤ºäº†å¤šä¸ªç”¨æˆ·åŒæ—¶ update æŸä¸€ä¸ªèµ„æºå¯¹è±¡æ—¶ä¼šå‘ç”Ÿçš„äº‹æƒ…ã€‚è€Œå¦‚æœå¦‚æœå‘ç”Ÿäº† Conflict å†²çªï¼Œå¯¹äº User A è€Œè¨€åº”è¯¥åšçš„å°±æ˜¯åšä¸€æ¬¡é‡è¯•ï¼Œå†æ¬¡è·å–åˆ°æœ€æ–°ç‰ˆæœ¬çš„å¯¹è±¡ï¼Œä¿®æ”¹åé‡æ–°æäº¤ updateã€‚ å› æ­¤ï¼Œæˆ‘ä»¬ä¸Šé¢çš„ä¸¤ä¸ªé—®é¢˜ä¹Ÿéƒ½å¾—åˆ°äº†è§£ç­”ï¼š ç”¨æˆ·ä¿®æ”¹ YAML åæäº¤ update å¤±è´¥ï¼Œæ˜¯å› ä¸º YAML æ–‡ä»¶ä¸­æ²¡æœ‰åŒ…å« resourceVersion å­—æ®µã€‚å¯¹äº update è¯·æ±‚è€Œè¨€ï¼Œåº”è¯¥å–å‡ºå½“å‰ K8s ä¸­çš„å¯¹è±¡åšä¿®æ”¹åæäº¤ï¼› å¦‚æœä¸¤ä¸ªç”¨æˆ·åŒæ—¶å¯¹ä¸€ä¸ªèµ„æºå¯¹è±¡åš updateï¼Œä¸ç®¡æ“ä½œçš„æ˜¯å¯¹è±¡ä¸­åŒä¸€ä¸ªå­—æ®µè¿˜æ˜¯ä¸åŒå­—æ®µï¼Œéƒ½å­˜åœ¨ç‰ˆæœ¬æ§åˆ¶çš„æœºåˆ¶ç¡®ä¿ä¸¤ä¸ªç”¨æˆ·çš„ update è¯·æ±‚ä¸ä¼šå‘ç”Ÿè¦†ç›–ã€‚ ","date":"2020-11-21","objectID":"/kubernetes/patch-update/:2:0","tags":["kubernetes","api","patch","update"],"title":"kubernetes ä¸­patchä¸updateæ¯”è¾ƒ","uri":"/kubernetes/patch-update/"},{"categories":null,"content":"Patch æœºåˆ¶ ç›¸æ¯”äº update çš„ç‰ˆæœ¬æ§åˆ¶ï¼ŒK8s çš„ patch æœºåˆ¶åˆ™æ˜¾å¾—æ›´åŠ ç®€å•ã€‚ å½“ç”¨æˆ·å¯¹æŸä¸ªèµ„æºå¯¹è±¡æäº¤ä¸€ä¸ª patch è¯·æ±‚æ—¶ï¼Œkube-apiserver ä¸ä¼šè€ƒè™‘ç‰ˆæœ¬é—®é¢˜ï¼Œè€Œæ˜¯â€œæ— è„‘â€åœ°æ¥å—ç”¨æˆ·çš„è¯·æ±‚ï¼ˆåªè¦è¯·æ±‚å‘é€çš„ patch å†…å®¹åˆæ³•ï¼‰ï¼Œä¹Ÿå°±æ˜¯å°† patch æ‰“åˆ°å¯¹è±¡ä¸Šã€åŒæ—¶æ›´æ–°ç‰ˆæœ¬å·ã€‚ ä¸è¿‡ï¼Œpatch çš„å¤æ‚ç‚¹åœ¨äºï¼Œç›®å‰ K8s æä¾›äº† 4 ç§ patch ç­–ç•¥ï¼šjson patchã€merge patchã€strategic merge patchã€apply patchï¼ˆä» K8s 1.14 æ”¯æŒ server-side apply å¼€å§‹ï¼‰ã€‚é€šè¿‡ kubectl patch -h å‘½ä»¤æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°è¿™ä¸ªç­–ç•¥é€‰é¡¹ï¼ˆé»˜è®¤é‡‡ç”¨ strategicï¼‰ï¼š $ kubectl patch -h # ... --type='strategic': The type of patch being provided; one of [json merge strategic] ç¯‡å¹…é™åˆ¶è¿™é‡Œæš‚ä¸å¯¹æ¯ä¸ªç­–ç•¥åšè¯¦ç»†çš„ä»‹ç»äº†ï¼Œæˆ‘ä»¬å°±ä»¥ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥çœ‹ä¸€ä¸‹å®ƒä»¬çš„å·®å¼‚æ€§ã€‚å¦‚æœé’ˆå¯¹ä¸€ä¸ªå·²æœ‰çš„ Deployment å¯¹è±¡ï¼Œå‡è®¾ template ä¸­å·²ç»æœ‰äº†ä¸€ä¸ªåä¸º app çš„å®¹å™¨ï¼š å¦‚æœè¦åœ¨å…¶ä¸­æ–°å¢ä¸€ä¸ª nginx å®¹å™¨ï¼Œå¦‚ä½• patch æ›´æ–°ï¼Ÿ å¦‚æœè¦ä¿®æ”¹ app å®¹å™¨çš„é•œåƒï¼Œå¦‚ä½• patch æ›´æ–°ï¼Ÿ ","date":"2020-11-21","objectID":"/kubernetes/patch-update/:3:0","tags":["kubernetes","api","patch","update"],"title":"kubernetes ä¸­patchä¸updateæ¯”è¾ƒ","uri":"/kubernetes/patch-update/"},{"categories":null,"content":"json patch æ–°å¢å®¹å™¨ï¼š kubectl patch deployment/foo --type='json' -p \\ '[{\"op\":\"add\",\"path\":\"/spec/template/spec/containers/1\",\"value\":{\"name\":\"nginx\",\"image\":\"nginx:alpine\"}}]' ä¿®æ”¹å·²æœ‰å®¹å™¨ imageï¼š kubectl patch deployment/foo --type='json' -p \\ '[{\"op\":\"replace\",\"path\":\"/spec/template/spec/containers/0/image\",\"value\":\"app-image:v2\"}]' è¿™æ ·ä¸€æ¥ï¼Œå¦‚æœæˆ‘ä»¬ patch ä¹‹å‰è¿™ä¸ªå¯¹è±¡å·²ç»è¢«å…¶ä»–äººä¿®æ”¹äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ patch æœ‰å¯èƒ½äº§ç”Ÿéé¢„æœŸçš„åæœã€‚æ¯”å¦‚åœ¨æ‰§è¡Œ app å®¹å™¨é•œåƒæ›´æ–°æ—¶ï¼Œæˆ‘ä»¬æŒ‡å®šçš„åºå·æ˜¯ 0ï¼Œä½†æ­¤æ—¶ containers åˆ—è¡¨ä¸­ç¬¬ä¸€ä¸ªä½ç½®è¢«æ’å…¥äº†å¦ä¸€ä¸ªå®¹å™¨ï¼Œåˆ™æ›´æ–°çš„é•œåƒå°±è¢«é”™è¯¯åœ°æ’å…¥åˆ°è¿™ä¸ªéé¢„æœŸçš„å®¹å™¨ä¸­ã€‚ ","date":"2020-11-21","objectID":"/kubernetes/patch-update/:3:1","tags":["kubernetes","api","patch","update"],"title":"kubernetes ä¸­patchä¸updateæ¯”è¾ƒ","uri":"/kubernetes/patch-update/"},{"categories":null,"content":"merge patch merge patch æ— æ³•å•ç‹¬æ›´æ–°ä¸€ä¸ªåˆ—è¡¨ä¸­çš„æŸä¸ªå…ƒç´ ï¼Œå› æ­¤ä¸ç®¡æˆ‘ä»¬æ˜¯è¦åœ¨ containers é‡Œæ–°å¢å®¹å™¨ã€è¿˜æ˜¯ä¿®æ”¹å·²æœ‰å®¹å™¨çš„ imageã€env ç­‰å­—æ®µï¼Œéƒ½è¦ç”¨æ•´ä¸ª containers åˆ—è¡¨æ¥æäº¤ patchï¼š kubectl patch deployment/foo --type='merge' -p \\ '{\"spec\":{\"template\":{\"spec\":{\"containers\":[{\"name\":\"app\",\"image\":\"app-image:v2\"},{\"name\":\"nginx\",\"image\":\"nginx:alpline\"}]}}}}' æ˜¾ç„¶ï¼Œè¿™ä¸ªç­–ç•¥å¹¶ä¸é€‚åˆæˆ‘ä»¬å¯¹ä¸€äº›åˆ—è¡¨æ·±å±‚çš„å­—æ®µåšæ›´æ–°ï¼Œæ›´é€‚ç”¨äºå¤§ç‰‡æ®µçš„è¦†ç›–æ›´æ–°ã€‚ ä¸è¿‡å¯¹äº labels/annotations è¿™äº› map ç±»å‹çš„å…ƒç´ æ›´æ–°ï¼Œmerge patch æ˜¯å¯ä»¥å•ç‹¬æŒ‡å®š key-value æ“ä½œçš„ï¼Œç›¸æ¯”äº json patch æ–¹ä¾¿ä¸€äº›ï¼Œå†™èµ·æ¥ä¹Ÿæ›´åŠ ç›´è§‚ï¼š kubectl patch deployment/foo â€“type='mergeâ€™ -p â€˜{â€œmetadataâ€:{â€œlabelsâ€:{â€œtest-keyâ€:â€œfooâ€}}}â€™ ","date":"2020-11-21","objectID":"/kubernetes/patch-update/:3:2","tags":["kubernetes","api","patch","update"],"title":"kubernetes ä¸­patchä¸updateæ¯”è¾ƒ","uri":"/kubernetes/patch-update/"},{"categories":null,"content":"strategic merge patch è¿™ç§ patch ç­–ç•¥å¹¶æ²¡æœ‰ä¸€ä¸ªé€šç”¨çš„ RFC æ ‡å‡†ï¼Œè€Œæ˜¯ K8s ç‹¬æœ‰çš„ï¼Œä¸è¿‡ç›¸æ¯”å‰ä¸¤ç§è€Œè¨€å´æ›´ä¸ºå¼ºå¤§çš„ã€‚ æˆ‘ä»¬å…ˆä» K8s æºç çœ‹èµ·ï¼Œåœ¨ K8s åŸç”Ÿèµ„æºçš„æ•°æ®ç»“æ„å®šä¹‰ä¸­é¢å¤–å®šä¹‰äº†ä¸€äº›çš„ç­–ç•¥æ³¨è§£ã€‚æ¯”å¦‚ä»¥ä¸‹è¿™ä¸ªæˆªå–äº† podSpec ä¸­é’ˆå¯¹ containers åˆ—è¡¨çš„å®šä¹‰ // ... // +patchMergeKey=name // +patchStrategy=merge Containers []Container `json:\"containers\" patchStrategy:\"merge\" patchMergeKey:\"name\" protobuf:\"bytes,2,rep,name=containers\"` å¯ä»¥çœ‹åˆ°å…¶ä¸­æœ‰ä¸¤ä¸ªå…³é”®ä¿¡æ¯ï¼špatchStrategy:â€œmergeâ€ patchMergeKey:â€œnameâ€ ã€‚è¿™å°±ä»£è¡¨äº†ï¼Œcontainers åˆ—è¡¨ä½¿ç”¨ strategic merge patch ç­–ç•¥æ›´æ–°æ—¶ï¼Œä¼šæŠŠä¸‹é¢æ¯ä¸ªå…ƒç´ ä¸­çš„ name å­—æ®µçœ‹ä½œ keyã€‚ ç®€å•æ¥è¯´ï¼Œåœ¨æˆ‘ä»¬ patch æ›´æ–° containers ä¸å†éœ€è¦æŒ‡å®šä¸‹æ ‡åºå·äº†ï¼Œè€Œæ˜¯æŒ‡å®š name æ¥ä¿®æ”¹ï¼ŒK8s ä¼šæŠŠ name ä½œä¸º key æ¥è®¡ç®— mergeã€‚æ¯”å¦‚é’ˆå¯¹ä»¥ä¸‹çš„ patch æ“ä½œï¼š kubectl patch deployment/foo -p \\ '{\"spec\":{\"template\":{\"spec\":{\"containers\":[{\"name\":\"nginx\",\"image\":\"nginx:mainline\"}]}}}}' å¦‚æœ K8s å‘ç°å½“å‰ containers ä¸­å·²ç»æœ‰åå­—ä¸º nginx çš„å®¹å™¨ï¼Œåˆ™åªä¼šæŠŠ image æ›´æ–°ä¸Šå»ï¼›è€Œå¦‚æœå½“å‰ containers ä¸­æ²¡æœ‰ nginx å®¹å™¨ï¼ŒK8s ä¼šæŠŠè¿™ä¸ªå®¹å™¨æ’å…¥ containers åˆ—è¡¨ã€‚ æ­¤å¤–è¿˜è¦è¯´æ˜çš„æ˜¯ï¼Œç›®å‰ strategic ç­–ç•¥åªèƒ½ç”¨äºåŸç”Ÿ K8s èµ„æºä»¥åŠ Aggregated API æ–¹å¼çš„è‡ªå®šä¹‰èµ„æºï¼Œå¯¹äº CRD å®šä¹‰çš„èµ„æºå¯¹è±¡ï¼Œæ˜¯æ— æ³•ä½¿ç”¨çš„ã€‚è¿™å¾ˆå¥½ç†è§£ï¼Œå› ä¸º kube-apiserver æ— æ³•å¾—çŸ¥ CRD èµ„æºçš„ç»“æ„å’Œ merge ç­–ç•¥ã€‚å¦‚æœç”¨ kubectl patch å‘½ä»¤æ›´æ–°ä¸€ä¸ª CRï¼Œåˆ™é»˜è®¤ä¼šé‡‡ç”¨ merge patch çš„ç­–ç•¥æ¥æ“ä½œã€‚ ","date":"2020-11-21","objectID":"/kubernetes/patch-update/:3:3","tags":["kubernetes","api","patch","update"],"title":"kubernetes ä¸­patchä¸updateæ¯”è¾ƒ","uri":"/kubernetes/patch-update/"},{"categories":null,"content":"kubectl å°è£… äº†è§£å®Œäº† K8s çš„åŸºç¡€æ›´æ–°æœºåˆ¶ï¼Œæˆ‘ä»¬å†æ¬¡å›åˆ°æœ€åˆçš„é—®é¢˜ä¸Šã€‚ä¸ºä»€ä¹ˆç”¨æˆ·ä¿®æ”¹ YAML æ–‡ä»¶åæ— æ³•ç›´æ¥è°ƒç”¨ update æ¥å£æ›´æ–°ï¼Œå´å¯ä»¥é€šè¿‡ kubectl apply å‘½ä»¤æ›´æ–°å‘¢ï¼Ÿ å…¶å® kubectl ä¸ºäº†ç»™å‘½ä»¤è¡Œç”¨æˆ·æä¾›è‰¯å¥½çš„äº¤äº’ä½“æ„Ÿï¼Œè®¾è®¡äº†è¾ƒä¸ºå¤æ‚çš„å†…éƒ¨æ‰§è¡Œé€»è¾‘ï¼Œè¯¸å¦‚ applyã€edit è¿™äº›å¸¸ç”¨æ“ä½œå…¶å®èƒŒåå¹¶éå¯¹åº”ä¸€æ¬¡ç®€å•çš„ update è¯·æ±‚ã€‚æ¯•ç«Ÿ update æ˜¯æœ‰ç‰ˆæœ¬æ§åˆ¶çš„ï¼Œå¦‚æœå‘ç”Ÿäº†æ›´æ–°å†²çªå¯¹äºæ™®é€šç”¨æˆ·å¹¶ä¸å‹å¥½ã€‚ä»¥ä¸‹ç®€ç•¥ä»‹ç»ä¸‹ kubectl å‡ ç§æ›´æ–°æ“ä½œçš„é€»è¾‘ï¼Œæœ‰å…´è¶£å¯ä»¥çœ‹ä¸€ä¸‹ link:https://github.com/kubernetes/kubectl[kubectl] å°è£…çš„æºç ã€‚ ","date":"2020-11-21","objectID":"/kubernetes/patch-update/:3:4","tags":["kubernetes","api","patch","update"],"title":"kubernetes ä¸­patchä¸updateæ¯”è¾ƒ","uri":"/kubernetes/patch-update/"},{"categories":null,"content":"apply åœ¨ä½¿ç”¨é»˜è®¤å‚æ•°æ‰§è¡Œ apply æ—¶ï¼Œè§¦å‘çš„æ˜¯ client-side applyã€‚kubectl é€»è¾‘å¦‚ä¸‹ï¼š é¦–å…ˆè§£æç”¨æˆ·æäº¤çš„æ•°æ®ï¼ˆYAML/JSONï¼‰ä¸ºä¸€ä¸ªå¯¹è±¡ Aï¼›ç„¶åè°ƒç”¨ Get æ¥å£ä» K8s ä¸­æŸ¥è¯¢è¿™ä¸ªèµ„æºå¯¹è±¡ï¼š å¦‚æœæŸ¥è¯¢ç»“æœä¸å­˜åœ¨ï¼Œkubectl å°†æœ¬æ¬¡ç”¨æˆ·æäº¤çš„æ•°æ®è®°å½•åˆ°å¯¹è±¡ A çš„ annotation ä¸­ï¼ˆkey ä¸º kubectl.kubernetes.io/last-applied-configurationï¼‰ï¼Œæœ€åå°†å¯¹è±¡ Aæäº¤ç»™ K8s åˆ›å»ºï¼› å¦‚æœæŸ¥è¯¢åˆ° K8s ä¸­å·²æœ‰è¿™ä¸ªèµ„æºï¼Œå‡è®¾ä¸ºå¯¹è±¡ Bï¼š1. kubectl å°è¯•ä»å¯¹è±¡ B çš„ annotation ä¸­å–å‡º kubectl.kubernetes.io/last-applied-configuration çš„å€¼ï¼ˆå¯¹åº”äº†ä¸Šä¸€æ¬¡ apply æäº¤çš„å†…å®¹ï¼‰ï¼›2. kubectl æ ¹æ®å‰ä¸€æ¬¡ apply çš„å†…å®¹å’Œæœ¬æ¬¡ apply çš„å†…å®¹è®¡ç®—å‡º diffï¼ˆé»˜è®¤ä¸º strategic merge patch æ ¼å¼ï¼Œå¦‚æœéåŸç”Ÿèµ„æºåˆ™é‡‡ç”¨ merge patchï¼‰ï¼›3. å°† diff ä¸­æ·»åŠ æœ¬æ¬¡çš„ kubectl.kubernetes.io/last-applied-configuration annotationï¼Œæœ€åç”¨ patch è¯·æ±‚æäº¤ç»™ K8s åšæ›´æ–°ã€‚ ","date":"2020-11-21","objectID":"/kubernetes/patch-update/:3:5","tags":["kubernetes","api","patch","update"],"title":"kubernetes ä¸­patchä¸updateæ¯”è¾ƒ","uri":"/kubernetes/patch-update/"},{"categories":null,"content":"edit kubectl edit é€»è¾‘ä¸Šæ›´ç®€å•ä¸€äº›ã€‚åœ¨ç”¨æˆ·æ‰§è¡Œå‘½ä»¤ä¹‹åï¼Œkubectl ä» K8s ä¸­æŸ¥åˆ°å½“å‰çš„èµ„æºå¯¹è±¡ï¼Œå¹¶æ‰“å¼€ä¸€ä¸ªå‘½ä»¤è¡Œç¼–è¾‘å™¨ï¼ˆé»˜è®¤ç”¨ viï¼‰ä¸ºç”¨æˆ·æä¾›ç¼–è¾‘ç•Œé¢ã€‚ å½“ç”¨æˆ·ä¿®æ”¹å®Œæˆã€ä¿å­˜é€€å‡ºæ—¶ï¼Œkubectl å¹¶éç›´æ¥æŠŠä¿®æ”¹åçš„å¯¹è±¡æäº¤ updateï¼ˆé¿å… Conflictï¼Œå¦‚æœç”¨æˆ·ä¿®æ”¹çš„è¿‡ç¨‹ä¸­èµ„æºå¯¹è±¡åˆè¢«æ›´æ–°ï¼‰ï¼Œè€Œæ˜¯ä¼šæŠŠä¿®æ”¹åçš„å¯¹è±¡å’Œåˆå§‹æ‹¿åˆ°çš„å¯¹è±¡è®¡ç®— diffï¼Œæœ€åå°† diff å†…å®¹ç”¨ patch è¯·æ±‚æäº¤ç»™ K8sã€‚ ","date":"2020-11-21","objectID":"/kubernetes/patch-update/:3:6","tags":["kubernetes","api","patch","update"],"title":"kubernetes ä¸­patchä¸updateæ¯”è¾ƒ","uri":"/kubernetes/patch-update/"},{"categories":null,"content":"æ€»ç»“ çœ‹äº†ä¸Šè¿°çš„ä»‹ç»ï¼Œå¤§å®¶åº”è¯¥å¯¹ K8s æ›´æ–°æœºåˆ¶æœ‰äº†ä¸€ä¸ªåˆæ­¥çš„äº†è§£äº†ã€‚æ¥ä¸‹æ¥æƒ³ä¸€æƒ³ï¼Œæ—¢ç„¶ K8s æä¾›äº†ä¸¤ç§æ›´æ–°æ–¹å¼ï¼Œæˆ‘ä»¬åœ¨ä¸åŒçš„åœºæ™¯ä¸‹æ€ä¹ˆé€‰æ‹© update æˆ– patch æ¥ä½¿ç”¨å‘¢ï¼Ÿè¿™é‡Œæˆ‘ä»¬çš„å»ºè®®æ˜¯ï¼š å¦‚æœè¦æ›´æ–°çš„å­—æ®µåªæœ‰æˆ‘ä»¬è‡ªå·±ä¼šä¿®æ”¹ï¼ˆæ¯”å¦‚æˆ‘ä»¬æœ‰ä¸€äº›è‡ªå®šä¹‰æ ‡ç­¾ï¼Œå¹¶å†™äº† operator æ¥ç®¡ç†ï¼‰ï¼Œåˆ™ä½¿ç”¨ patch æ˜¯æœ€ç®€å•çš„æ–¹å¼ï¼› å¦‚æœè¦æ›´æ–°çš„å­—æ®µå¯èƒ½ä¼šè¢«å…¶ä»–æ–¹ä¿®æ”¹ï¼ˆæ¯”å¦‚æˆ‘ä»¬ä¿®æ”¹çš„ replicas å­—æ®µï¼Œå¯èƒ½æœ‰ä¸€äº›å…¶ä»–ç»„ä»¶æ¯”å¦‚ HPA ä¹Ÿä¼šåšä¿®æ”¹ï¼‰ï¼Œåˆ™å»ºè®®ä½¿ç”¨ update æ¥æ›´æ–°ï¼Œé¿å…å‡ºç°äº’ç›¸è¦†ç›–ã€‚ ","date":"2020-11-21","objectID":"/kubernetes/patch-update/:4:0","tags":["kubernetes","api","patch","update"],"title":"kubernetes ä¸­patchä¸updateæ¯”è¾ƒ","uri":"/kubernetes/patch-update/"},{"categories":null,"content":"å‚è€ƒ https://aijishu.com/a/1060000000118183 ","date":"2020-11-21","objectID":"/kubernetes/patch-update/:5:0","tags":["kubernetes","api","patch","update"],"title":"kubernetes ä¸­patchä¸updateæ¯”è¾ƒ","uri":"/kubernetes/patch-update/"},{"categories":null,"content":"kubernetes ä¸­patchä¸updateæ¯”è¾ƒ","date":"2020-11-21","objectID":"/patch-update/","tags":["kubernetes","api","patch","update"],"title":"kubernetes ä¸­patchä¸updateæ¯”è¾ƒ","uri":"/patch-update/"},{"categories":null,"content":"å¯¼è¯» ä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰æƒ³è¿‡ä¸€ä¸ªé—®é¢˜ï¼šå¯¹äºä¸€ä¸ª K8s èµ„æºå¯¹è±¡æ¯”å¦‚ Deploymentï¼Œæˆ‘ä»¬å°è¯•åœ¨ä¿®æ”¹å…¶ä¸­ image é•œåƒæ—¶ï¼Œå¦‚æœæœ‰å…¶ä»–äººåŒæ—¶ä¹Ÿåœ¨å¯¹è¿™ä¸ª Deployment åšä¿®æ”¹ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ å½“ç„¶ï¼Œè¿™é‡Œè¿˜å¯ä»¥å¼•ç”³å‡ºä¸¤ä¸ªé—®é¢˜ï¼š å¦‚æœåŒæ–¹ä¿®æ”¹çš„æ˜¯åŒä¸€ä¸ªå­—æ®µï¼Œæ¯”å¦‚ image å­—æ®µï¼Œç»“æœä¼šæ€æ ·ï¼Ÿ å¦‚æœåŒæ–¹ä¿®æ”¹çš„æ˜¯ä¸åŒå­—æ®µï¼Œæ¯”å¦‚ä¸€ä¸ªä¿®æ”¹ imageï¼Œå¦ä¸€ä¸ªä¿®æ”¹ replicasï¼Œåˆä¼šæ€ä¹ˆæ ·ï¼Ÿ å…¶å®ï¼Œå¯¹ä¸€ä¸ª Kubernetes èµ„æºå¯¹è±¡åšâ€œæ›´æ–°â€æ“ä½œï¼Œç®€å•æ¥è¯´å°±æ˜¯é€šçŸ¥ kube-apiserver ç»„ä»¶æˆ‘ä»¬å¸Œæœ›å¦‚ä½•ä¿®æ”¹è¿™ä¸ªå¯¹è±¡ã€‚è€Œ K8s ä¸ºè¿™ç±»éœ€æ±‚å®šä¹‰äº†ä¸¤ç§â€œé€šçŸ¥â€æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯ update å’Œ patchã€‚åœ¨ update è¯·æ±‚ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å°†æ•´ä¸ªä¿®æ”¹åçš„å¯¹è±¡æäº¤ç»™ K8sï¼›è€Œå¯¹äº patch è¯·æ±‚ï¼Œæˆ‘ä»¬åªéœ€è¦å°†å¯¹è±¡ä¸­æŸäº›å­—æ®µçš„ä¿®æ”¹æäº¤ç»™ K8sã€‚ ","date":"2020-11-21","objectID":"/patch-update/:1:0","tags":["kubernetes","api","patch","update"],"title":"kubernetes ä¸­patchä¸updateæ¯”è¾ƒ","uri":"/patch-update/"},{"categories":null,"content":"Update æœºåˆ¶ Kubernetes ä¸­çš„æ‰€æœ‰èµ„æºå¯¹è±¡ï¼Œéƒ½æœ‰ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„ç‰ˆæœ¬å·ï¼ˆmetadata.resourceVersionï¼‰ã€‚æ¯ä¸ªèµ„æºå¯¹è±¡ä»åˆ›å»ºå¼€å§‹å°±ä¼šæœ‰ä¸€ä¸ªç‰ˆæœ¬å·ï¼Œè€Œåæ¯æ¬¡è¢«ä¿®æ”¹ï¼ˆä¸ç®¡æ˜¯ update è¿˜æ˜¯ patch ä¿®æ”¹ï¼‰ï¼Œç‰ˆæœ¬å·éƒ½ä¼šå‘ç”Ÿå˜åŒ–ã€‚ å®˜æ–¹æ–‡æ¡£ å‘Šè¯‰æˆ‘ä»¬ï¼Œè¿™ä¸ªç‰ˆæœ¬å·æ˜¯ä¸€ä¸ª K8s çš„å†…éƒ¨æœºåˆ¶ï¼Œç”¨æˆ·ä¸åº”è¯¥å‡è®¾å®ƒæ˜¯ä¸€ä¸ªæ•°å­—æˆ–è€…é€šè¿‡æ¯”è¾ƒä¸¤ä¸ªç‰ˆæœ¬å·å¤§å°æ¥ç¡®å®šèµ„æºå¯¹è±¡çš„æ–°æ—§ï¼Œå”¯ä¸€èƒ½åšçš„å°±æ˜¯é€šè¿‡æ¯”è¾ƒç‰ˆæœ¬å·ç›¸ç­‰æ¥ç¡®å®šå¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªç‰ˆæœ¬ï¼ˆå³æ˜¯å¦å‘ç”Ÿäº†å˜åŒ–ï¼‰ã€‚è€Œ resourceVersion ä¸€ä¸ªé‡è¦çš„ç”¨å¤„ï¼Œå°±æ˜¯æ¥åš update è¯·æ±‚çš„ç‰ˆæœ¬æ§åˆ¶ã€‚ K8s è¦æ±‚ç”¨æˆ· update è¯·æ±‚ä¸­æäº¤çš„å¯¹è±¡å¿…é¡»å¸¦æœ‰ resourceVersionï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æäº¤ update çš„æ•°æ®å¿…é¡»å…ˆæ¥æºäº K8s ä¸­å·²ç»å­˜åœ¨çš„å¯¹è±¡ã€‚å› æ­¤ï¼Œä¸€æ¬¡å®Œæ•´çš„ update æ“ä½œæµç¨‹æ˜¯ï¼š é¦–å…ˆï¼Œä» K8s ä¸­æ‹¿åˆ°ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å¯¹è±¡ï¼ˆå¯ä»¥é€‰æ‹©ç›´æ¥ä» K8s ä¸­æŸ¥è¯¢ï¼›å¦‚æœåœ¨å®¢æˆ·ç«¯åšäº† list watchï¼Œæ¨èä»æœ¬åœ° informer ä¸­è·å–ï¼‰ï¼› ç„¶åï¼ŒåŸºäºè¿™ä¸ªå–å‡ºæ¥çš„å¯¹è±¡åšä¸€äº›ä¿®æ”¹ï¼Œæ¯”å¦‚å°† Deployment ä¸­çš„ replicas åšå¢å‡ï¼Œæˆ–æ˜¯å°† image å­—æ®µä¿®æ”¹ä¸ºä¸€ä¸ªæ–°ç‰ˆæœ¬çš„é•œåƒï¼› æœ€åï¼Œå°†ä¿®æ”¹åçš„å¯¹è±¡é€šè¿‡ update è¯·æ±‚æäº¤ç»™ K8sï¼› æ­¤æ—¶ï¼Œkube-apiserver ä¼šæ ¡éªŒç”¨æˆ· update è¯·æ±‚æäº¤å¯¹è±¡ä¸­çš„ resourceVersion ä¸€å®šè¦å’Œå½“å‰ K8s ä¸­è¿™ä¸ªå¯¹è±¡æœ€æ–°çš„ resourceVersion ä¸€è‡´ï¼Œæ‰èƒ½æ¥å—æœ¬æ¬¡ updateã€‚å¦åˆ™ï¼ŒK8s ä¼šæ‹’ç»è¯·æ±‚ï¼Œå¹¶å‘Šè¯‰ç”¨æˆ·å‘ç”Ÿäº†ç‰ˆæœ¬å†²çªï¼ˆConflictï¼‰ã€‚ ä¸Šå›¾å±•ç¤ºäº†å¤šä¸ªç”¨æˆ·åŒæ—¶ update æŸä¸€ä¸ªèµ„æºå¯¹è±¡æ—¶ä¼šå‘ç”Ÿçš„äº‹æƒ…ã€‚è€Œå¦‚æœå¦‚æœå‘ç”Ÿäº† Conflict å†²çªï¼Œå¯¹äº User A è€Œè¨€åº”è¯¥åšçš„å°±æ˜¯åšä¸€æ¬¡é‡è¯•ï¼Œå†æ¬¡è·å–åˆ°æœ€æ–°ç‰ˆæœ¬çš„å¯¹è±¡ï¼Œä¿®æ”¹åé‡æ–°æäº¤ updateã€‚ å› æ­¤ï¼Œæˆ‘ä»¬ä¸Šé¢çš„ä¸¤ä¸ªé—®é¢˜ä¹Ÿéƒ½å¾—åˆ°äº†è§£ç­”ï¼š ç”¨æˆ·ä¿®æ”¹ YAML åæäº¤ update å¤±è´¥ï¼Œæ˜¯å› ä¸º YAML æ–‡ä»¶ä¸­æ²¡æœ‰åŒ…å« resourceVersion å­—æ®µã€‚å¯¹äº update è¯·æ±‚è€Œè¨€ï¼Œåº”è¯¥å–å‡ºå½“å‰ K8s ä¸­çš„å¯¹è±¡åšä¿®æ”¹åæäº¤ï¼› å¦‚æœä¸¤ä¸ªç”¨æˆ·åŒæ—¶å¯¹ä¸€ä¸ªèµ„æºå¯¹è±¡åš updateï¼Œä¸ç®¡æ“ä½œçš„æ˜¯å¯¹è±¡ä¸­åŒä¸€ä¸ªå­—æ®µè¿˜æ˜¯ä¸åŒå­—æ®µï¼Œéƒ½å­˜åœ¨ç‰ˆæœ¬æ§åˆ¶çš„æœºåˆ¶ç¡®ä¿ä¸¤ä¸ªç”¨æˆ·çš„ update è¯·æ±‚ä¸ä¼šå‘ç”Ÿè¦†ç›–ã€‚ ","date":"2020-11-21","objectID":"/patch-update/:2:0","tags":["kubernetes","api","patch","update"],"title":"kubernetes ä¸­patchä¸updateæ¯”è¾ƒ","uri":"/patch-update/"},{"categories":null,"content":"Patch æœºåˆ¶ ç›¸æ¯”äº update çš„ç‰ˆæœ¬æ§åˆ¶ï¼ŒK8s çš„ patch æœºåˆ¶åˆ™æ˜¾å¾—æ›´åŠ ç®€å•ã€‚ å½“ç”¨æˆ·å¯¹æŸä¸ªèµ„æºå¯¹è±¡æäº¤ä¸€ä¸ª patch è¯·æ±‚æ—¶ï¼Œkube-apiserver ä¸ä¼šè€ƒè™‘ç‰ˆæœ¬é—®é¢˜ï¼Œè€Œæ˜¯â€œæ— è„‘â€åœ°æ¥å—ç”¨æˆ·çš„è¯·æ±‚ï¼ˆåªè¦è¯·æ±‚å‘é€çš„ patch å†…å®¹åˆæ³•ï¼‰ï¼Œä¹Ÿå°±æ˜¯å°† patch æ‰“åˆ°å¯¹è±¡ä¸Šã€åŒæ—¶æ›´æ–°ç‰ˆæœ¬å·ã€‚ ä¸è¿‡ï¼Œpatch çš„å¤æ‚ç‚¹åœ¨äºï¼Œç›®å‰ K8s æä¾›äº† 4 ç§ patch ç­–ç•¥ï¼šjson patchã€merge patchã€strategic merge patchã€apply patchï¼ˆä» K8s 1.14 æ”¯æŒ server-side apply å¼€å§‹ï¼‰ã€‚é€šè¿‡ kubectl patch -h å‘½ä»¤æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°è¿™ä¸ªç­–ç•¥é€‰é¡¹ï¼ˆé»˜è®¤é‡‡ç”¨ strategicï¼‰ï¼š $ kubectl patch -h # ... --type='strategic': The type of patch being provided; one of [json merge strategic] ç¯‡å¹…é™åˆ¶è¿™é‡Œæš‚ä¸å¯¹æ¯ä¸ªç­–ç•¥åšè¯¦ç»†çš„ä»‹ç»äº†ï¼Œæˆ‘ä»¬å°±ä»¥ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥çœ‹ä¸€ä¸‹å®ƒä»¬çš„å·®å¼‚æ€§ã€‚å¦‚æœé’ˆå¯¹ä¸€ä¸ªå·²æœ‰çš„ Deployment å¯¹è±¡ï¼Œå‡è®¾ template ä¸­å·²ç»æœ‰äº†ä¸€ä¸ªåä¸º app çš„å®¹å™¨ï¼š å¦‚æœè¦åœ¨å…¶ä¸­æ–°å¢ä¸€ä¸ª nginx å®¹å™¨ï¼Œå¦‚ä½• patch æ›´æ–°ï¼Ÿ å¦‚æœè¦ä¿®æ”¹ app å®¹å™¨çš„é•œåƒï¼Œå¦‚ä½• patch æ›´æ–°ï¼Ÿ ","date":"2020-11-21","objectID":"/patch-update/:3:0","tags":["kubernetes","api","patch","update"],"title":"kubernetes ä¸­patchä¸updateæ¯”è¾ƒ","uri":"/patch-update/"},{"categories":null,"content":"json patch æ–°å¢å®¹å™¨ï¼š kubectl patch deployment/foo --type='json' -p \\ '[{\"op\":\"add\",\"path\":\"/spec/template/spec/containers/1\",\"value\":{\"name\":\"nginx\",\"image\":\"nginx:alpine\"}}]' ä¿®æ”¹å·²æœ‰å®¹å™¨ imageï¼š kubectl patch deployment/foo --type='json' -p \\ '[{\"op\":\"replace\",\"path\":\"/spec/template/spec/containers/0/image\",\"value\":\"app-image:v2\"}]' è¿™æ ·ä¸€æ¥ï¼Œå¦‚æœæˆ‘ä»¬ patch ä¹‹å‰è¿™ä¸ªå¯¹è±¡å·²ç»è¢«å…¶ä»–äººä¿®æ”¹äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ patch æœ‰å¯èƒ½äº§ç”Ÿéé¢„æœŸçš„åæœã€‚æ¯”å¦‚åœ¨æ‰§è¡Œ app å®¹å™¨é•œåƒæ›´æ–°æ—¶ï¼Œæˆ‘ä»¬æŒ‡å®šçš„åºå·æ˜¯ 0ï¼Œä½†æ­¤æ—¶ containers åˆ—è¡¨ä¸­ç¬¬ä¸€ä¸ªä½ç½®è¢«æ’å…¥äº†å¦ä¸€ä¸ªå®¹å™¨ï¼Œåˆ™æ›´æ–°çš„é•œåƒå°±è¢«é”™è¯¯åœ°æ’å…¥åˆ°è¿™ä¸ªéé¢„æœŸçš„å®¹å™¨ä¸­ã€‚ ","date":"2020-11-21","objectID":"/patch-update/:3:1","tags":["kubernetes","api","patch","update"],"title":"kubernetes ä¸­patchä¸updateæ¯”è¾ƒ","uri":"/patch-update/"},{"categories":null,"content":"merge patch merge patch æ— æ³•å•ç‹¬æ›´æ–°ä¸€ä¸ªåˆ—è¡¨ä¸­çš„æŸä¸ªå…ƒç´ ï¼Œå› æ­¤ä¸ç®¡æˆ‘ä»¬æ˜¯è¦åœ¨ containers é‡Œæ–°å¢å®¹å™¨ã€è¿˜æ˜¯ä¿®æ”¹å·²æœ‰å®¹å™¨çš„ imageã€env ç­‰å­—æ®µï¼Œéƒ½è¦ç”¨æ•´ä¸ª containers åˆ—è¡¨æ¥æäº¤ patchï¼š kubectl patch deployment/foo --type='merge' -p \\ '{\"spec\":{\"template\":{\"spec\":{\"containers\":[{\"name\":\"app\",\"image\":\"app-image:v2\"},{\"name\":\"nginx\",\"image\":\"nginx:alpline\"}]}}}}' æ˜¾ç„¶ï¼Œè¿™ä¸ªç­–ç•¥å¹¶ä¸é€‚åˆæˆ‘ä»¬å¯¹ä¸€äº›åˆ—è¡¨æ·±å±‚çš„å­—æ®µåšæ›´æ–°ï¼Œæ›´é€‚ç”¨äºå¤§ç‰‡æ®µçš„è¦†ç›–æ›´æ–°ã€‚ ä¸è¿‡å¯¹äº labels/annotations è¿™äº› map ç±»å‹çš„å…ƒç´ æ›´æ–°ï¼Œmerge patch æ˜¯å¯ä»¥å•ç‹¬æŒ‡å®š key-value æ“ä½œçš„ï¼Œç›¸æ¯”äº json patch æ–¹ä¾¿ä¸€äº›ï¼Œå†™èµ·æ¥ä¹Ÿæ›´åŠ ç›´è§‚ï¼š kubectl patch deployment/foo â€“type='mergeâ€™ -p â€˜{â€œmetadataâ€:{â€œlabelsâ€:{â€œtest-keyâ€:â€œfooâ€}}}â€™ ","date":"2020-11-21","objectID":"/patch-update/:3:2","tags":["kubernetes","api","patch","update"],"title":"kubernetes ä¸­patchä¸updateæ¯”è¾ƒ","uri":"/patch-update/"},{"categories":null,"content":"strategic merge patch è¿™ç§ patch ç­–ç•¥å¹¶æ²¡æœ‰ä¸€ä¸ªé€šç”¨çš„ RFC æ ‡å‡†ï¼Œè€Œæ˜¯ K8s ç‹¬æœ‰çš„ï¼Œä¸è¿‡ç›¸æ¯”å‰ä¸¤ç§è€Œè¨€å´æ›´ä¸ºå¼ºå¤§çš„ã€‚ æˆ‘ä»¬å…ˆä» K8s æºç çœ‹èµ·ï¼Œåœ¨ K8s åŸç”Ÿèµ„æºçš„æ•°æ®ç»“æ„å®šä¹‰ä¸­é¢å¤–å®šä¹‰äº†ä¸€äº›çš„ç­–ç•¥æ³¨è§£ã€‚æ¯”å¦‚ä»¥ä¸‹è¿™ä¸ªæˆªå–äº† podSpec ä¸­é’ˆå¯¹ containers åˆ—è¡¨çš„å®šä¹‰ // ... // +patchMergeKey=name // +patchStrategy=merge Containers []Container `json:\"containers\" patchStrategy:\"merge\" patchMergeKey:\"name\" protobuf:\"bytes,2,rep,name=containers\"` å¯ä»¥çœ‹åˆ°å…¶ä¸­æœ‰ä¸¤ä¸ªå…³é”®ä¿¡æ¯ï¼špatchStrategy:â€œmergeâ€ patchMergeKey:â€œnameâ€ ã€‚è¿™å°±ä»£è¡¨äº†ï¼Œcontainers åˆ—è¡¨ä½¿ç”¨ strategic merge patch ç­–ç•¥æ›´æ–°æ—¶ï¼Œä¼šæŠŠä¸‹é¢æ¯ä¸ªå…ƒç´ ä¸­çš„ name å­—æ®µçœ‹ä½œ keyã€‚ ç®€å•æ¥è¯´ï¼Œåœ¨æˆ‘ä»¬ patch æ›´æ–° containers ä¸å†éœ€è¦æŒ‡å®šä¸‹æ ‡åºå·äº†ï¼Œè€Œæ˜¯æŒ‡å®š name æ¥ä¿®æ”¹ï¼ŒK8s ä¼šæŠŠ name ä½œä¸º key æ¥è®¡ç®— mergeã€‚æ¯”å¦‚é’ˆå¯¹ä»¥ä¸‹çš„ patch æ“ä½œï¼š kubectl patch deployment/foo -p \\ '{\"spec\":{\"template\":{\"spec\":{\"containers\":[{\"name\":\"nginx\",\"image\":\"nginx:mainline\"}]}}}}' å¦‚æœ K8s å‘ç°å½“å‰ containers ä¸­å·²ç»æœ‰åå­—ä¸º nginx çš„å®¹å™¨ï¼Œåˆ™åªä¼šæŠŠ image æ›´æ–°ä¸Šå»ï¼›è€Œå¦‚æœå½“å‰ containers ä¸­æ²¡æœ‰ nginx å®¹å™¨ï¼ŒK8s ä¼šæŠŠè¿™ä¸ªå®¹å™¨æ’å…¥ containers åˆ—è¡¨ã€‚ æ­¤å¤–è¿˜è¦è¯´æ˜çš„æ˜¯ï¼Œç›®å‰ strategic ç­–ç•¥åªèƒ½ç”¨äºåŸç”Ÿ K8s èµ„æºä»¥åŠ Aggregated API æ–¹å¼çš„è‡ªå®šä¹‰èµ„æºï¼Œå¯¹äº CRD å®šä¹‰çš„èµ„æºå¯¹è±¡ï¼Œæ˜¯æ— æ³•ä½¿ç”¨çš„ã€‚è¿™å¾ˆå¥½ç†è§£ï¼Œå› ä¸º kube-apiserver æ— æ³•å¾—çŸ¥ CRD èµ„æºçš„ç»“æ„å’Œ merge ç­–ç•¥ã€‚å¦‚æœç”¨ kubectl patch å‘½ä»¤æ›´æ–°ä¸€ä¸ª CRï¼Œåˆ™é»˜è®¤ä¼šé‡‡ç”¨ merge patch çš„ç­–ç•¥æ¥æ“ä½œã€‚ ","date":"2020-11-21","objectID":"/patch-update/:3:3","tags":["kubernetes","api","patch","update"],"title":"kubernetes ä¸­patchä¸updateæ¯”è¾ƒ","uri":"/patch-update/"},{"categories":null,"content":"kubectl å°è£… äº†è§£å®Œäº† K8s çš„åŸºç¡€æ›´æ–°æœºåˆ¶ï¼Œæˆ‘ä»¬å†æ¬¡å›åˆ°æœ€åˆçš„é—®é¢˜ä¸Šã€‚ä¸ºä»€ä¹ˆç”¨æˆ·ä¿®æ”¹ YAML æ–‡ä»¶åæ— æ³•ç›´æ¥è°ƒç”¨ update æ¥å£æ›´æ–°ï¼Œå´å¯ä»¥é€šè¿‡ kubectl apply å‘½ä»¤æ›´æ–°å‘¢ï¼Ÿ å…¶å® kubectl ä¸ºäº†ç»™å‘½ä»¤è¡Œç”¨æˆ·æä¾›è‰¯å¥½çš„äº¤äº’ä½“æ„Ÿï¼Œè®¾è®¡äº†è¾ƒä¸ºå¤æ‚çš„å†…éƒ¨æ‰§è¡Œé€»è¾‘ï¼Œè¯¸å¦‚ applyã€edit è¿™äº›å¸¸ç”¨æ“ä½œå…¶å®èƒŒåå¹¶éå¯¹åº”ä¸€æ¬¡ç®€å•çš„ update è¯·æ±‚ã€‚æ¯•ç«Ÿ update æ˜¯æœ‰ç‰ˆæœ¬æ§åˆ¶çš„ï¼Œå¦‚æœå‘ç”Ÿäº†æ›´æ–°å†²çªå¯¹äºæ™®é€šç”¨æˆ·å¹¶ä¸å‹å¥½ã€‚ä»¥ä¸‹ç®€ç•¥ä»‹ç»ä¸‹ kubectl å‡ ç§æ›´æ–°æ“ä½œçš„é€»è¾‘ï¼Œæœ‰å…´è¶£å¯ä»¥çœ‹ä¸€ä¸‹ link:https://github.com/kubernetes/kubectl[kubectl] å°è£…çš„æºç ã€‚ ","date":"2020-11-21","objectID":"/patch-update/:3:4","tags":["kubernetes","api","patch","update"],"title":"kubernetes ä¸­patchä¸updateæ¯”è¾ƒ","uri":"/patch-update/"},{"categories":null,"content":"apply åœ¨ä½¿ç”¨é»˜è®¤å‚æ•°æ‰§è¡Œ apply æ—¶ï¼Œè§¦å‘çš„æ˜¯ client-side applyã€‚kubectl é€»è¾‘å¦‚ä¸‹ï¼š é¦–å…ˆè§£æç”¨æˆ·æäº¤çš„æ•°æ®ï¼ˆYAML/JSONï¼‰ä¸ºä¸€ä¸ªå¯¹è±¡ Aï¼›ç„¶åè°ƒç”¨ Get æ¥å£ä» K8s ä¸­æŸ¥è¯¢è¿™ä¸ªèµ„æºå¯¹è±¡ï¼š å¦‚æœæŸ¥è¯¢ç»“æœä¸å­˜åœ¨ï¼Œkubectl å°†æœ¬æ¬¡ç”¨æˆ·æäº¤çš„æ•°æ®è®°å½•åˆ°å¯¹è±¡ A çš„ annotation ä¸­ï¼ˆkey ä¸º kubectl.kubernetes.io/last-applied-configurationï¼‰ï¼Œæœ€åå°†å¯¹è±¡ Aæäº¤ç»™ K8s åˆ›å»ºï¼› å¦‚æœæŸ¥è¯¢åˆ° K8s ä¸­å·²æœ‰è¿™ä¸ªèµ„æºï¼Œå‡è®¾ä¸ºå¯¹è±¡ Bï¼š1. kubectl å°è¯•ä»å¯¹è±¡ B çš„ annotation ä¸­å–å‡º kubectl.kubernetes.io/last-applied-configuration çš„å€¼ï¼ˆå¯¹åº”äº†ä¸Šä¸€æ¬¡ apply æäº¤çš„å†…å®¹ï¼‰ï¼›2. kubectl æ ¹æ®å‰ä¸€æ¬¡ apply çš„å†…å®¹å’Œæœ¬æ¬¡ apply çš„å†…å®¹è®¡ç®—å‡º diffï¼ˆé»˜è®¤ä¸º strategic merge patch æ ¼å¼ï¼Œå¦‚æœéåŸç”Ÿèµ„æºåˆ™é‡‡ç”¨ merge patchï¼‰ï¼›3. å°† diff ä¸­æ·»åŠ æœ¬æ¬¡çš„ kubectl.kubernetes.io/last-applied-configuration annotationï¼Œæœ€åç”¨ patch è¯·æ±‚æäº¤ç»™ K8s åšæ›´æ–°ã€‚ ","date":"2020-11-21","objectID":"/patch-update/:3:5","tags":["kubernetes","api","patch","update"],"title":"kubernetes ä¸­patchä¸updateæ¯”è¾ƒ","uri":"/patch-update/"},{"categories":null,"content":"edit kubectl edit é€»è¾‘ä¸Šæ›´ç®€å•ä¸€äº›ã€‚åœ¨ç”¨æˆ·æ‰§è¡Œå‘½ä»¤ä¹‹åï¼Œkubectl ä» K8s ä¸­æŸ¥åˆ°å½“å‰çš„èµ„æºå¯¹è±¡ï¼Œå¹¶æ‰“å¼€ä¸€ä¸ªå‘½ä»¤è¡Œç¼–è¾‘å™¨ï¼ˆé»˜è®¤ç”¨ viï¼‰ä¸ºç”¨æˆ·æä¾›ç¼–è¾‘ç•Œé¢ã€‚ å½“ç”¨æˆ·ä¿®æ”¹å®Œæˆã€ä¿å­˜é€€å‡ºæ—¶ï¼Œkubectl å¹¶éç›´æ¥æŠŠä¿®æ”¹åçš„å¯¹è±¡æäº¤ updateï¼ˆé¿å… Conflictï¼Œå¦‚æœç”¨æˆ·ä¿®æ”¹çš„è¿‡ç¨‹ä¸­èµ„æºå¯¹è±¡åˆè¢«æ›´æ–°ï¼‰ï¼Œè€Œæ˜¯ä¼šæŠŠä¿®æ”¹åçš„å¯¹è±¡å’Œåˆå§‹æ‹¿åˆ°çš„å¯¹è±¡è®¡ç®— diffï¼Œæœ€åå°† diff å†…å®¹ç”¨ patch è¯·æ±‚æäº¤ç»™ K8sã€‚ ","date":"2020-11-21","objectID":"/patch-update/:3:6","tags":["kubernetes","api","patch","update"],"title":"kubernetes ä¸­patchä¸updateæ¯”è¾ƒ","uri":"/patch-update/"},{"categories":null,"content":"æ€»ç»“ çœ‹äº†ä¸Šè¿°çš„ä»‹ç»ï¼Œå¤§å®¶åº”è¯¥å¯¹ K8s æ›´æ–°æœºåˆ¶æœ‰äº†ä¸€ä¸ªåˆæ­¥çš„äº†è§£äº†ã€‚æ¥ä¸‹æ¥æƒ³ä¸€æƒ³ï¼Œæ—¢ç„¶ K8s æä¾›äº†ä¸¤ç§æ›´æ–°æ–¹å¼ï¼Œæˆ‘ä»¬åœ¨ä¸åŒçš„åœºæ™¯ä¸‹æ€ä¹ˆé€‰æ‹© update æˆ– patch æ¥ä½¿ç”¨å‘¢ï¼Ÿè¿™é‡Œæˆ‘ä»¬çš„å»ºè®®æ˜¯ï¼š å¦‚æœè¦æ›´æ–°çš„å­—æ®µåªæœ‰æˆ‘ä»¬è‡ªå·±ä¼šä¿®æ”¹ï¼ˆæ¯”å¦‚æˆ‘ä»¬æœ‰ä¸€äº›è‡ªå®šä¹‰æ ‡ç­¾ï¼Œå¹¶å†™äº† operator æ¥ç®¡ç†ï¼‰ï¼Œåˆ™ä½¿ç”¨ patch æ˜¯æœ€ç®€å•çš„æ–¹å¼ï¼› å¦‚æœè¦æ›´æ–°çš„å­—æ®µå¯èƒ½ä¼šè¢«å…¶ä»–æ–¹ä¿®æ”¹ï¼ˆæ¯”å¦‚æˆ‘ä»¬ä¿®æ”¹çš„ replicas å­—æ®µï¼Œå¯èƒ½æœ‰ä¸€äº›å…¶ä»–ç»„ä»¶æ¯”å¦‚ HPA ä¹Ÿä¼šåšä¿®æ”¹ï¼‰ï¼Œåˆ™å»ºè®®ä½¿ç”¨ update æ¥æ›´æ–°ï¼Œé¿å…å‡ºç°äº’ç›¸è¦†ç›–ã€‚ ","date":"2020-11-21","objectID":"/patch-update/:4:0","tags":["kubernetes","api","patch","update"],"title":"kubernetes ä¸­patchä¸updateæ¯”è¾ƒ","uri":"/patch-update/"},{"categories":null,"content":"å‚è€ƒ https://aijishu.com/a/1060000000118183 ","date":"2020-11-21","objectID":"/patch-update/:5:0","tags":["kubernetes","api","patch","update"],"title":"kubernetes ä¸­patchä¸updateæ¯”è¾ƒ","uri":"/patch-update/"},{"categories":null,"content":"kubectl å¸¸ç”¨å‘½ä»¤æŒ‡å—","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"å¯¼è¯» kubectl åº”è¯¥æ˜¯æ¯ä¸ªæ¥è§¦ kubernetes çš„äººéƒ½ä¼šæ¥è§¦çš„ä¸€ä¸ªç»„ä»¶ï¼Œå®ƒå¸¦ç»™æˆ‘ä»¬å¼ºå¤§çš„å‘½ä»¤è¡Œä½“éªŒï¼Œæœ¬ç¯‡æ–‡ç« å°±æ˜¯ä»‹ç» kubectl ä¸­çš„ä¸€äº›å¸¸ç”¨å‘½ä»¤ï¼Œåœ¨ç»“åˆä¸€äº›å…·ä½“çš„ä½¿ç”¨åœºæ™¯è¯´è¯´å¦‚ä½•åˆ©ç”¨ kubectl å®ç°ã€‚å¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ï¼Œåœ¨è¿™é‡Œå°½å¯èƒ½å…¨çš„ç½—åˆ—ï¼Œæ–¹ä¾¿åç»­ ç”¨çš„æ—¶å€™æŸ¥æ‰¾ã€‚å¦‚æœèƒ½å¸®åˆ°æ‚¨å°±æ”¶è—èµ·æ¥å§(ğŸ˜„)ã€‚ æœ¬æ¬¡å®éªŒç¯å¢ƒæ˜¯ kubernetes-1.16.9ï¼Œæœ¬ç¯‡æ–‡æ¡£çš„å†™ä½œæ€è·¯æ˜¯æŒ‰ç…§å¹³æ—¶ çš„ä½¿ç”¨åœºæ™¯è¿›è¡Œå†™ä½œï¼Œä¸ä¼šè¯¦ç»†ä»‹ç» kubectl çš„å‘½ä»¤ï¼Œkubectl è¯¦ç»†çš„å¸®åŠ©æ–‡æ¡£å‚è€ƒ kubectl --help or kubectl command --help ã€‚ ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:1:0","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"kubectl æ”¯æŒçš„å‘½ä»¤ kubectl --help kubectl controls the Kubernetes cluster manager. Find more information at: https://kubernetes.io/docs/reference/kubectl/overview/ Basic Commands (Beginner): create Create a resource from a file or from stdin. expose ä½¿ç”¨ replication controller, service, deployment æˆ–è€… pod å¹¶æš´éœ²å®ƒä½œä¸ºä¸€ä¸ª æ–°çš„ Kubernetes Service run åœ¨é›†ç¾¤ä¸­è¿è¡Œä¸€ä¸ªæŒ‡å®šçš„é•œåƒ set ä¸º objects è®¾ç½®ä¸€ä¸ªæŒ‡å®šçš„ç‰¹å¾ Basic Commands (Intermediate): explain æŸ¥çœ‹èµ„æºçš„æ–‡æ¡£ get æ˜¾ç¤ºä¸€ä¸ªæˆ–æ›´å¤š resources edit åœ¨æœåŠ¡å™¨ä¸Šç¼–è¾‘ä¸€ä¸ªèµ„æº delete Delete resources by filenames, stdin, resources and names, or by resources and label selector Deploy Commands: rollout Manage the rollout of a resource scale ä¸º Deployment, ReplicaSet, Replication Controller æˆ–è€… Job è®¾ç½®ä¸€ä¸ªæ–°çš„å‰¯æœ¬æ•°é‡ autoscale è‡ªåŠ¨è°ƒæ•´ä¸€ä¸ª Deployment, ReplicaSet, æˆ–è€… ReplicationController çš„å‰¯æœ¬æ•°é‡ Cluster Management Commands: certificate ä¿®æ”¹ certificate èµ„æº. cluster-info æ˜¾ç¤ºé›†ç¾¤ä¿¡æ¯ top Display Resource (CPU/Memory/Storage) usage. cordon æ ‡è®° node ä¸º unschedulable uncordon æ ‡è®° node ä¸º schedulable drain Drain node in preparation for maintenance taint æ›´æ–°ä¸€ä¸ªæˆ–è€…å¤šä¸ª node ä¸Šçš„ taints Troubleshooting and Debugging Commands: describe æ˜¾ç¤ºä¸€ä¸ªæŒ‡å®š resource æˆ–è€… group çš„ resources è¯¦æƒ… logs è¾“å‡ºå®¹å™¨åœ¨ pod ä¸­çš„æ—¥å¿— attach Attach åˆ°ä¸€ä¸ªè¿è¡Œä¸­çš„ container exec åœ¨ä¸€ä¸ª container ä¸­æ‰§è¡Œä¸€ä¸ªå‘½ä»¤ port-forward Forward one or more local ports to a pod proxy è¿è¡Œä¸€ä¸ª proxy åˆ° Kubernetes API server cp å¤åˆ¶ files å’Œ directories åˆ° containers å’Œä»å®¹å™¨ä¸­å¤åˆ¶ files å’Œ directories. auth Inspect authorization Advanced Commands: diff Diff live version against would-be applied version apply é€šè¿‡æ–‡ä»¶åæˆ–æ ‡å‡†è¾“å…¥æµ(stdin)å¯¹èµ„æºè¿›è¡Œé…ç½® patch ä½¿ç”¨ strategic merge patch æ›´æ–°ä¸€ä¸ªèµ„æºçš„ field(s) replace é€šè¿‡ filename æˆ–è€… stdinæ›¿æ¢ä¸€ä¸ªèµ„æº wait Experimental: Wait for a specific condition on one or many resources. convert åœ¨ä¸åŒçš„ API versions è½¬æ¢é…ç½®æ–‡ä»¶ kustomize Build a kustomization target from a directory or a remote url. Settings Commands: label æ›´æ–°åœ¨è¿™ä¸ªèµ„æºä¸Šçš„ labels annotate æ›´æ–°ä¸€ä¸ªèµ„æºçš„æ³¨è§£ completion Output shell completion code for the specified shell (bash or zsh) Other Commands: api-resources Print the supported API resources on the server api-versions Print the supported API versions on the server, in the form of \"group/version\" config ä¿®æ”¹ kubeconfig æ–‡ä»¶ plugin Provides utilities for interacting with plugins. version è¾“å‡º client å’Œ server çš„ç‰ˆæœ¬ä¿¡æ¯ Usage: kubectl [flags] [options] Use \"kubectl \u003ccommand\u003e --help\" for more information about a given command. Use \"kubectl options\" for a list of global command-line options (applies to all commands). ä»ä¸Šé¢çš„å¸®åŠ©æ–‡æ¡£å¯ä»¥çœ‹å‡ºï¼Œ kubectl åŸºæœ¬æ ¼å¼ä¸º kubectl verb resource options , kubectl åè·Ÿè°“è¯­åŠ¨è¯ï¼Œ å†è·Ÿè¦æ“ä½œçš„èµ„æºï¼Œå¯ä»¥åŠ  options ï¼Œå¦‚ï¼š è¦çœ‹ monitoring namespace ä¸‹é¢æœ‰å“ªäº›pod : kubectl -n monitoring get po ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:2:0","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"pod pod åœºæ™¯ä¸‹ï¼Œå¯èƒ½ä¼šæœ‰å¦‚ä¸‹éœ€æ±‚: ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:3:0","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"æŸ¥çœ‹æŸä¸ª namespace ä¸‹ï¼Œæ‰€æœ‰çš„pod # å…ˆæŸ¥çœ‹æœ‰å“ªäº›namespace kubectl get namespace # æŸ¥çœ‹ pod kubectl -n $namespace get po # æˆ–è€… kubectl get po -n $namespace ä¸Šé¢ä¸¤ç§å†™æ³•åœ¨è¾¾åˆ°çš„æ•ˆæœä¸Šæ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªç»†èŠ‚å¯ä»¥æ³¨æ„ä¸€ä¸‹ï¼Œå¦‚æœ kubectl ç¯å¢ƒæœ‰å‘½ä»¤è‡ªåŠ¨è¡¥å…¨çš„è¯ï¼Œèµ„æºå¯¹è±¡åˆæ¯”è¾ƒå¤š çš„æƒ…å†µä¸‹ï¼Œç¬¬ä¸€ç§å†™æ³•å°†ä¼šæœ‰æå¤§çš„ä¼˜åŠ¿ï¼Œå¯ä»¥æ€è€ƒè¿™ä¹ˆä¸ªåœºæ™¯ï¼Œå¦‚ï¼šè¦æŸ¥çœ‹ monitoring namespace ä¸‹çš„æŸä¸ªpod è¯¦æƒ…, å°±å¯ä»¥é€šè¿‡: kubectl -n monitoring get po åŠ  tab é”®ï¼Œåˆ—å‡ºè¿™ä¸ªnamespace ä¸‹çš„æ‰€æœ‰ pod ä¾›ç­›é€‰ã€‚ centos ä¸‹å‘½ä»¤è‡ªåŠ¨è¡¥å…¨éœ€è¦å®‰è£… bash-completion ï¼Œæ–¹æ³•ä¸º yum install -y bash-completion å¦‚æœä¸åŠ  -n $namespace ï¼Œåˆ™é»˜è®¤æ˜¯ default namespace ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:3:1","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"æŸ¥çœ‹æ‰€æœ‰namespace çš„pod kubectl get po --all-namespaces # or kubectl get po -A ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:3:2","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"æŸ¥çœ‹æŸä¸ªå…·ä½“çš„ pod ä¿¡æ¯ ï¼Œä»¥ wideã€jsonã€yaml çš„æ ¼å¼è¾“å‡º kubectl -n $namespace get po xxx -o wide/json/yaml # å¦‚ æŸ¥çœ‹ monitoring ä¸‹çš„ prometheus-0 pod ä¿¡æ¯ï¼Œå¹¶ä»¥yaml å½¢å¼è¾“å‡ºã€‚ kubectl -n monitoring get po prometheus-0 -o yaml ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:3:3","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"æŸ¥çœ‹æŸä¸ª pod çš„æŸä¸ªå­—æ®µä¿¡æ¯ å¦‚æœæˆ‘ä»¬åªæƒ³çŸ¥é“ pod çš„ hostIP æˆ–è€…å…¶ä»–çš„ ä¸€äº›å­—æ®µï¼Œ å¯ä»¥é€šè¿‡ -o jsonpath or -o template or -o go-template å…¶ä¸­template è¯­æ³•éµå¾ª golang template éœ€è¦å¯¹ pod çš„å¯¹è±¡æ¨¡å‹æœ‰ä¸€å®šçš„äº†è§£ï¼Œå¦‚æœä¸äº†è§£ï¼Œå¯ä»¥ -o yaml or -o json ç›´æ¥æŸ¥çœ‹ã€‚ æŸ¥çœ‹ hostIP çš„æ–¹æ³•å¦‚ä¸‹: # -o jsonpath kubectl -n monitoring get po prometheus-k8s-0 -o jsonpath=\"{.status.hostIP}\" # -o template kubectl -n monitoring get po prometheus-k8s-0 -o template --template=\"{{.status.hostIP}}\" # -o go-template kubectl -n monitoring get po prometheus-k8s-0 -o go-template=\"{{.status.hostIP}}\" å¦‚æœéœ€è¦æŸ¥çœ‹å…¶ä»–çš„å­—æ®µç…§çŒ«ç”»è™å³å¯ã€‚ ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:3:4","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"é€šè¿‡æ ‡ç­¾é€‰æ‹©æŸ¥çœ‹ pod é€šè¿‡ -l key1=value1,key2=value2 è¿›è¡Œé€‰æ‹©ï¼Œå¦‚ kubectl -n monitoring get po -l app=prometheus kubectl -n monitoring get po -l app=prometheus,prometheus=k8s ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:3:5","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"æŸ¥çœ‹æŸä¸ªnode ä¸Šéƒ¨ç½²çš„æ‰€æœ‰ pod #å…ˆè·å–é›†ç¾¤å†…æ‰€æœ‰çš„node kubectl get node -o wide # å‡è®¾å…¶ä¸­ä¸€ä¸ª node çš„åç§°ä¸º node-0001 kubectl get po -A -o wide | grep node-0001 é€šè¿‡ kubectl get po -A -o wide | grep å¯ä»¥åšå¾ˆå¤šäº‹æƒ…ï¼Œå…·ä½“å¯ä»¥æ ¹æ®æƒ…å†µè€Œå®šï¼Œæ¯”å¦‚æŸ¥çœ‹æ‰€æœ‰çŠ¶æ€å¼‚å¸¸çš„ pod ï¼ˆé Runningï¼‰ kubectl get po -A -o wide | grep -v Running ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:3:6","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"æŸ¥çœ‹ pod çš„è¯¦ç»†ä¿¡æ¯ kubectl -n monitoring describe po prometheus-k8s-0 è¿™ä¸ªå‘½ä»¤åœ¨æŸ¥çœ‹ pod çš„åŸºæœ¬ä¿¡æ¯å’Œé—®é¢˜å®šä½æ—¶ç‰¹åˆ«æœ‰ç”¨ï¼Œå½“ pod å¼‚å¸¸ï¼Œå¯ä»¥æŸ¥çœ‹ Events æˆ–è®¸å°±èƒ½å‘ç°é—®é¢˜æ‰€åœ¨ã€‚ ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:3:7","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"æŸ¥çœ‹ pod log kubectl -n $namespace logs -f $podName $containerName # å…¶ä¸­ $namespaceï¼Œ$podNameï¼Œ$containerName æ›¿æ¢æˆçœŸå®å€¼å³å¯ï¼Œå½“ pod ä¸­åªæœ‰ä¸€ä¸ª å®¹å™¨æ—¶å¯çœç•¥ $containerNameï¼Œå¦‚ï¼š kubectl -n monitoring logs -f prometheus-k8s-0 prometheus ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:3:8","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"è¿›å…¥å®¹å™¨ kubectl -n $namespace exec -it $podName -c $containerName sh # å…¶ä¸­ $namespaceï¼Œ$podNameï¼Œ$containerName æ›¿æ¢æˆçœŸå®å€¼å³å¯ï¼Œå½“ pod ä¸­åªæœ‰ä¸€ä¸ª å®¹å™¨æ—¶å¯çœç•¥ -c $containerNameï¼Œå¦‚ï¼š kubectl -n monitoring exec -it prometheus-k8s-0 -c prometheus sh ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:3:9","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"æŸ¥çœ‹ pod çš„èµ„æºä½¿ç”¨æƒ…å†µ kubectl -n $namespace top pod # å…¶ä¸­ $namespace æ›¿æ¢æˆçœŸå®å€¼å³å¯ï¼Œå¦‚ï¼š kubectl -n monitoring top pod ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:3:10","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"åˆ é™¤ pod kubectl -n $namespace delete po $podName kubectl -n monitoring delete po prometheus-k8s-0 # åœ¨æŸäº›å¼‚å¸¸æƒ…å†µä¸‹åˆ é™¤ pod ä¼šå¡ä½ï¼Œåˆ ä¸æ‰ï¼Œéœ€è¦å¼ºåˆ¶æ‰èƒ½åˆ é™¤ ï¼Œå¼ºåˆ¶åˆ é™¤éœ€è¦å¢åŠ  --grace-period=0 --force ï¼Œ kubectl -n monitoring delete po prometheus-k8s-0 --grace-period=0 --force åŸç†å¦‚ä¸‹ï¼Œ é»˜è®¤æ‰§è¡Œ delete po æ—¶ï¼Œkubectl ä¼šå¢åŠ â€“grace-period=30 å‚æ•°ï¼Œè¡¨ç¤ºé¢„ç•™30ç§’çš„æ—¶é—´ç»™ pod å¤„ç†å½“å‰çš„è¯·æ±‚ï¼Œ ä½†åŒæ—¶ä¹Ÿä¸æ¥æ”¶æ–°çš„è¯·æ±‚äº†ï¼Œä»¥ä¸€ç§ç›¸å¯¹ä¼˜é›…çš„æ–¹å¼åœæ­¢å®¹å™¨ï¼Œæ³¨æ„è¿™ä¸ªå‚æ•°åœ¨åˆ›å»º pod æ—¶å¯ä»¥æŒ‡å®šï¼Œé»˜è®¤æ˜¯30ç§’ã€‚å¼ºåˆ¶åˆ é™¤æ—¶éœ€è¦æŠŠâ€“grace-period è®¾ç½®ä¸º0ï¼Œè¡¨ç¤ºä¸ç­‰å¾…é©¬ä¸Šåˆ é™¤ï¼Œå¦åˆ™å¼ºåˆ¶åˆ é™¤å°±ä¼šå¤±æ•ˆã€‚ ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:3:11","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"pod æ ‡ç­¾ç®¡ç† pod çš„å¤§å¤šæ•°çš„æƒ…å†µéƒ½ä¼šç”± deployment or statefulset æ¥ç®¡ç†ï¼Œæ‰€ä»¥æ ‡ç­¾ä¹Ÿä¼šé€šè¿‡å®ƒä»¬ç®¡ç†ï¼Œå®é™…æƒ…å†µä¸‹å¾ˆå°‘ä¼šé€šè¿‡ kubectl å¯¹ pod label åšå¢åˆ æ”¹ï¼Œå¦‚æœ‰éœ€è¦å¯å‚è€ƒ ä¸‹é¢ node çš„ç”¨æ³•ï¼Œåªéœ€è¦æŠŠèµ„æºå¯¹è±¡æ¢æˆ pod å³å¯ã€‚ ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:3:12","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"æ–‡ä»¶ copy ä» pod ä¸­ copy æ–‡ä»¶æˆ–è€… copy åˆ° pod ä¸­å»ã€‚ å®¹å™¨ä¸­éœ€è¦æœ‰ tar å‘½ä»¤ï¼Œå¦åˆ™ä¼šå¤±è´¥ # ä»æœ¬åœ° copy åˆ° pod kubectl cp /tmp/foo_dir \u003csome-pod\u003e:/tmp/bar_dir kubectl -n monitoring cp abc.txt prometheus-k8s-0:/tmp/abc.txt # å¦‚æœ pod ä¸­æœ‰å¤šä¸ª container å¯ä»¥ç”¨ -c æŒ‡å®š container kubectl cp /tmp/foo \u003csome-pod\u003e:/tmp/bar -c \u003cspecific-container\u003e kubectl -n monitoring cp abc.txt prometheus-k8s-0:/tmp/abc.txt -c prometheus # ä» pod copy åˆ° æœ¬åœ° kubectl cp \u003csome-pod\u003e:/tmp/foo /tmp/bar kubectl -n monitoring cp prometheus-k8s-0:/tmp/abc.txt /tmp/abd.txt ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:3:13","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"node åœ¨ pod ä¸€èŠ‚ å·²ç»äº†è§£äº† kubectl get ,kubectl describe , ç­‰ç›¸å…³çš„ç”¨æ³•ï¼Œnode çš„æ“ä½œå’Œ pod ç±»ä¼¼ï¼Œåªæ˜¯åé¢æ¥çš„èµ„æºå¯¹è±¡ä¸åŒã€‚ ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:4:0","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"æŸ¥çœ‹æœ‰å“ªäº›nodeä»¥åŠå…¶åŸºæœ¬ä¿¡æ¯ kubectl get node -o wide ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:4:1","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"æŸ¥çœ‹ node ä¸Šçš„è¯¦ç»†æƒ…å†µ # æŸ¥çœ‹æ‰€æœ‰ node çš„è¯¦ç»†ä¿¡æ¯ kubectl describe node # ä¹Ÿå¯ä»¥æŸ¥çœ‹æŸä¸ª node çš„ä¿¡æ¯ kubectl describe node node-0001 ... è¿™ä¸ªå‘½ä»¤åœ¨å®šä½ node çš„é—®é¢˜å¾ˆæœ‰ç”¨ï¼Œä¼šè¾“å‡ºå¦‚ä¸‹ä¿¡æ¯: Labels Annotations Non-terminated Pods (æ­£åœ¨è¿è¡Œçš„ pod) Allocated resources (å·²ç»åˆ†é…çš„èµ„æº) â€¦ ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:4:2","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"æŸ¥çœ‹ node çš„èµ„æºä½¿ç”¨æƒ…å†µ kubectl top node ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:4:3","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"node çš„æ ‡ç­¾ç®¡ç† å¢åŠ æ ‡ç­¾ kubectl label node $nodename key1=value1 key2=value2 # å¦‚ kubectl label node node-0001 a1=bbb a2=ccc æ›´æ–°æ ‡ç­¾ # åœ¨ å¢åŠ æ ‡ç­¾çš„åŸºç¡€ åŠ  --overwrite å‚æ•° kubectl label node node-0001 a1=bbb --overwrite # å½“æ ‡ç­¾ä¸å­˜åœ¨ä¹Ÿå¯ä»¥ åŠ  --overwrite å‚æ•° kubectl label node node-0001 a10=bbb --overwrite åˆ é™¤æ ‡ç­¾ kubectl label node $nodename key1- key2- kubectl label node node-0001 a10- a3- ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:4:4","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"å°†ä¸€ä¸ª node æ ‡è®°ä¸ºä¸å¯è°ƒåº¦/å¯è°ƒåº¦ åœ¨è°ƒè¯•è¿‡ç¨‹ä¸­æˆ–è€…å½“å…¶ä¸­çš„æŸäº› node å‡ºç°é—®é¢˜æ—¶ï¼Œéœ€è¦å°† node æ ‡è®°ä¸ºä¸å¯è°ƒåº¦ï¼Œç­‰æ¢å¤å›æ¥å†æ ‡è®°å›æ¥ã€‚ # å°†ä¸€ä¸ª node å¯ä»¥ æ ‡è®°ä¸ºä¸å¯è°ƒåº¦(unschedulable) ï¼Œå¦‚æœåªæ˜¯çœ‹çœ‹æ•ˆæœï¼Œè€Œä¸æ˜¯çœŸæ­£æ ‡è®°å¯åŠ  --dry-run å‚æ•° kubectl cordon $nodeName kubectl cordon node-0001 kubectl cordon node-0001 --dry-run # å°†ä¸€ä¸ª node å¯ä»¥ æ ‡è®°ä¸ºå¯è°ƒåº¦(schedulable) ï¼Œå¦‚æœåªæ˜¯çœ‹çœ‹æ•ˆæœï¼Œè€Œä¸æ˜¯çœŸæ­£æ ‡è®°å¯åŠ  --dry-run å‚æ•° kubectl uncordon $nodeName kubectl uncordon node-0001 kubectl uncordon node-0001 --dry-run ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:4:5","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"æ’ç©º node ä¸Šçš„ pod # æ’ç©ºnode ä¸Šçš„æ‰€æœ‰ pod ï¼Œå³ä½¿æ²¡æœ‰è¢« rc ç®¡ç†ï¼Œä½†æ˜¯ä¸ä¼šæ’ç©º è¢« daemonset ç®¡ç†çš„ podï¼Œ å› ä¸ºæ’ç©ºä¹‹ååˆä¼šé©¬ä¸Šåˆ›å»ºå‡ºæ¥ kubectl drain foo --force ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:4:6","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"node ä¸Šçš„æ±¡ç‚¹ï¼ˆtaintï¼‰ç®¡ç† æ±¡ç‚¹éœ€è¦é…åˆ pod çš„äº²å’Œæ€§ä½¿ç”¨ï¼Œå¦åˆ™æ±¡ç‚¹æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰ # å¢åŠ /æ›´æ–° taint kubectl taint nodes node-0001 dedicated=special-user:NoSchedule --overwrite # åˆ é™¤ taint kubectl taint nodes foo dedicated:NoSchedule- kubectl taint nodes foo dedicated- æ•´ä½“ç”¨æ³•å’Œ label ç±»ä¼¼ ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:4:7","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"node çš„ annotate ç®¡ç† å’Œ label æ˜¯ç±»ä¼¼çš„ï¼Œåªæ˜¯æŠŠ verb æ¢æˆ annotate å³å¯ ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:4:8","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"å…¶ä»–åœºæ™¯ ä¸Šé¢é€šè¿‡ pod å’Œ node çš„ä¾‹å­ï¼Œç©¿æ’çš„ä»‹ç»äº†å¤§éƒ¨åˆ†çš„ verbï¼ˆå¦‚ get ã€describeã€top â€¦ ï¼‰ï¼Œè¿™ä¸ªå°èŠ‚å†ä»‹ç»å…¶ä»–çš„ä¸€äº›å¸¸ç”¨åœºæ™¯ ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:5:0","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"apply åœ¨å‡†å¤‡å¥½ä¸€ä¸ªèµ„æºå¯¹è±¡çš„ yaml æ–‡ä»¶æ—¶å¯ä»¥ç”¨ kubectl apply -f xxx.ymal ä½¿ä¹‹ç”Ÿæ•ˆï¼Œkubernetes çš„api ä¸­å¹¶æ²¡æœ‰ applyï¼Œapi ä¸­æœ‰çš„æ˜¯ create ã€updateã€patch ç­‰ï¼Œapply æ˜¯kubectl è‡ªå·±å°è£…å®ç°çš„ï¼Œå…ˆæ‰§è¡Œ get ï¼Œå†åˆ¤æ–­æ˜¯ create è¿˜æ˜¯ patchï¼Œæ‰€ä»¥ç”¨kubectl åˆ›å»ºæˆ–è€…æ›´æ–°èµ„æºæ—¶ éƒ½å¯ä»¥ç”¨ apply å‘½ä»¤ã€‚ # åˆ›å»ºèµ„æº kubectl apply -f xxx.ymal kubectl create -f xxx.ymal # æ›´æ–°èµ„æº kubectl apply -f xxx.ymal kubectl update -f xxx.ymal kubectl patch -f xxx.ymal ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:5:1","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"æ»šåŠ¨æ›´æ–° æƒ³è±¡è¿™ä¹ˆä¸€ä¸ªåœºæ™¯ï¼Œå¦‚æœä½¿ç”¨ configmap æˆ–è€… secret å½“ä½œ pod çš„ç¯å¢ƒå˜é‡ï¼Œé‚£ä¹ˆå½“ configmap æˆ–è€… secret æ›´æ–°äº†åº”è¯¥å¦‚ä½•æ›´æ–° å¯¹åº”çš„pod å‘¢ï¼Ÿ pod åº”è¯¥éƒ½ä¼šé€šè¿‡ deployment æˆ–è€… statefulset æ¥ç¯å¢ƒï¼Œ æ¢è¨€ä¹‹è¯¥å¦‚ä½•æ›´æ–° deployment æˆ–è€… statefulset å‘¢ï¼Ÿé»˜è®¤æƒ…å†µä¸‹ configmap æˆ–è€… secret çš„æ›´æ–°æ˜¯ä¸ä¼šè§¦å‘ deployment æˆ–è€… statefulset çš„æ›´æ–°ï¼Œä¸€ç§å¯è¡Œçš„æ–¹æ³•ä¸º: æ›´æ–° annotations ä¸­ä¸€ä¸ªæ— å…³çš„å­—æ®µ: kubectl -n $namespace patch deployment $deploymentName -p \\ \"{\\\"spec\\\":{\\\"template\\\":{\\\"metadata\\\":{\\\"annotations\\\":{\\\"test_date\\\":\\\"`date +'%s'`\\\"}}}}}\" kubectl -n monitor patch deployment prometheus -p \\ \"{\\\"spec\\\":{\\\"template\\\":{\\\"metadata\\\":{\\\"annotations\\\":{\\\"test_date\\\":\\\"`date +'%s'`\\\"}}}}}\" ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:5:2","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"æ€»ç»“ è¿™ç¯‡æ–‡ç« ä»‹ç»äº† kubectl çš„åŸºæœ¬ç”¨æ³•ï¼Œå¸¸è§åœºæ™¯ä¸­çš„ä¸€äº›æ“ä½œï¼Œå¦‚æœæœ‰å…¶ä»–åœºæ™¯å¯ä»¥é€šè¿‡ kubectl --help å’Œ kubectl command --help æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£ã€‚ å¦‚æœ‰ä¸æ­£ç¡®ä¹‹å¤„æ¬¢è¿æŒ‡æ­£ã€‚ ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:6:0","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"å‚è€ƒ https://kubernetes.io/zh/docs/reference/kubectl/cheatsheet/ https://mp.weixin.qq.com/s/OxYbLmTKXn5jrgStIQ6ohQ ","date":"2020-11-20","objectID":"/kubernetes/kubectl-command/:7:0","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubernetes/kubectl-command/"},{"categories":null,"content":"kubectl å¸¸ç”¨å‘½ä»¤æŒ‡å—","date":"2020-11-20","objectID":"/kubectl-command/","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"å¯¼è¯» kubectl åº”è¯¥æ˜¯æ¯ä¸ªæ¥è§¦ kubernetes çš„äººéƒ½ä¼šæ¥è§¦çš„ä¸€ä¸ªç»„ä»¶ï¼Œå®ƒå¸¦ç»™æˆ‘ä»¬å¼ºå¤§çš„å‘½ä»¤è¡Œä½“éªŒï¼Œæœ¬ç¯‡æ–‡ç« å°±æ˜¯ä»‹ç» kubectl ä¸­çš„ä¸€äº›å¸¸ç”¨å‘½ä»¤ï¼Œåœ¨ç»“åˆä¸€äº›å…·ä½“çš„ä½¿ç”¨åœºæ™¯è¯´è¯´å¦‚ä½•åˆ©ç”¨ kubectl å®ç°ã€‚å¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ï¼Œåœ¨è¿™é‡Œå°½å¯èƒ½å…¨çš„ç½—åˆ—ï¼Œæ–¹ä¾¿åç»­ ç”¨çš„æ—¶å€™æŸ¥æ‰¾ã€‚å¦‚æœèƒ½å¸®åˆ°æ‚¨å°±æ”¶è—èµ·æ¥å§(ğŸ˜„)ã€‚ æœ¬æ¬¡å®éªŒç¯å¢ƒæ˜¯ kubernetes-1.16.9ï¼Œæœ¬ç¯‡æ–‡æ¡£çš„å†™ä½œæ€è·¯æ˜¯æŒ‰ç…§å¹³æ—¶ çš„ä½¿ç”¨åœºæ™¯è¿›è¡Œå†™ä½œï¼Œä¸ä¼šè¯¦ç»†ä»‹ç» kubectl çš„å‘½ä»¤ï¼Œkubectl è¯¦ç»†çš„å¸®åŠ©æ–‡æ¡£å‚è€ƒ kubectl --help or kubectl command --help ã€‚ ","date":"2020-11-20","objectID":"/kubectl-command/:1:0","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"kubectl æ”¯æŒçš„å‘½ä»¤ kubectl --help kubectl controls the Kubernetes cluster manager. Find more information at: https://kubernetes.io/docs/reference/kubectl/overview/ Basic Commands (Beginner): create Create a resource from a file or from stdin. expose ä½¿ç”¨ replication controller, service, deployment æˆ–è€… pod å¹¶æš´éœ²å®ƒä½œä¸ºä¸€ä¸ª æ–°çš„ Kubernetes Service run åœ¨é›†ç¾¤ä¸­è¿è¡Œä¸€ä¸ªæŒ‡å®šçš„é•œåƒ set ä¸º objects è®¾ç½®ä¸€ä¸ªæŒ‡å®šçš„ç‰¹å¾ Basic Commands (Intermediate): explain æŸ¥çœ‹èµ„æºçš„æ–‡æ¡£ get æ˜¾ç¤ºä¸€ä¸ªæˆ–æ›´å¤š resources edit åœ¨æœåŠ¡å™¨ä¸Šç¼–è¾‘ä¸€ä¸ªèµ„æº delete Delete resources by filenames, stdin, resources and names, or by resources and label selector Deploy Commands: rollout Manage the rollout of a resource scale ä¸º Deployment, ReplicaSet, Replication Controller æˆ–è€… Job è®¾ç½®ä¸€ä¸ªæ–°çš„å‰¯æœ¬æ•°é‡ autoscale è‡ªåŠ¨è°ƒæ•´ä¸€ä¸ª Deployment, ReplicaSet, æˆ–è€… ReplicationController çš„å‰¯æœ¬æ•°é‡ Cluster Management Commands: certificate ä¿®æ”¹ certificate èµ„æº. cluster-info æ˜¾ç¤ºé›†ç¾¤ä¿¡æ¯ top Display Resource (CPU/Memory/Storage) usage. cordon æ ‡è®° node ä¸º unschedulable uncordon æ ‡è®° node ä¸º schedulable drain Drain node in preparation for maintenance taint æ›´æ–°ä¸€ä¸ªæˆ–è€…å¤šä¸ª node ä¸Šçš„ taints Troubleshooting and Debugging Commands: describe æ˜¾ç¤ºä¸€ä¸ªæŒ‡å®š resource æˆ–è€… group çš„ resources è¯¦æƒ… logs è¾“å‡ºå®¹å™¨åœ¨ pod ä¸­çš„æ—¥å¿— attach Attach åˆ°ä¸€ä¸ªè¿è¡Œä¸­çš„ container exec åœ¨ä¸€ä¸ª container ä¸­æ‰§è¡Œä¸€ä¸ªå‘½ä»¤ port-forward Forward one or more local ports to a pod proxy è¿è¡Œä¸€ä¸ª proxy åˆ° Kubernetes API server cp å¤åˆ¶ files å’Œ directories åˆ° containers å’Œä»å®¹å™¨ä¸­å¤åˆ¶ files å’Œ directories. auth Inspect authorization Advanced Commands: diff Diff live version against would-be applied version apply é€šè¿‡æ–‡ä»¶åæˆ–æ ‡å‡†è¾“å…¥æµ(stdin)å¯¹èµ„æºè¿›è¡Œé…ç½® patch ä½¿ç”¨ strategic merge patch æ›´æ–°ä¸€ä¸ªèµ„æºçš„ field(s) replace é€šè¿‡ filename æˆ–è€… stdinæ›¿æ¢ä¸€ä¸ªèµ„æº wait Experimental: Wait for a specific condition on one or many resources. convert åœ¨ä¸åŒçš„ API versions è½¬æ¢é…ç½®æ–‡ä»¶ kustomize Build a kustomization target from a directory or a remote url. Settings Commands: label æ›´æ–°åœ¨è¿™ä¸ªèµ„æºä¸Šçš„ labels annotate æ›´æ–°ä¸€ä¸ªèµ„æºçš„æ³¨è§£ completion Output shell completion code for the specified shell (bash or zsh) Other Commands: api-resources Print the supported API resources on the server api-versions Print the supported API versions on the server, in the form of \"group/version\" config ä¿®æ”¹ kubeconfig æ–‡ä»¶ plugin Provides utilities for interacting with plugins. version è¾“å‡º client å’Œ server çš„ç‰ˆæœ¬ä¿¡æ¯ Usage: kubectl [flags] [options] Use \"kubectl \u003ccommand\u003e --help\" for more information about a given command. Use \"kubectl options\" for a list of global command-line options (applies to all commands). ä»ä¸Šé¢çš„å¸®åŠ©æ–‡æ¡£å¯ä»¥çœ‹å‡ºï¼Œ kubectl åŸºæœ¬æ ¼å¼ä¸º kubectl verb resource options , kubectl åè·Ÿè°“è¯­åŠ¨è¯ï¼Œ å†è·Ÿè¦æ“ä½œçš„èµ„æºï¼Œå¯ä»¥åŠ  options ï¼Œå¦‚ï¼š è¦çœ‹ monitoring namespace ä¸‹é¢æœ‰å“ªäº›pod : kubectl -n monitoring get po ","date":"2020-11-20","objectID":"/kubectl-command/:2:0","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"pod pod åœºæ™¯ä¸‹ï¼Œå¯èƒ½ä¼šæœ‰å¦‚ä¸‹éœ€æ±‚: ","date":"2020-11-20","objectID":"/kubectl-command/:3:0","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"æŸ¥çœ‹æŸä¸ª namespace ä¸‹ï¼Œæ‰€æœ‰çš„pod # å…ˆæŸ¥çœ‹æœ‰å“ªäº›namespace kubectl get namespace # æŸ¥çœ‹ pod kubectl -n $namespace get po # æˆ–è€… kubectl get po -n $namespace ä¸Šé¢ä¸¤ç§å†™æ³•åœ¨è¾¾åˆ°çš„æ•ˆæœä¸Šæ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªç»†èŠ‚å¯ä»¥æ³¨æ„ä¸€ä¸‹ï¼Œå¦‚æœ kubectl ç¯å¢ƒæœ‰å‘½ä»¤è‡ªåŠ¨è¡¥å…¨çš„è¯ï¼Œèµ„æºå¯¹è±¡åˆæ¯”è¾ƒå¤š çš„æƒ…å†µä¸‹ï¼Œç¬¬ä¸€ç§å†™æ³•å°†ä¼šæœ‰æå¤§çš„ä¼˜åŠ¿ï¼Œå¯ä»¥æ€è€ƒè¿™ä¹ˆä¸ªåœºæ™¯ï¼Œå¦‚ï¼šè¦æŸ¥çœ‹ monitoring namespace ä¸‹çš„æŸä¸ªpod è¯¦æƒ…, å°±å¯ä»¥é€šè¿‡: kubectl -n monitoring get po åŠ  tab é”®ï¼Œåˆ—å‡ºè¿™ä¸ªnamespace ä¸‹çš„æ‰€æœ‰ pod ä¾›ç­›é€‰ã€‚ centos ä¸‹å‘½ä»¤è‡ªåŠ¨è¡¥å…¨éœ€è¦å®‰è£… bash-completion ï¼Œæ–¹æ³•ä¸º yum install -y bash-completion å¦‚æœä¸åŠ  -n $namespace ï¼Œåˆ™é»˜è®¤æ˜¯ default namespace ","date":"2020-11-20","objectID":"/kubectl-command/:3:1","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"æŸ¥çœ‹æ‰€æœ‰namespace çš„pod kubectl get po --all-namespaces # or kubectl get po -A ","date":"2020-11-20","objectID":"/kubectl-command/:3:2","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"æŸ¥çœ‹æŸä¸ªå…·ä½“çš„ pod ä¿¡æ¯ ï¼Œä»¥ wideã€jsonã€yaml çš„æ ¼å¼è¾“å‡º kubectl -n $namespace get po xxx -o wide/json/yaml # å¦‚ æŸ¥çœ‹ monitoring ä¸‹çš„ prometheus-0 pod ä¿¡æ¯ï¼Œå¹¶ä»¥yaml å½¢å¼è¾“å‡ºã€‚ kubectl -n monitoring get po prometheus-0 -o yaml ","date":"2020-11-20","objectID":"/kubectl-command/:3:3","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"æŸ¥çœ‹æŸä¸ª pod çš„æŸä¸ªå­—æ®µä¿¡æ¯ å¦‚æœæˆ‘ä»¬åªæƒ³çŸ¥é“ pod çš„ hostIP æˆ–è€…å…¶ä»–çš„ ä¸€äº›å­—æ®µï¼Œ å¯ä»¥é€šè¿‡ -o jsonpath or -o template or -o go-template å…¶ä¸­template è¯­æ³•éµå¾ª golang template éœ€è¦å¯¹ pod çš„å¯¹è±¡æ¨¡å‹æœ‰ä¸€å®šçš„äº†è§£ï¼Œå¦‚æœä¸äº†è§£ï¼Œå¯ä»¥ -o yaml or -o json ç›´æ¥æŸ¥çœ‹ã€‚ æŸ¥çœ‹ hostIP çš„æ–¹æ³•å¦‚ä¸‹: # -o jsonpath kubectl -n monitoring get po prometheus-k8s-0 -o jsonpath=\"{.status.hostIP}\" # -o template kubectl -n monitoring get po prometheus-k8s-0 -o template --template=\"{{.status.hostIP}}\" # -o go-template kubectl -n monitoring get po prometheus-k8s-0 -o go-template=\"{{.status.hostIP}}\" å¦‚æœéœ€è¦æŸ¥çœ‹å…¶ä»–çš„å­—æ®µç…§çŒ«ç”»è™å³å¯ã€‚ ","date":"2020-11-20","objectID":"/kubectl-command/:3:4","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"é€šè¿‡æ ‡ç­¾é€‰æ‹©æŸ¥çœ‹ pod é€šè¿‡ -l key1=value1,key2=value2 è¿›è¡Œé€‰æ‹©ï¼Œå¦‚ kubectl -n monitoring get po -l app=prometheus kubectl -n monitoring get po -l app=prometheus,prometheus=k8s ","date":"2020-11-20","objectID":"/kubectl-command/:3:5","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"æŸ¥çœ‹æŸä¸ªnode ä¸Šéƒ¨ç½²çš„æ‰€æœ‰ pod #å…ˆè·å–é›†ç¾¤å†…æ‰€æœ‰çš„node kubectl get node -o wide # å‡è®¾å…¶ä¸­ä¸€ä¸ª node çš„åç§°ä¸º node-0001 kubectl get po -A -o wide | grep node-0001 é€šè¿‡ kubectl get po -A -o wide | grep å¯ä»¥åšå¾ˆå¤šäº‹æƒ…ï¼Œå…·ä½“å¯ä»¥æ ¹æ®æƒ…å†µè€Œå®šï¼Œæ¯”å¦‚æŸ¥çœ‹æ‰€æœ‰çŠ¶æ€å¼‚å¸¸çš„ pod ï¼ˆé Runningï¼‰ kubectl get po -A -o wide | grep -v Running ","date":"2020-11-20","objectID":"/kubectl-command/:3:6","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"æŸ¥çœ‹ pod çš„è¯¦ç»†ä¿¡æ¯ kubectl -n monitoring describe po prometheus-k8s-0 è¿™ä¸ªå‘½ä»¤åœ¨æŸ¥çœ‹ pod çš„åŸºæœ¬ä¿¡æ¯å’Œé—®é¢˜å®šä½æ—¶ç‰¹åˆ«æœ‰ç”¨ï¼Œå½“ pod å¼‚å¸¸ï¼Œå¯ä»¥æŸ¥çœ‹ Events æˆ–è®¸å°±èƒ½å‘ç°é—®é¢˜æ‰€åœ¨ã€‚ ","date":"2020-11-20","objectID":"/kubectl-command/:3:7","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"æŸ¥çœ‹ pod log kubectl -n $namespace logs -f $podName $containerName # å…¶ä¸­ $namespaceï¼Œ$podNameï¼Œ$containerName æ›¿æ¢æˆçœŸå®å€¼å³å¯ï¼Œå½“ pod ä¸­åªæœ‰ä¸€ä¸ª å®¹å™¨æ—¶å¯çœç•¥ $containerNameï¼Œå¦‚ï¼š kubectl -n monitoring logs -f prometheus-k8s-0 prometheus ","date":"2020-11-20","objectID":"/kubectl-command/:3:8","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"è¿›å…¥å®¹å™¨ kubectl -n $namespace exec -it $podName -c $containerName sh # å…¶ä¸­ $namespaceï¼Œ$podNameï¼Œ$containerName æ›¿æ¢æˆçœŸå®å€¼å³å¯ï¼Œå½“ pod ä¸­åªæœ‰ä¸€ä¸ª å®¹å™¨æ—¶å¯çœç•¥ -c $containerNameï¼Œå¦‚ï¼š kubectl -n monitoring exec -it prometheus-k8s-0 -c prometheus sh ","date":"2020-11-20","objectID":"/kubectl-command/:3:9","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"æŸ¥çœ‹ pod çš„èµ„æºä½¿ç”¨æƒ…å†µ kubectl -n $namespace top pod # å…¶ä¸­ $namespace æ›¿æ¢æˆçœŸå®å€¼å³å¯ï¼Œå¦‚ï¼š kubectl -n monitoring top pod ","date":"2020-11-20","objectID":"/kubectl-command/:3:10","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"åˆ é™¤ pod kubectl -n $namespace delete po $podName kubectl -n monitoring delete po prometheus-k8s-0 # åœ¨æŸäº›å¼‚å¸¸æƒ…å†µä¸‹åˆ é™¤ pod ä¼šå¡ä½ï¼Œåˆ ä¸æ‰ï¼Œéœ€è¦å¼ºåˆ¶æ‰èƒ½åˆ é™¤ ï¼Œå¼ºåˆ¶åˆ é™¤éœ€è¦å¢åŠ  --grace-period=0 --force ï¼Œ kubectl -n monitoring delete po prometheus-k8s-0 --grace-period=0 --force åŸç†å¦‚ä¸‹ï¼Œ é»˜è®¤æ‰§è¡Œ delete po æ—¶ï¼Œkubectl ä¼šå¢åŠ â€“grace-period=30 å‚æ•°ï¼Œè¡¨ç¤ºé¢„ç•™30ç§’çš„æ—¶é—´ç»™ pod å¤„ç†å½“å‰çš„è¯·æ±‚ï¼Œ ä½†åŒæ—¶ä¹Ÿä¸æ¥æ”¶æ–°çš„è¯·æ±‚äº†ï¼Œä»¥ä¸€ç§ç›¸å¯¹ä¼˜é›…çš„æ–¹å¼åœæ­¢å®¹å™¨ï¼Œæ³¨æ„è¿™ä¸ªå‚æ•°åœ¨åˆ›å»º pod æ—¶å¯ä»¥æŒ‡å®šï¼Œé»˜è®¤æ˜¯30ç§’ã€‚å¼ºåˆ¶åˆ é™¤æ—¶éœ€è¦æŠŠâ€“grace-period è®¾ç½®ä¸º0ï¼Œè¡¨ç¤ºä¸ç­‰å¾…é©¬ä¸Šåˆ é™¤ï¼Œå¦åˆ™å¼ºåˆ¶åˆ é™¤å°±ä¼šå¤±æ•ˆã€‚ ","date":"2020-11-20","objectID":"/kubectl-command/:3:11","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"pod æ ‡ç­¾ç®¡ç† pod çš„å¤§å¤šæ•°çš„æƒ…å†µéƒ½ä¼šç”± deployment or statefulset æ¥ç®¡ç†ï¼Œæ‰€ä»¥æ ‡ç­¾ä¹Ÿä¼šé€šè¿‡å®ƒä»¬ç®¡ç†ï¼Œå®é™…æƒ…å†µä¸‹å¾ˆå°‘ä¼šé€šè¿‡ kubectl å¯¹ pod label åšå¢åˆ æ”¹ï¼Œå¦‚æœ‰éœ€è¦å¯å‚è€ƒ ä¸‹é¢ node çš„ç”¨æ³•ï¼Œåªéœ€è¦æŠŠèµ„æºå¯¹è±¡æ¢æˆ pod å³å¯ã€‚ ","date":"2020-11-20","objectID":"/kubectl-command/:3:12","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"æ–‡ä»¶ copy ä» pod ä¸­ copy æ–‡ä»¶æˆ–è€… copy åˆ° pod ä¸­å»ã€‚ å®¹å™¨ä¸­éœ€è¦æœ‰ tar å‘½ä»¤ï¼Œå¦åˆ™ä¼šå¤±è´¥ # ä»æœ¬åœ° copy åˆ° pod kubectl cp /tmp/foo_dir \u003csome-pod\u003e:/tmp/bar_dir kubectl -n monitoring cp abc.txt prometheus-k8s-0:/tmp/abc.txt # å¦‚æœ pod ä¸­æœ‰å¤šä¸ª container å¯ä»¥ç”¨ -c æŒ‡å®š container kubectl cp /tmp/foo \u003csome-pod\u003e:/tmp/bar -c \u003cspecific-container\u003e kubectl -n monitoring cp abc.txt prometheus-k8s-0:/tmp/abc.txt -c prometheus # ä» pod copy åˆ° æœ¬åœ° kubectl cp \u003csome-pod\u003e:/tmp/foo /tmp/bar kubectl -n monitoring cp prometheus-k8s-0:/tmp/abc.txt /tmp/abd.txt ","date":"2020-11-20","objectID":"/kubectl-command/:3:13","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"node åœ¨ pod ä¸€èŠ‚ å·²ç»äº†è§£äº† kubectl get ,kubectl describe , ç­‰ç›¸å…³çš„ç”¨æ³•ï¼Œnode çš„æ“ä½œå’Œ pod ç±»ä¼¼ï¼Œåªæ˜¯åé¢æ¥çš„èµ„æºå¯¹è±¡ä¸åŒã€‚ ","date":"2020-11-20","objectID":"/kubectl-command/:4:0","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"æŸ¥çœ‹æœ‰å“ªäº›nodeä»¥åŠå…¶åŸºæœ¬ä¿¡æ¯ kubectl get node -o wide ","date":"2020-11-20","objectID":"/kubectl-command/:4:1","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"æŸ¥çœ‹ node ä¸Šçš„è¯¦ç»†æƒ…å†µ # æŸ¥çœ‹æ‰€æœ‰ node çš„è¯¦ç»†ä¿¡æ¯ kubectl describe node # ä¹Ÿå¯ä»¥æŸ¥çœ‹æŸä¸ª node çš„ä¿¡æ¯ kubectl describe node node-0001 ... è¿™ä¸ªå‘½ä»¤åœ¨å®šä½ node çš„é—®é¢˜å¾ˆæœ‰ç”¨ï¼Œä¼šè¾“å‡ºå¦‚ä¸‹ä¿¡æ¯: Labels Annotations Non-terminated Pods (æ­£åœ¨è¿è¡Œçš„ pod) Allocated resources (å·²ç»åˆ†é…çš„èµ„æº) â€¦ ","date":"2020-11-20","objectID":"/kubectl-command/:4:2","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"æŸ¥çœ‹ node çš„èµ„æºä½¿ç”¨æƒ…å†µ kubectl top node ","date":"2020-11-20","objectID":"/kubectl-command/:4:3","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"node çš„æ ‡ç­¾ç®¡ç† å¢åŠ æ ‡ç­¾ kubectl label node $nodename key1=value1 key2=value2 # å¦‚ kubectl label node node-0001 a1=bbb a2=ccc æ›´æ–°æ ‡ç­¾ # åœ¨ å¢åŠ æ ‡ç­¾çš„åŸºç¡€ åŠ  --overwrite å‚æ•° kubectl label node node-0001 a1=bbb --overwrite # å½“æ ‡ç­¾ä¸å­˜åœ¨ä¹Ÿå¯ä»¥ åŠ  --overwrite å‚æ•° kubectl label node node-0001 a10=bbb --overwrite åˆ é™¤æ ‡ç­¾ kubectl label node $nodename key1- key2- kubectl label node node-0001 a10- a3- ","date":"2020-11-20","objectID":"/kubectl-command/:4:4","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"å°†ä¸€ä¸ª node æ ‡è®°ä¸ºä¸å¯è°ƒåº¦/å¯è°ƒåº¦ åœ¨è°ƒè¯•è¿‡ç¨‹ä¸­æˆ–è€…å½“å…¶ä¸­çš„æŸäº› node å‡ºç°é—®é¢˜æ—¶ï¼Œéœ€è¦å°† node æ ‡è®°ä¸ºä¸å¯è°ƒåº¦ï¼Œç­‰æ¢å¤å›æ¥å†æ ‡è®°å›æ¥ã€‚ # å°†ä¸€ä¸ª node å¯ä»¥ æ ‡è®°ä¸ºä¸å¯è°ƒåº¦(unschedulable) ï¼Œå¦‚æœåªæ˜¯çœ‹çœ‹æ•ˆæœï¼Œè€Œä¸æ˜¯çœŸæ­£æ ‡è®°å¯åŠ  --dry-run å‚æ•° kubectl cordon $nodeName kubectl cordon node-0001 kubectl cordon node-0001 --dry-run # å°†ä¸€ä¸ª node å¯ä»¥ æ ‡è®°ä¸ºå¯è°ƒåº¦(schedulable) ï¼Œå¦‚æœåªæ˜¯çœ‹çœ‹æ•ˆæœï¼Œè€Œä¸æ˜¯çœŸæ­£æ ‡è®°å¯åŠ  --dry-run å‚æ•° kubectl uncordon $nodeName kubectl uncordon node-0001 kubectl uncordon node-0001 --dry-run ","date":"2020-11-20","objectID":"/kubectl-command/:4:5","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"æ’ç©º node ä¸Šçš„ pod # æ’ç©ºnode ä¸Šçš„æ‰€æœ‰ pod ï¼Œå³ä½¿æ²¡æœ‰è¢« rc ç®¡ç†ï¼Œä½†æ˜¯ä¸ä¼šæ’ç©º è¢« daemonset ç®¡ç†çš„ podï¼Œ å› ä¸ºæ’ç©ºä¹‹ååˆä¼šé©¬ä¸Šåˆ›å»ºå‡ºæ¥ kubectl drain foo --force ","date":"2020-11-20","objectID":"/kubectl-command/:4:6","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"node ä¸Šçš„æ±¡ç‚¹ï¼ˆtaintï¼‰ç®¡ç† æ±¡ç‚¹éœ€è¦é…åˆ pod çš„äº²å’Œæ€§ä½¿ç”¨ï¼Œå¦åˆ™æ±¡ç‚¹æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰ # å¢åŠ /æ›´æ–° taint kubectl taint nodes node-0001 dedicated=special-user:NoSchedule --overwrite # åˆ é™¤ taint kubectl taint nodes foo dedicated:NoSchedule- kubectl taint nodes foo dedicated- æ•´ä½“ç”¨æ³•å’Œ label ç±»ä¼¼ ","date":"2020-11-20","objectID":"/kubectl-command/:4:7","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"node çš„ annotate ç®¡ç† å’Œ label æ˜¯ç±»ä¼¼çš„ï¼Œåªæ˜¯æŠŠ verb æ¢æˆ annotate å³å¯ ","date":"2020-11-20","objectID":"/kubectl-command/:4:8","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"å…¶ä»–åœºæ™¯ ä¸Šé¢é€šè¿‡ pod å’Œ node çš„ä¾‹å­ï¼Œç©¿æ’çš„ä»‹ç»äº†å¤§éƒ¨åˆ†çš„ verbï¼ˆå¦‚ get ã€describeã€top â€¦ ï¼‰ï¼Œè¿™ä¸ªå°èŠ‚å†ä»‹ç»å…¶ä»–çš„ä¸€äº›å¸¸ç”¨åœºæ™¯ ","date":"2020-11-20","objectID":"/kubectl-command/:5:0","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"apply åœ¨å‡†å¤‡å¥½ä¸€ä¸ªèµ„æºå¯¹è±¡çš„ yaml æ–‡ä»¶æ—¶å¯ä»¥ç”¨ kubectl apply -f xxx.ymal ä½¿ä¹‹ç”Ÿæ•ˆï¼Œkubernetes çš„api ä¸­å¹¶æ²¡æœ‰ applyï¼Œapi ä¸­æœ‰çš„æ˜¯ create ã€updateã€patch ç­‰ï¼Œapply æ˜¯kubectl è‡ªå·±å°è£…å®ç°çš„ï¼Œå…ˆæ‰§è¡Œ get ï¼Œå†åˆ¤æ–­æ˜¯ create è¿˜æ˜¯ patchï¼Œæ‰€ä»¥ç”¨kubectl åˆ›å»ºæˆ–è€…æ›´æ–°èµ„æºæ—¶ éƒ½å¯ä»¥ç”¨ apply å‘½ä»¤ã€‚ # åˆ›å»ºèµ„æº kubectl apply -f xxx.ymal kubectl create -f xxx.ymal # æ›´æ–°èµ„æº kubectl apply -f xxx.ymal kubectl update -f xxx.ymal kubectl patch -f xxx.ymal ","date":"2020-11-20","objectID":"/kubectl-command/:5:1","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"æ»šåŠ¨æ›´æ–° æƒ³è±¡è¿™ä¹ˆä¸€ä¸ªåœºæ™¯ï¼Œå¦‚æœä½¿ç”¨ configmap æˆ–è€… secret å½“ä½œ pod çš„ç¯å¢ƒå˜é‡ï¼Œé‚£ä¹ˆå½“ configmap æˆ–è€… secret æ›´æ–°äº†åº”è¯¥å¦‚ä½•æ›´æ–° å¯¹åº”çš„pod å‘¢ï¼Ÿ pod åº”è¯¥éƒ½ä¼šé€šè¿‡ deployment æˆ–è€… statefulset æ¥ç¯å¢ƒï¼Œ æ¢è¨€ä¹‹è¯¥å¦‚ä½•æ›´æ–° deployment æˆ–è€… statefulset å‘¢ï¼Ÿé»˜è®¤æƒ…å†µä¸‹ configmap æˆ–è€… secret çš„æ›´æ–°æ˜¯ä¸ä¼šè§¦å‘ deployment æˆ–è€… statefulset çš„æ›´æ–°ï¼Œä¸€ç§å¯è¡Œçš„æ–¹æ³•ä¸º: æ›´æ–° annotations ä¸­ä¸€ä¸ªæ— å…³çš„å­—æ®µ: kubectl -n $namespace patch deployment $deploymentName -p \\ \"{\\\"spec\\\":{\\\"template\\\":{\\\"metadata\\\":{\\\"annotations\\\":{\\\"test_date\\\":\\\"`date +'%s'`\\\"}}}}}\" kubectl -n monitor patch deployment prometheus -p \\ \"{\\\"spec\\\":{\\\"template\\\":{\\\"metadata\\\":{\\\"annotations\\\":{\\\"test_date\\\":\\\"`date +'%s'`\\\"}}}}}\" ","date":"2020-11-20","objectID":"/kubectl-command/:5:2","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"æ€»ç»“ è¿™ç¯‡æ–‡ç« ä»‹ç»äº† kubectl çš„åŸºæœ¬ç”¨æ³•ï¼Œå¸¸è§åœºæ™¯ä¸­çš„ä¸€äº›æ“ä½œï¼Œå¦‚æœæœ‰å…¶ä»–åœºæ™¯å¯ä»¥é€šè¿‡ kubectl --help å’Œ kubectl command --help æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£ã€‚ å¦‚æœ‰ä¸æ­£ç¡®ä¹‹å¤„æ¬¢è¿æŒ‡æ­£ã€‚ ","date":"2020-11-20","objectID":"/kubectl-command/:6:0","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"å‚è€ƒ https://kubernetes.io/zh/docs/reference/kubectl/cheatsheet/ https://mp.weixin.qq.com/s/OxYbLmTKXn5jrgStIQ6ohQ ","date":"2020-11-20","objectID":"/kubectl-command/:7:0","tags":["kubernetes","kubectl"],"title":"kubectl å¸¸ç”¨å‘½ä»¤","uri":"/kubectl-command/"},{"categories":null,"content":"markdownä¸­æ’å…¥è¡¨æƒ…çš„æ–¹æ³•","date":"2020-11-19","objectID":"/markdownemoji/","tags":["markdown","emoji"],"title":"markdownä¸­æ’å…¥è¡¨æƒ…çš„æ–¹æ³•","uri":"/markdownemoji/"},{"categories":null,"content":"å¯¼è¯» markdown ä¸­ä¹Ÿæ˜¯å¯ä»¥æ’å…¥è¡¨æƒ…ï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰çš„markdown è§£æå™¨éƒ½æ”¯æŒï¼Œæˆ‘æœ¬åœ°ç”¨çš„ Golandã€MacDown ä¸æ”¯æŒï¼Œä½†æ˜¯ hugo æ˜¯æ”¯æŒçš„ï¼Œ å†™ä½œçš„è¿‡ç¨‹å¯ä»¥é€‚å½“åŠ å…¥ä¸€äº›è¡¨æƒ…ï¼Œå¯ä»¥è¡¨è¾¾å½“æ—¶å†™ä½œçš„ä¸€ä¸ªå¿ƒæƒ…ã€‚ ","date":"2020-11-19","objectID":"/markdownemoji/:1:0","tags":["markdown","emoji"],"title":"markdownä¸­æ’å…¥è¡¨æƒ…çš„æ–¹æ³•","uri":"/markdownemoji/"},{"categories":null,"content":"ä½¿ç”¨åœºæ™¯ markdown ä¸­æ”¯æŒ emoji çš„åœ°æ–¹æœ‰ : Campfire GitHub Basecamp Redbooth Trac Flowdock Sprint.ly Kandan Textbox.io Kippt Redmine JabbR Trello Hall Qiita Zendesk Ruby China Grove Idobata NodeBB Forums Slack Streamup OrganisedMinds Hackpad Cryptbin Kato Reportedly Cheerful Ghost IRCCloud Dashcube MyVideoGameList Subrosa Sococo Quip And Bang Bonusly Discourse Ello Twemoji Awesome Got Chosen Flow ReadMe.io esa DBook Groups.io TeamworkChat Damn Bugs Letâ€™s Chat Buildkite ChatGrape Dokuwiki Usersnap Discord Status Hero Morfy Bitbucket Gitter Yellow YouTube Habitica and Mattermost ","date":"2020-11-19","objectID":"/markdownemoji/:2:0","tags":["markdown","emoji"],"title":"markdownä¸­æ’å…¥è¡¨æƒ…çš„æ–¹æ³•","uri":"/markdownemoji/"},{"categories":null,"content":"ç”¨æ³• emoji çš„è¡¨æƒ…å¤§å…¨å‚è€ƒ : https://www.webfx.com/tools/emoji-cheat-sheet/ å¦‚æœæƒ³è¦åœ¨ markdown ä¸­ä½¿ç”¨ï¼Œåªè¦åœ¨ç›¸åº”çš„åœ°æ–¹æ’å…¥ :xxx: å³å¯ï¼Œ å…¶ä¸­ xxx å°±æ˜¯è¡¨æƒ…çš„åå­— ï¼Œä¾‹: ## æ’å…¥è¡¨æƒ…ç¤ºä¾‹ - ç¬‘ï¼š ğŸ˜„ - å‚»ç¬‘ ğŸ˜ - å®³ç¾ ğŸ˜Š ... :/play secret: ","date":"2020-11-19","objectID":"/markdownemoji/:3:0","tags":["markdown","emoji"],"title":"markdownä¸­æ’å…¥è¡¨æƒ…çš„æ–¹æ³•","uri":"/markdownemoji/"},{"categories":null,"content":"å‚è€ƒ https://www.webfx.com/tools/emoji-cheat-sheet/ ","date":"2020-11-19","objectID":"/markdownemoji/:4:0","tags":["markdown","emoji"],"title":"markdownä¸­æ’å…¥è¡¨æƒ…çš„æ–¹æ³•","uri":"/markdownemoji/"},{"categories":null,"content":"pythonä¸­çš„å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ï¼ˆäºŒï¼‰","date":"2020-11-18","objectID":"/concurrent/","tags":["python","å¤šçº¿ç¨‹","å¤šè¿›ç¨‹"],"title":"pythonä¸­çš„å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ï¼ˆäºŒï¼‰","uri":"/concurrent/"},{"categories":null,"content":"å¯¼è¯» åœ¨ä¸Šä¸€ç¯‡â€œpythonä¸­çš„å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹(ä¸€)ä¸­ä»‹ç»äº†è¿›ç¨‹ã€çº¿ç¨‹çš„æ¦‚å¿µã€åŸºæœ¬ç”¨æ³•å’Œåœ¨ python ä¸­ä½¿ç”¨é‡åˆ°çš„ä¸€äº›å‘ï¼Œ è¿™åœ¨ä¸€ç¯‡ä¸­ä¼šä»‹ç»ä¸€äº›é«˜çº§çš„ç”¨æ³•ï¼Œå½“ç„¶æ›´å¤šçš„æ˜¯é‡åˆ°çš„å‘ï¼Œæ¢è¨€ä¹‹è¿™æ˜¯ä¸€ç‰‡é¿å‘æŒ‡å—ã€‚ ","date":"2020-11-18","objectID":"/concurrent/:1:0","tags":["python","å¤šçº¿ç¨‹","å¤šè¿›ç¨‹"],"title":"pythonä¸­çš„å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ï¼ˆäºŒï¼‰","uri":"/concurrent/"},{"categories":null,"content":"concurrent.futures æˆ‘ä»¬éƒ½çŸ¥é“åœ¨ python ä¸­ï¼Œå¤šçº¿ç¨‹çš„æ ‡å‡†åº“æ˜¯ä½¿ç”¨ threading , å¦‚ ï¼š # -*- coding: UTF-8 -*- import threading import time def runner(index, param) : print(\"çº¿ç¨‹{} å¼€å§‹è¿è¡Œ: ------------\".format(index)) print(\"çº¿ç¨‹{} : {}\".format(index,param)) time.sleep(3) print(\"çº¿ç¨‹{} è¿è¡Œç»“æŸ: ------------\".format(index)) for index,value in enumerate([\"python\", \"java\", \"golang\", \"php\"]) : thread = threading.Thread(target=runner,args=(index, value, )) thread.start() å¤šè¿›ç¨‹çš„åº“æ˜¯ multiprocessing ,å¦‚ï¼š # -*- coding: UTF-8 -*- from multiprocessing import Process import time def runner(index, param) : print(\"çº¿ç¨‹{} å¼€å§‹è¿è¡Œ: ------------\".format(index)) print(\"çº¿ç¨‹{} : {}\".format(index,param)) time.sleep(3) print(\"çº¿ç¨‹{} è¿è¡Œç»“æŸ: ------------\".format(index)) for index,value in enumerate([\"python\", \"java\", \"golang\", \"php\"]) : process = Process(target=runner,args=(index, value, )) process.start() ä»¥ä¸Šä¸¤ä¸ªåº“å·²ç» python2 å·²ç»æ”¯æŒï¼Œå¯ä»¥å¾ˆå¥½çš„å®ç°æˆ‘ä»¬å¤šè¿›ç¨‹ä¸å¤šçº¿ç¨‹çš„éœ€æ±‚ã€‚ python3.2 æä¾›äº† concurrent.futures åº“ï¼Œå¹¶ä¸”å·²ç»å›æº¯åˆ°python2ï¼Œè¿™ä¸ªåº“åœ¨ threading ä¸ multiprocessing çš„åŸºç¡€ä¸Šæä¾›äº†ä¸€å±‚å°è£…ï¼Œä½¿å¾—å¤šçº¿ç¨‹å’Œå¤šè¿›ç¨‹åœ¨ä½¿ç”¨è¡Œä¸ºä¸Šä¿æŒäº†ä¸€è‡´ï¼Œä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Œä¸”çœ‹ä¸‹é¢åˆ†æï¼Œè¯·å…ˆçœ‹ä¸¤æ®µä»£ç ï¼š å¤šçº¿ç¨‹ # -*- coding: UTF-8 -*- from concurrent.futures._base import TimeoutError from concurrent.futures import ThreadPoolExecutor import time def runner(index, param) : print(\"çº¿ç¨‹{} å¼€å§‹è¿è¡Œ: ------------\".format(index)) print(\"çº¿ç¨‹{} : {}\".format(index,param)) time.sleep(3) print(\"çº¿ç¨‹{} è¿è¡Œç»“æŸ: ------------\".format(index)) max_workers = 4 print(\"æ‰§è¡Œå‡çº§ä»»åŠ¡çš„å¹¶å‘æ•°ä¸ºä¸ºï¼š {}\".format(max_workers)) runners = [\"python\", \"java\", \"golang\", \"php\", \"rust\", \"shell\", \"c\"] with ThreadPoolExecutor(max_workers=max_workers) as executor: for index, value in enumerate(runners): result = executor.submit(runner, index, value) try: result.result(timeout=3 * 60 ) except TimeoutError as err: print(\"ä»»åŠ¡è¶…æ—¶,\", err) å¤šè¿›ç¨‹ # -*- coding: UTF-8 -*- from concurrent.futures._base import TimeoutError from concurrent.futures import ProcessPoolExecutor import time def runner(index, param) : print(\"çº¿ç¨‹{} å¼€å§‹è¿è¡Œ: ------------\".format(index)) print(\"çº¿ç¨‹{} : {}\".format(index,param)) time.sleep(3) print(\"çº¿ç¨‹{} è¿è¡Œç»“æŸ: ------------\".format(index)) max_workers = 4 print(\"æ‰§è¡Œå‡çº§ä»»åŠ¡çš„å¹¶å‘æ•°ä¸ºä¸ºï¼š {}\".format(max_workers)) runners = [\"python\", \"java\", \"golang\", \"php\", \"rust\", \"shell\", \"c\"] with ProcessPoolExecutor(max_workers=max_workers) as executor: for index, value in enumerate(runners): result = executor.submit(runner, index, value) try: result.result(timeout=3 * 60 ) except TimeoutError as err: print(\"ä»»åŠ¡è¶…æ—¶,\", err) å¯ä»¥çœ‹åˆ°å¤šè¿›ç¨‹å’Œå¤šçº¿ç¨‹å†™æ³•è¶…çº§ç±»ä¼¼ï¼Œä¸€ä¸ªä½¿ç”¨çš„æ˜¯ ProcessPoolExecutor ï¼Œä¸€ä¸ªä½¿ç”¨çš„æ˜¯ ThreadPoolExecutorï¼Œå…¶ä»–ä»£ç åŸºæœ¬ä¸€ç›´ï¼ŒæŸ¥çœ‹æºç å¯ä»¥å‘ç° concurrent.futures å®šä¹‰äº†ä¸€ä¸ª Executor æŠ½è±¡åŸºç±»ï¼Œæä¾›äº† submit ã€map ã€shutdown ç­‰æ–¹æ³• class Executor(object): \"\"\"This is an abstract base class for concrete asynchronous executors.\"\"\" def submit(self, fn, *args, **kwargs): \"\"\"Submits a callable to be executed with the given arguments. Schedules the callable to be executed as fn(*args, **kwargs) and returns a Future instance representing the execution of the callable. Returns: A Future representing the given call. \"\"\" raise NotImplementedError() def map(self, fn, *iterables, **kwargs): \"\"\"Returns a iterator equivalent to map(fn, iter). Args: fn: A callable that will take as many arguments as there are passed iterables. timeout: The maximum number of seconds to wait. If None, then there is no limit on the wait time. Returns: An iterator equivalent to: map(func, *iterables) but the calls may be evaluated out-of-order. Raises: TimeoutError: If the entire result iterator could not be generated before the given timeout. Exception: If fn(*args) raises for any values. \"\"\" timeout = kwargs.get('timeout') if timeout is not None: end_time = timeout + time.time() fs = [self.submit(fn, *args) for args in itertools.izip(*iterables)] # Yield must be hidden in closure so that the futures are submitted # before the first iterator value is required. def result_iterator(): try: for future in fs: if timeout is None: yield future.result() else: yield future.result(end_time - time.time()) finally: for future in fs: future.cancel() return result_iterator() def shutdown(self, wait=True): \"\"","date":"2020-11-18","objectID":"/concurrent/:2:0","tags":["python","å¤šçº¿ç¨‹","å¤šè¿›ç¨‹"],"title":"pythonä¸­çš„å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ï¼ˆäºŒï¼‰","uri":"/concurrent/"},{"categories":null,"content":"concurrent ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°çš„å‘ æ‰§è¡Œç¯å¢ƒä¸º python-2.7.15 å‡è®¾æœ‰è¿™ä¹ˆä¸€ä¸ªè„šæœ¬ multipy.py # -*- coding: UTF-8 -*- from concurrent.futures._base import TimeoutError from concurrent.futures import ProcessPoolExecutor import time def runner(index, param) : print(\"çº¿ç¨‹{} å¼€å§‹è¿è¡Œ: ------------\".format(index)) print(\"çº¿ç¨‹{} : {}\".format(index,param)) time.sleep(3) print(\"çº¿ç¨‹{} è¿è¡Œç»“æŸ: ------------\".format(index)) def main(max_workers=1) : print(\"æ‰§è¡Œå‡çº§ä»»åŠ¡çš„å¹¶å‘æ•°ä¸ºä¸ºï¼š {}\".format(max_workers)) runners = [\"python\", \"java\", \"golang\", \"php\", \"rust\", \"shell\", \"c\"] with ProcessPoolExecutor(max_workers=max_workers) as executor: for index, value in enumerate(runners): result = executor.submit(runner, index, value) try: result.result(timeout=3 * 60) except TimeoutError as err: print(\"ä»»åŠ¡è¶…æ—¶,\", err) if __name__ == \"__main__\" : main(3) é€šè¿‡åœ¨å‘½ä»¤è¡Œæ‰§è¡Œ python multipy.py ï¼Œå¤§å®¶å¯ä»¥åœ¨å¿ƒé‡Œæƒ³è±¡ä¸€ä¸‹ä¼šè¾“å‡ºä»€ä¹ˆã€‚ ç¬¬äºŒä¸ªåœºæ™¯æ˜¯ï¼šåŒæ ·çš„è„šæœ¬ï¼Œ é€šè¿‡ setuptools å®‰è£…åæ‰§è¡Œï¼Œéƒ¨åˆ†ä»£ç ï¼ˆsetup.pyï¼‰å¦‚ä¸‹: #!/usr/bin/env python from setuptools import setup, find_packages setup( name=\"pyctl\", entry_points=''' [console_scripts] pyctl=pyctl.commands.shell:cli ''', classifiers=[ ... ], install_requires=[ ... 'click==7.0' ], ) å®‰è£…å®Œæˆä¹‹åå¯ä»¥åœ¨å‘½ä»¤è¡Œé€šè¿‡ pyctl xxx ... æ‰§è¡Œï¼Œå’Œæ‰§è¡Œç³»ç»Ÿå‘½ä»¤æ˜¯ä¸€æ ·çš„ï¼Œå¦‚æœä¸ç†Ÿæ‚‰ setuptools å¯ä»¥å…ˆäº†è§£ä¸€ä¸‹ï¼Œæ–‡æ¡£å‚è€ƒhttps://pypi.org/project/setuptools/ è¨€å½’æ­£ä¼ ï¼Œé€šè¿‡ setuptools æ‰“åŒ…ä¹‹åå†æ‰§è¡Œè¿™ä¸ªè„šæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥å‡è®¾æ‰“åŒ…ä¹‹åçš„æ‰§è¡Œæ–¹å¼ä¸º pyctl multipy ï¼Œæ‰§è¡Œåä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿå¤§å®¶ä¹Ÿå¯ä»¥åœ¨å¿ƒé‡Œå…ˆæƒ³è±¡ä¸€ä¸‹ã€‚ å®é™…çš„ç»“æœå°±æ˜¯ç›´æ¥é€šè¿‡ python multipy.py çš„æ–¹å¼å¯ä»¥å¾—åˆ°æ­£ç¡®çš„ç»“æœï¼Œç¡®å®æŒ‰ç…§å¤šè¿›ç¨‹çš„æ–¹å¼å¹¶å‘æ‰§è¡Œï¼Œä½†æ˜¯åˆ°ç¬¬äºŒä¸ªåœºæ™¯æ—¶å´æ— æ³•è¿è¡Œï¼Œé€šè¿‡ ps -ef æŸ¥çœ‹è¿›ç¨‹ï¼Œç¡®å®åˆ›å»ºäº†å¤šä¸ªè¿›ç¨‹ï¼Œä½†è¿™äº›è¿›ç¨‹éƒ½è¢«é˜»å¡ï¼Œæ²¡æœ‰æ‰§è¡Œ runner å‡½æ•°é‡Œé¢çš„å†…å®¹ï¼Œç¨‹åºä¼šè¢«å¡æ­»ã€‚å½“æ—¶ç™¾æ€ä¸è§£å…¶ä¸­çš„åŸå› ï¼Œå°è¯•è¿‡å¾ˆå¤šæ–¹æ³•ï¼ŒåŒ…æ‹¬ä½¿ç”¨åŸç”Ÿçš„ multiprocessing è‡ªå·±å®ç°è¿›ç¨‹ç®¡ç†ä¹Ÿæ˜¯åŒæ ·çš„æ•ˆæœï¼Œæœ€åæ˜¯åŒæ ·çš„ä»£ç ï¼Œæ¢åˆ°python3.8ï¼Œä¸¤ç§æ–¹æ³•éƒ½å¯ä»¥å¾—åˆ°æ­£ç¡®ç»“æœã€‚python2.7 ä¸ºå•¥ä¼šå¡æ­»ï¼Œå¤šä¸ªè¿›ç¨‹åˆ›å»ºå‡ºæ¥æ²¡æœ‰æ‰§è¡Œ runner ä»»åŠ¡è‡³ä»Šè¿˜æ²¡æœ‰æ‰¾åˆ°åŸå› ï¼Œåç»­æœ‰è¿›å±•å†æ›´æ–°ï¼Œ æ¬¢è¿çŸ¥é“åŸå› çš„å°ä¼™ä¼´ç•™è¨€å‘ŠçŸ¥ï¼ï¼ï¼ ","date":"2020-11-18","objectID":"/concurrent/:3:0","tags":["python","å¤šçº¿ç¨‹","å¤šè¿›ç¨‹"],"title":"pythonä¸­çš„å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ï¼ˆäºŒï¼‰","uri":"/concurrent/"},{"categories":null,"content":"æ€»ç»“ åœ¨python2.7çš„ç¯å¢ƒä¸‹é¢ï¼Œå¦‚æœé€šè¿‡ setuptools æ‰“åŒ…å®‰è£…ï¼Œå®‰è£…åå¤šè¿›ç¨‹ä½¿ç”¨ä¼šæœ‰é—®é¢˜ï¼Œç°è±¡æ˜¯ä¼šåˆ›å»ºå¤šä¸ªå­è¿›ç¨‹å‡ºæ¥ï¼Œä½†æ˜¯ä¸»è¿›ç¨‹å’Œå­è¿›ç¨‹éƒ½ä¼šè¢«é˜»å¡è€Œæ— æ³•çœŸæ­£æ‰§è¡Œrunnerä»»åŠ¡ï¼Œä¸€ä¸ªè¡Œä¹‹æœ‰æ•ˆçš„æ–¹æ³•æ˜¯åˆ‡æ¢åˆ°python3ï¼ˆpython3.8äº²æµ‹æ²¡æœ‰é—®é¢˜ï¼Œå…¶ä»–çš„æ²¡æµ‹è¿‡ï¼‰ã€‚ ","date":"2020-11-18","objectID":"/concurrent/:4:0","tags":["python","å¤šçº¿ç¨‹","å¤šè¿›ç¨‹"],"title":"pythonä¸­çš„å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ï¼ˆäºŒï¼‰","uri":"/concurrent/"},{"categories":null,"content":"pythonä¸­çš„å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ï¼ˆäºŒï¼‰","date":"2020-11-18","objectID":"/python/concurrent/","tags":["python","å¤šçº¿ç¨‹","å¤šè¿›ç¨‹"],"title":"pythonä¸­çš„å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ï¼ˆäºŒï¼‰","uri":"/python/concurrent/"},{"categories":null,"content":"å¯¼è¯» åœ¨ä¸Šä¸€ç¯‡â€œpythonä¸­çš„å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹(ä¸€)ä¸­ä»‹ç»äº†è¿›ç¨‹ã€çº¿ç¨‹çš„æ¦‚å¿µã€åŸºæœ¬ç”¨æ³•å’Œåœ¨ python ä¸­ä½¿ç”¨é‡åˆ°çš„ä¸€äº›å‘ï¼Œ è¿™åœ¨ä¸€ç¯‡ä¸­ä¼šä»‹ç»ä¸€äº›é«˜çº§çš„ç”¨æ³•ï¼Œå½“ç„¶æ›´å¤šçš„æ˜¯é‡åˆ°çš„å‘ï¼Œæ¢è¨€ä¹‹è¿™æ˜¯ä¸€ç‰‡é¿å‘æŒ‡å—ã€‚ ","date":"2020-11-18","objectID":"/python/concurrent/:1:0","tags":["python","å¤šçº¿ç¨‹","å¤šè¿›ç¨‹"],"title":"pythonä¸­çš„å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ï¼ˆäºŒï¼‰","uri":"/python/concurrent/"},{"categories":null,"content":"concurrent.futures æˆ‘ä»¬éƒ½çŸ¥é“åœ¨ python ä¸­ï¼Œå¤šçº¿ç¨‹çš„æ ‡å‡†åº“æ˜¯ä½¿ç”¨ threading , å¦‚ ï¼š # -*- coding: UTF-8 -*- import threading import time def runner(index, param) : print(\"çº¿ç¨‹{} å¼€å§‹è¿è¡Œ: ------------\".format(index)) print(\"çº¿ç¨‹{} : {}\".format(index,param)) time.sleep(3) print(\"çº¿ç¨‹{} è¿è¡Œç»“æŸ: ------------\".format(index)) for index,value in enumerate([\"python\", \"java\", \"golang\", \"php\"]) : thread = threading.Thread(target=runner,args=(index, value, )) thread.start() å¤šè¿›ç¨‹çš„åº“æ˜¯ multiprocessing ,å¦‚ï¼š # -*- coding: UTF-8 -*- from multiprocessing import Process import time def runner(index, param) : print(\"çº¿ç¨‹{} å¼€å§‹è¿è¡Œ: ------------\".format(index)) print(\"çº¿ç¨‹{} : {}\".format(index,param)) time.sleep(3) print(\"çº¿ç¨‹{} è¿è¡Œç»“æŸ: ------------\".format(index)) for index,value in enumerate([\"python\", \"java\", \"golang\", \"php\"]) : process = Process(target=runner,args=(index, value, )) process.start() ä»¥ä¸Šä¸¤ä¸ªåº“å·²ç» python2 å·²ç»æ”¯æŒï¼Œå¯ä»¥å¾ˆå¥½çš„å®ç°æˆ‘ä»¬å¤šè¿›ç¨‹ä¸å¤šçº¿ç¨‹çš„éœ€æ±‚ã€‚ python3.2 æä¾›äº† concurrent.futures åº“ï¼Œå¹¶ä¸”å·²ç»å›æº¯åˆ°python2ï¼Œè¿™ä¸ªåº“åœ¨ threading ä¸ multiprocessing çš„åŸºç¡€ä¸Šæä¾›äº†ä¸€å±‚å°è£…ï¼Œä½¿å¾—å¤šçº¿ç¨‹å’Œå¤šè¿›ç¨‹åœ¨ä½¿ç”¨è¡Œä¸ºä¸Šä¿æŒäº†ä¸€è‡´ï¼Œä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Œä¸”çœ‹ä¸‹é¢åˆ†æï¼Œè¯·å…ˆçœ‹ä¸¤æ®µä»£ç ï¼š å¤šçº¿ç¨‹ # -*- coding: UTF-8 -*- from concurrent.futures._base import TimeoutError from concurrent.futures import ThreadPoolExecutor import time def runner(index, param) : print(\"çº¿ç¨‹{} å¼€å§‹è¿è¡Œ: ------------\".format(index)) print(\"çº¿ç¨‹{} : {}\".format(index,param)) time.sleep(3) print(\"çº¿ç¨‹{} è¿è¡Œç»“æŸ: ------------\".format(index)) max_workers = 4 print(\"æ‰§è¡Œå‡çº§ä»»åŠ¡çš„å¹¶å‘æ•°ä¸ºä¸ºï¼š {}\".format(max_workers)) runners = [\"python\", \"java\", \"golang\", \"php\", \"rust\", \"shell\", \"c\"] with ThreadPoolExecutor(max_workers=max_workers) as executor: for index, value in enumerate(runners): result = executor.submit(runner, index, value) try: result.result(timeout=3 * 60 ) except TimeoutError as err: print(\"ä»»åŠ¡è¶…æ—¶,\", err) å¤šè¿›ç¨‹ # -*- coding: UTF-8 -*- from concurrent.futures._base import TimeoutError from concurrent.futures import ProcessPoolExecutor import time def runner(index, param) : print(\"çº¿ç¨‹{} å¼€å§‹è¿è¡Œ: ------------\".format(index)) print(\"çº¿ç¨‹{} : {}\".format(index,param)) time.sleep(3) print(\"çº¿ç¨‹{} è¿è¡Œç»“æŸ: ------------\".format(index)) max_workers = 4 print(\"æ‰§è¡Œå‡çº§ä»»åŠ¡çš„å¹¶å‘æ•°ä¸ºä¸ºï¼š {}\".format(max_workers)) runners = [\"python\", \"java\", \"golang\", \"php\", \"rust\", \"shell\", \"c\"] with ProcessPoolExecutor(max_workers=max_workers) as executor: for index, value in enumerate(runners): result = executor.submit(runner, index, value) try: result.result(timeout=3 * 60 ) except TimeoutError as err: print(\"ä»»åŠ¡è¶…æ—¶,\", err) å¯ä»¥çœ‹åˆ°å¤šè¿›ç¨‹å’Œå¤šçº¿ç¨‹å†™æ³•è¶…çº§ç±»ä¼¼ï¼Œä¸€ä¸ªä½¿ç”¨çš„æ˜¯ ProcessPoolExecutor ï¼Œä¸€ä¸ªä½¿ç”¨çš„æ˜¯ ThreadPoolExecutorï¼Œå…¶ä»–ä»£ç åŸºæœ¬ä¸€ç›´ï¼ŒæŸ¥çœ‹æºç å¯ä»¥å‘ç° concurrent.futures å®šä¹‰äº†ä¸€ä¸ª Executor æŠ½è±¡åŸºç±»ï¼Œæä¾›äº† submit ã€map ã€shutdown ç­‰æ–¹æ³• class Executor(object): \"\"\"This is an abstract base class for concrete asynchronous executors.\"\"\" def submit(self, fn, *args, **kwargs): \"\"\"Submits a callable to be executed with the given arguments. Schedules the callable to be executed as fn(*args, **kwargs) and returns a Future instance representing the execution of the callable. Returns: A Future representing the given call. \"\"\" raise NotImplementedError() def map(self, fn, *iterables, **kwargs): \"\"\"Returns a iterator equivalent to map(fn, iter). Args: fn: A callable that will take as many arguments as there are passed iterables. timeout: The maximum number of seconds to wait. If None, then there is no limit on the wait time. Returns: An iterator equivalent to: map(func, *iterables) but the calls may be evaluated out-of-order. Raises: TimeoutError: If the entire result iterator could not be generated before the given timeout. Exception: If fn(*args) raises for any values. \"\"\" timeout = kwargs.get('timeout') if timeout is not None: end_time = timeout + time.time() fs = [self.submit(fn, *args) for args in itertools.izip(*iterables)] # Yield must be hidden in closure so that the futures are submitted # before the first iterator value is required. def result_iterator(): try: for future in fs: if timeout is None: yield future.result() else: yield future.result(end_time - time.time()) finally: for future in fs: future.cancel() return result_iterator() def shutdown(self, wait=True): \"\"","date":"2020-11-18","objectID":"/python/concurrent/:2:0","tags":["python","å¤šçº¿ç¨‹","å¤šè¿›ç¨‹"],"title":"pythonä¸­çš„å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ï¼ˆäºŒï¼‰","uri":"/python/concurrent/"},{"categories":null,"content":"concurrent ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°çš„å‘ æ‰§è¡Œç¯å¢ƒä¸º python-2.7.15 å‡è®¾æœ‰è¿™ä¹ˆä¸€ä¸ªè„šæœ¬ multipy.py # -*- coding: UTF-8 -*- from concurrent.futures._base import TimeoutError from concurrent.futures import ProcessPoolExecutor import time def runner(index, param) : print(\"çº¿ç¨‹{} å¼€å§‹è¿è¡Œ: ------------\".format(index)) print(\"çº¿ç¨‹{} : {}\".format(index,param)) time.sleep(3) print(\"çº¿ç¨‹{} è¿è¡Œç»“æŸ: ------------\".format(index)) def main(max_workers=1) : print(\"æ‰§è¡Œå‡çº§ä»»åŠ¡çš„å¹¶å‘æ•°ä¸ºä¸ºï¼š {}\".format(max_workers)) runners = [\"python\", \"java\", \"golang\", \"php\", \"rust\", \"shell\", \"c\"] with ProcessPoolExecutor(max_workers=max_workers) as executor: for index, value in enumerate(runners): result = executor.submit(runner, index, value) try: result.result(timeout=3 * 60) except TimeoutError as err: print(\"ä»»åŠ¡è¶…æ—¶,\", err) if __name__ == \"__main__\" : main(3) é€šè¿‡åœ¨å‘½ä»¤è¡Œæ‰§è¡Œ python multipy.py ï¼Œå¤§å®¶å¯ä»¥åœ¨å¿ƒé‡Œæƒ³è±¡ä¸€ä¸‹ä¼šè¾“å‡ºä»€ä¹ˆã€‚ ç¬¬äºŒä¸ªåœºæ™¯æ˜¯ï¼šåŒæ ·çš„è„šæœ¬ï¼Œ é€šè¿‡ setuptools å®‰è£…åæ‰§è¡Œï¼Œéƒ¨åˆ†ä»£ç ï¼ˆsetup.pyï¼‰å¦‚ä¸‹: #!/usr/bin/env python from setuptools import setup, find_packages setup( name=\"pyctl\", entry_points=''' [console_scripts] pyctl=pyctl.commands.shell:cli ''', classifiers=[ ... ], install_requires=[ ... 'click==7.0' ], ) å®‰è£…å®Œæˆä¹‹åå¯ä»¥åœ¨å‘½ä»¤è¡Œé€šè¿‡ pyctl xxx ... æ‰§è¡Œï¼Œå’Œæ‰§è¡Œç³»ç»Ÿå‘½ä»¤æ˜¯ä¸€æ ·çš„ï¼Œå¦‚æœä¸ç†Ÿæ‚‰ setuptools å¯ä»¥å…ˆäº†è§£ä¸€ä¸‹ï¼Œæ–‡æ¡£å‚è€ƒhttps://pypi.org/project/setuptools/ è¨€å½’æ­£ä¼ ï¼Œé€šè¿‡ setuptools æ‰“åŒ…ä¹‹åå†æ‰§è¡Œè¿™ä¸ªè„šæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥å‡è®¾æ‰“åŒ…ä¹‹åçš„æ‰§è¡Œæ–¹å¼ä¸º pyctl multipy ï¼Œæ‰§è¡Œåä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿå¤§å®¶ä¹Ÿå¯ä»¥åœ¨å¿ƒé‡Œå…ˆæƒ³è±¡ä¸€ä¸‹ã€‚ å®é™…çš„ç»“æœå°±æ˜¯ç›´æ¥é€šè¿‡ python multipy.py çš„æ–¹å¼å¯ä»¥å¾—åˆ°æ­£ç¡®çš„ç»“æœï¼Œç¡®å®æŒ‰ç…§å¤šè¿›ç¨‹çš„æ–¹å¼å¹¶å‘æ‰§è¡Œï¼Œä½†æ˜¯åˆ°ç¬¬äºŒä¸ªåœºæ™¯æ—¶å´æ— æ³•è¿è¡Œï¼Œé€šè¿‡ ps -ef æŸ¥çœ‹è¿›ç¨‹ï¼Œç¡®å®åˆ›å»ºäº†å¤šä¸ªè¿›ç¨‹ï¼Œä½†è¿™äº›è¿›ç¨‹éƒ½è¢«é˜»å¡ï¼Œæ²¡æœ‰æ‰§è¡Œ runner å‡½æ•°é‡Œé¢çš„å†…å®¹ï¼Œç¨‹åºä¼šè¢«å¡æ­»ã€‚å½“æ—¶ç™¾æ€ä¸è§£å…¶ä¸­çš„åŸå› ï¼Œå°è¯•è¿‡å¾ˆå¤šæ–¹æ³•ï¼ŒåŒ…æ‹¬ä½¿ç”¨åŸç”Ÿçš„ multiprocessing è‡ªå·±å®ç°è¿›ç¨‹ç®¡ç†ä¹Ÿæ˜¯åŒæ ·çš„æ•ˆæœï¼Œæœ€åæ˜¯åŒæ ·çš„ä»£ç ï¼Œæ¢åˆ°python3.8ï¼Œä¸¤ç§æ–¹æ³•éƒ½å¯ä»¥å¾—åˆ°æ­£ç¡®ç»“æœã€‚python2.7 ä¸ºå•¥ä¼šå¡æ­»ï¼Œå¤šä¸ªè¿›ç¨‹åˆ›å»ºå‡ºæ¥æ²¡æœ‰æ‰§è¡Œ runner ä»»åŠ¡è‡³ä»Šè¿˜æ²¡æœ‰æ‰¾åˆ°åŸå› ï¼Œåç»­æœ‰è¿›å±•å†æ›´æ–°ï¼Œ æ¬¢è¿çŸ¥é“åŸå› çš„å°ä¼™ä¼´ç•™è¨€å‘ŠçŸ¥ï¼ï¼ï¼ ","date":"2020-11-18","objectID":"/python/concurrent/:3:0","tags":["python","å¤šçº¿ç¨‹","å¤šè¿›ç¨‹"],"title":"pythonä¸­çš„å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ï¼ˆäºŒï¼‰","uri":"/python/concurrent/"},{"categories":null,"content":"æ€»ç»“ åœ¨python2.7çš„ç¯å¢ƒä¸‹é¢ï¼Œå¦‚æœé€šè¿‡ setuptools æ‰“åŒ…å®‰è£…ï¼Œå®‰è£…åå¤šè¿›ç¨‹ä½¿ç”¨ä¼šæœ‰é—®é¢˜ï¼Œç°è±¡æ˜¯ä¼šåˆ›å»ºå¤šä¸ªå­è¿›ç¨‹å‡ºæ¥ï¼Œä½†æ˜¯ä¸»è¿›ç¨‹å’Œå­è¿›ç¨‹éƒ½ä¼šè¢«é˜»å¡è€Œæ— æ³•çœŸæ­£æ‰§è¡Œrunnerä»»åŠ¡ï¼Œä¸€ä¸ªè¡Œä¹‹æœ‰æ•ˆçš„æ–¹æ³•æ˜¯åˆ‡æ¢åˆ°python3ï¼ˆpython3.8äº²æµ‹æ²¡æœ‰é—®é¢˜ï¼Œå…¶ä»–çš„æ²¡æµ‹è¿‡ï¼‰ã€‚ ","date":"2020-11-18","objectID":"/python/concurrent/:4:0","tags":["python","å¤šçº¿ç¨‹","å¤šè¿›ç¨‹"],"title":"pythonä¸­çš„å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ï¼ˆäºŒï¼‰","uri":"/python/concurrent/"},{"categories":null,"content":"pythonä¸­çš„å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ï¼ˆä¸€ï¼‰","date":"2020-11-16","objectID":"/multithread/","tags":["python","å¤šçº¿ç¨‹","å¤šè¿›ç¨‹"],"title":"pythonä¸­çš„å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ï¼ˆä¸€ï¼‰","uri":"/multithread/"},{"categories":null,"content":"å¯¼è¯» åœ¨ç¼–ç çš„è¿‡ç¨‹ï¼Œå¤šçº¿ç¨‹ã€å¤šè¿›ç¨‹ã€å¹¶å‘ã€å¹¶è¡Œè¿™äº›æ¦‚å¿µè‚¯å®šä¸æ­¢ä¸€æ¬¡çš„å‡ºç°åœ¨æˆ‘ä»¬é¢å‰ã€‚æ¦‚å¿µç†è§£æ˜¯ä¸€å›äº‹ï¼Œä½†æ˜¯èƒ½çœŸæ­£ç”¨å¥½åˆæ˜¯å¦ä¸€å›äº‹ã€‚ä¸åŒçš„ç¼–ç¨‹è¯­è¨€ï¼Œå¹¶å‘ç¼–ç¨‹éš¾æ˜“ç¨‹åº¦ç›¸å·®è¿˜æ˜¯å¾ˆå¤§çš„ï¼Œæ­£å¥½è¿™å‡ å¤©æ¢³ç†äº†ä»–ä»¬ä¹‹é—´çš„å…³ç³»ä¸åŒºåˆ«ï¼Œåˆ†äº«ç»™å¤§å®¶ã€‚ï¼ˆåŸºäºè‡ªå·±çš„ç†è§£è°ˆè°ˆï¼Œå¦‚æœä¸å¯¹æ¬¢è¿æŒ‡å‡ºï¼‰ çµé­‚æ‹·é—®ï¼šä»€ä¹ˆæ˜¯çº¿ç¨‹ï¼Ÿä»€ä¹ˆæ˜¯è¿›ç¨‹ï¼Ÿ ","date":"2020-11-16","objectID":"/multithread/:1:0","tags":["python","å¤šçº¿ç¨‹","å¤šè¿›ç¨‹"],"title":"pythonä¸­çš„å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ï¼ˆä¸€ï¼‰","uri":"/multithread/"},{"categories":null,"content":"è¿›ç¨‹ è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„æœ€å°å•ä½ã€‚ ","date":"2020-11-16","objectID":"/multithread/:2:0","tags":["python","å¤šçº¿ç¨‹","å¤šè¿›ç¨‹"],"title":"pythonä¸­çš„å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ï¼ˆä¸€ï¼‰","uri":"/multithread/"},{"categories":null,"content":"çº¿ç¨‹ çº¿ç¨‹æ˜¯ cpu è°ƒåº¦çš„æœ€å°è°ƒåº¦ã€‚çº¿ç¨‹åˆåˆ†ä¸ºå†…æ ¸çº¿ç¨‹ï¼Œç”¨æˆ·çº¿ç¨‹ã€‚ å†…æ ¸çº¿ç¨‹åªè¿è¡Œåœ¨å†…æ ¸æ€ï¼Œä¸å—ç”¨æˆ·æ€çš„æ‹–ç´¯ã€‚ ç”¨æˆ·çº¿ç¨‹æ˜¯å®Œå…¨å»ºç«‹åœ¨ç”¨æˆ·ç©ºé—´çš„çº¿ç¨‹åº“ï¼Œç”¨æˆ·çº¿ç¨‹çš„åˆ›å»ºã€è°ƒåº¦ã€åŒæ­¥å’Œé”€æ¯åœ¨ç”¨æˆ·ç©ºé—´å®Œæˆï¼Œä¸éœ€è¦å†…æ ¸çš„å¸®åŠ©ã€‚ç”¨æˆ·çº¿ç¨‹åˆç§°ä¸ºåç¨‹ã€‚ ä¸€ä¸ªçº¿ç¨‹åªèƒ½å±äºä¸€ä¸ªè¿›ç¨‹ï¼Œä½†æ˜¯ä¸€ä¸ªè¿›ç¨‹å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œå¤šçº¿ç¨‹å¤„ç†å°±æ˜¯ä¸€ä¸ªè¿›ç¨‹å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹åœ¨åŒä¸€ä¸ªæ—¶åˆ»æ‰§è¡Œå¤šä¸ªä»»åŠ¡ã€‚ è¿™äº›æ˜¯æ¯”è¾ƒå®˜æ–¹çš„å®šä¹‰ï¼Œç®€å•ç†è§£å°±æ˜¯è¿è¡Œä¸€æ®µç¨‹åºï¼Œéœ€è¦ä¸€å®šçš„èµ„æºï¼Œå¦‚cpuï¼Œç³»ç»Ÿå†…æ ¸ä¼šåˆ†é…ç»™è¿›ç¨‹ï¼Œè‡³äºæ€ä¹ˆåˆ†é…è¿™äº›èµ„æºå¯ç”±çº¿ç¨‹å»æŠ¢ï¼Œå¦‚æœæŸä¸ªçº¿ç¨‹å ç”¨èµ„æº(cpu)æ—¶é—´å¤ªé•¿ï¼Œå†…æ ¸ä¸ºäº†å¹³è¡¡ï¼Œä¼šå¼ºè¡Œä¸­æ–­ï¼Œåˆ‡æ¢ç»™å…¶ä»–çš„çº¿ç¨‹æ‰§è¡Œï¼Œä½†æ˜¯æ¯æ¬¡åˆ‡æ¢éƒ½æ˜¯æœ‰ä»£ä»·çš„ï¼Œéœ€è¦æŠŠæ‰§è¡Œç°åœºä¿ç•™ä»¥ç¡®ä¿åç»­æ¢å¤çš„æ—¶å€™å¯ä»¥æ­£å¸¸æ‰§è¡Œï¼Œè¿™å°±æœ‰äº†å†…æ ¸å’Œç”¨æˆ·æ€çš„åˆ‡æ¢ï¼ˆè¿›ç¨‹å’Œçº¿ç¨‹éƒ½æ˜¯å—å†…æ ¸æ§åˆ¶çš„ï¼‰ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå¦‚æœåªåœ¨ç”¨æˆ·æ€åˆ‡æ¢ï¼Œå²‚ä¸æ˜¯å¾ˆå¥½ï¼Ÿè¿˜çœŸæ˜¯è¿™æ ·ï¼Œgo è¯­è¨€å°±æ˜¯è¿™æ ·å®ç°ã€‚ ","date":"2020-11-16","objectID":"/multithread/:3:0","tags":["python","å¤šçº¿ç¨‹","å¤šè¿›ç¨‹"],"title":"pythonä¸­çš„å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ï¼ˆä¸€ï¼‰","uri":"/multithread/"},{"categories":null,"content":"python å¤šçº¿ç¨‹æ—¶é‡åˆ°çš„å‘ python ä¸­å¦‚æœè¦ç”¨å¤šçº¿ç¨‹æˆ–è€…å¤šè¿›ç¨‹æ—¶éœ€è¦è‡ªå·±åˆ›å»ºçº¿ç¨‹æˆ–è€…è¿›ç¨‹ï¼Œè¿™å’Œgoè¯­è¨€ä¸ä¸€æ ·ï¼Œgoè¯­è¨€åªéœ€è¦é€šè¿‡ go å…³é”®å­—åˆ›å»ºå‡ºåç¨‹ï¼Œç„¶åç”±runtime è¿›è¡Œè°ƒåº¦ï¼ˆä¸éœ€è¦è‡ªå·±å¤„ç†è¿›ç¨‹ä¸çº¿ç¨‹ï¼‰ã€‚ä»Šå¤©å…ˆçœ‹çœ‹python ä¸­å¦‚ä½•ä½¿ç”¨å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ã€‚python ç¯å¢ƒä¸º 2.7.15 ã€‚ å…ˆçœ‹ä¸€æ®µç®€å•çš„ä»£ç  import threading import time â€‹ lock = threading.Lock() â€‹ def runner(i, p1, p2, p3=\"\", p4=\"\", **kwargs): \"\"\" :return: \"\"\" count = 0 print(\"çº¿ç¨‹{} param1:====\".format(i), p1) print(\"çº¿ç¨‹{} param2:====\".format(i), p2) print(\"çº¿ç¨‹{} param3:====\".format(i), p3) print(\"çº¿ç¨‹{} param3:====\".format(i), p4) while True: with lock: count += 1 print(\"çº¿ç¨‹{} ç¬¬ {} ç§’ å: ......\".format(i, count)) time.sleep(1) if count == 5: break def main_thread(): \"\"\" ä¸»çº¿ç¨‹çš„è¿è¡Œä»£ç  :return: \"\"\" print(\"ä¸»çº¿ç¨‹å¼€å§‹æ‰§è¡Œ\") time.sleep(1) print(\"ä¸»çº¿ç¨‹æ‰§è¡Œç»“æŸ\") â€‹ def main(): \"\"\" :return: \"\"\" for i in range(5): thread = threading.Thread(target=runner, args=(i, \"a1\", \"a2\"), kwargs={\"p3\": \"p2\", \"p4\": \"p4\"}) thread.setName(\"çº¿ç¨‹{}\".format(i)) thread.start() â€‹ main_thread() â€‹ if __name__ == \"__main__\": main() â€‹ è¿™ä¸ªåº”è¯¥èƒ½æƒ³çš„å‡ºæ¥ä¸åŒçš„çº¿ç¨‹çš„è¾“å‡ºæ˜¯äº¤å‰æ‰“å°å‡ºæ¥çš„ï¼Œè¯´æ˜è¿™æ˜¯å¤šä¸ªçº¿ç¨‹å¹¶å‘æ‰§è¡Œçš„ã€‚ ç°åœ¨å‡è®¾æœ‰è¿™ä¹ˆä¸€ä¸ªåœºæ™¯ï¼Œæœ‰10å°æœºå™¨ï¼Œæ¯ä¸ªæœºå™¨ä¸Šæœ‰10ä¸ªå®¹å™¨éœ€è¦é‡å¯ï¼Œå¦‚æœè¦å¹¶å‘çš„æ‰§è¡Œåº”è¯¥æ€ä¹ˆåšå‘¢? çœ‹çœ‹ä¸‹é¢çš„ä»£ç æœ‰æ²¡æœ‰é—®é¢˜? import os â€‹ import threading â€‹ def runnner(hostip) : appIds = [ \"app-{}\".format(i) for i in range(10)] cmd = \"docker restart {}\".format(\" \".join(appIds)) print(cmd) os.system(\"ssh {hostip} {cmd}\".format(hostip=hostip,cmd=cmd)) â€‹ hosts = [\"10.0.0.1\", \"10.0.0.2\", \"10.0.0.3\" , \"10.0.0.4\", \"10.0.0.5\",\"10.0.0.6\", \"10.0.0.7\", \"10.0.0.8\" , \"10.0.0.9\", \"10.0.0.10\"] â€‹ for hostip in hosts : thread = threading.Thread(target=runnner, args=(hostip,)) thread.start() çœ‹èµ·æ¥åº”è¯¥æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œç„¶è€ŒçœŸæ­£æ‰§è¡Œçš„è¿˜æ˜¯ä¸²è¡Œï¼Œæ²¡æœ‰åˆ°è¾¾å¹¶å‘æ‰§è¡Œçš„ç›®çš„ã€‚é—®é¢˜å‡ºåœ¨å“ªé‡Œå‘¢ï¼Ÿ åœ¨python ä¸­çº¿ç¨‹æ‰§è¡Œéœ€è¦å…ˆè·å–GILé”ï¼ˆå…¨å±€è§£é‡Šå™¨é”ï¼‰ï¼Œçœ‹èµ·æ¥æ˜¯åˆ›å»ºäº†å¤šä¸ªçº¿ç¨‹ï¼Œä½†æ˜¯åŒä¸€ä¸ªæ—¶é—´ç‚¹æ¯ä¸ªè¿›ç¨‹åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è·å–è¿™ä¸ªé”å¹¶ä¸”æ‰§è¡Œï¼Œæ˜¯ä¸€ç§ä¼ªå¤šçº¿ç¨‹ï¼Œå¦‚æœåœ¨å¯†é›†è®¡ç®—çš„åœºæ™¯ï¼Œå°±ä¼šé¢‘ç¹çš„å‘ç”Ÿçº¿ç¨‹åˆ‡æ¢ï¼Œè¿™ä¸ªæ˜¯å¾ˆè€—æ—¶é—´çš„ï¼Œè¿˜æ²¡æœ‰å•çº¿ç¨‹æ•ˆæœå¥½ã€‚é‚£ä¹ˆé—®é¢˜åˆæ¥äº†ï¼Œä»€ä¹ˆä¼šå‘ç”Ÿçº¿ç¨‹åˆ‡æ¢å‘¢? å¦‚æœé‡åˆ°ioç­‰å¾…æˆ–è€…sleep æ—¶è‚¯å®šä¼šå‘ç”Ÿåˆ‡æ¢ï¼Œè¿˜æœ‰å°±æ˜¯æ¯100æ¡æŒ‡ä»¤åˆ‡æ¢ä¸€æ¬¡çº¿ç¨‹ã€‚å¯ä»¥é€šè¿‡å¦‚ä¸‹æŒ‡ä»¤è®¾ç½®: sys.setcheckinterval ä¸Šé¢è¿™é‡Œä¾‹å­å°±æ²¡æœ‰è§¦å‘çº¿ç¨‹çš„åˆ‡æ¢ï¼Œå½“å‰é¢çš„çº¿ç¨‹æ‰§è¡Œå®Œé€€å‡ºä¹‹åé‡Šæ”¾GILé”ï¼Œåç»­çš„çº¿ç¨‹æ‰èƒ½æ‰§è¡Œï¼Œæ‰€ä»¥æ‰æœ‰çœ‹èµ·æ¥æ˜¯å¤šçº¿ç¨‹çš„å†™æ³•ï¼Œä½†æ˜¯ç¡®å®å•çº¿ç¨‹çš„æ•ˆæœã€‚ æ”¹è¿›çš„æ–¹æ³•å½“ç„¶ä½¿ç”¨å¤šè¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„GILé”ï¼Œå¯ä»¥çœŸæ­£çš„å®ç°å¹¶å‘ã€‚è¿›ç¨‹å¹¶ä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼Œåˆ›å»ºè¿›ç¨‹å¼€é”€æ¯”çº¿ç¨‹è¦å¤§å¾ˆå¤šï¼Œå¦‚æœè¿›ç¨‹ä¹‹é—´æœ‰æ•°æ®äº¤æ¢ä¹Ÿæ¯”çº¿ç¨‹å¤æ‚ï¼Œå¹¶ä¸”çœŸæ­£æ‰§è¡Œè¿˜æ˜¯è¦è½åˆ°cpuä¸Šå»æ‰§è¡Œï¼Œè¿›ç¨‹å¤šäº†ä¹Ÿä¼šé€ æˆæ’é˜Ÿï¼Œç†è®ºä¸Šå’Œåˆ›å»ºå’Œcpuç›¸åŒä¸ªæ•°çš„è¿›ç¨‹æ€§èƒ½æœ€å¥½ã€‚ä¸‹é¢çœ‹çœ‹å¤šè¿›ç¨‹çš„å†™æ³•ã€‚ import os from multiprocessing import Process â€‹ def runnner(hostip) : appIds = [ \"app-{}\".format(i) for i in range(10)] cmd = \"docker restart {}\".format(\" \".join(appIds)) print(cmd) os.system(\"ssh {hostip} {cmd}\".format(hostip=hostip,cmd=cmd)) â€‹ â€‹ hosts = [\"10.0.0.{}\".format(i) for i in range(10)] â€‹ â€‹ for hostip in hosts : process = Process(target=runnner, args=(hostip,)) process.start() å½“ç„¶å¯ä»¥ç”¨è¿›ç¨‹æ± æ§åˆ¶è¿›ç¨‹çš„ä¸ªæ•°ï¼Œå¦‚: import os â€‹ from multiprocessing import Pool â€‹ def runnner(hostip) : appIds = [ \"app-{}\".format(i) for i in range(10)] cmd = \"docker restart {}\".format(\" \".join(appIds)) print(cmd) os.system(\"ssh {hostip} {cmd}\".format(hostip=hostip,cmd=cmd)) â€‹ â€‹ hosts = [\"10.0.0.{}\".format(i) for i in range(10)] â€‹ p = Pool(4) â€‹ for hostip in hosts : p.apply_async(runnner, args=(hostip,)) # å¼‚æ­¥æ‰§è¡Œ p.close() p.join() ","date":"2020-11-16","objectID":"/multithread/:4:0","tags":["python","å¤šçº¿ç¨‹","å¤šè¿›ç¨‹"],"title":"pythonä¸­çš„å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ï¼ˆä¸€ï¼‰","uri":"/multithread/"},{"categories":null,"content":"å‚è€ƒ https://docs.python.org/2/library/sys.html#sys.setcheckinterval ","date":"2020-11-16","objectID":"/multithread/:5:0","tags":["python","å¤šçº¿ç¨‹","å¤šè¿›ç¨‹"],"title":"pythonä¸­çš„å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ï¼ˆä¸€ï¼‰","uri":"/multithread/"},{"categories":null,"content":"pythonä¸­çš„å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ï¼ˆä¸€ï¼‰","date":"2020-11-16","objectID":"/python/multithread/","tags":["python","å¤šçº¿ç¨‹","å¤šè¿›ç¨‹"],"title":"pythonä¸­çš„å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ï¼ˆä¸€ï¼‰","uri":"/python/multithread/"},{"categories":null,"content":"å¯¼è¯» åœ¨ç¼–ç çš„è¿‡ç¨‹ï¼Œå¤šçº¿ç¨‹ã€å¤šè¿›ç¨‹ã€å¹¶å‘ã€å¹¶è¡Œè¿™äº›æ¦‚å¿µè‚¯å®šä¸æ­¢ä¸€æ¬¡çš„å‡ºç°åœ¨æˆ‘ä»¬é¢å‰ã€‚æ¦‚å¿µç†è§£æ˜¯ä¸€å›äº‹ï¼Œä½†æ˜¯èƒ½çœŸæ­£ç”¨å¥½åˆæ˜¯å¦ä¸€å›äº‹ã€‚ä¸åŒçš„ç¼–ç¨‹è¯­è¨€ï¼Œå¹¶å‘ç¼–ç¨‹éš¾æ˜“ç¨‹åº¦ç›¸å·®è¿˜æ˜¯å¾ˆå¤§çš„ï¼Œæ­£å¥½è¿™å‡ å¤©æ¢³ç†äº†ä»–ä»¬ä¹‹é—´çš„å…³ç³»ä¸åŒºåˆ«ï¼Œåˆ†äº«ç»™å¤§å®¶ã€‚ï¼ˆåŸºäºè‡ªå·±çš„ç†è§£è°ˆè°ˆï¼Œå¦‚æœä¸å¯¹æ¬¢è¿æŒ‡å‡ºï¼‰ çµé­‚æ‹·é—®ï¼šä»€ä¹ˆæ˜¯çº¿ç¨‹ï¼Ÿä»€ä¹ˆæ˜¯è¿›ç¨‹ï¼Ÿ ","date":"2020-11-16","objectID":"/python/multithread/:1:0","tags":["python","å¤šçº¿ç¨‹","å¤šè¿›ç¨‹"],"title":"pythonä¸­çš„å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ï¼ˆä¸€ï¼‰","uri":"/python/multithread/"},{"categories":null,"content":"è¿›ç¨‹ è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„æœ€å°å•ä½ã€‚ ","date":"2020-11-16","objectID":"/python/multithread/:2:0","tags":["python","å¤šçº¿ç¨‹","å¤šè¿›ç¨‹"],"title":"pythonä¸­çš„å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ï¼ˆä¸€ï¼‰","uri":"/python/multithread/"},{"categories":null,"content":"çº¿ç¨‹ çº¿ç¨‹æ˜¯ cpu è°ƒåº¦çš„æœ€å°è°ƒåº¦ã€‚çº¿ç¨‹åˆåˆ†ä¸ºå†…æ ¸çº¿ç¨‹ï¼Œç”¨æˆ·çº¿ç¨‹ã€‚ å†…æ ¸çº¿ç¨‹åªè¿è¡Œåœ¨å†…æ ¸æ€ï¼Œä¸å—ç”¨æˆ·æ€çš„æ‹–ç´¯ã€‚ ç”¨æˆ·çº¿ç¨‹æ˜¯å®Œå…¨å»ºç«‹åœ¨ç”¨æˆ·ç©ºé—´çš„çº¿ç¨‹åº“ï¼Œç”¨æˆ·çº¿ç¨‹çš„åˆ›å»ºã€è°ƒåº¦ã€åŒæ­¥å’Œé”€æ¯åœ¨ç”¨æˆ·ç©ºé—´å®Œæˆï¼Œä¸éœ€è¦å†…æ ¸çš„å¸®åŠ©ã€‚ç”¨æˆ·çº¿ç¨‹åˆç§°ä¸ºåç¨‹ã€‚ ä¸€ä¸ªçº¿ç¨‹åªèƒ½å±äºä¸€ä¸ªè¿›ç¨‹ï¼Œä½†æ˜¯ä¸€ä¸ªè¿›ç¨‹å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œå¤šçº¿ç¨‹å¤„ç†å°±æ˜¯ä¸€ä¸ªè¿›ç¨‹å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹åœ¨åŒä¸€ä¸ªæ—¶åˆ»æ‰§è¡Œå¤šä¸ªä»»åŠ¡ã€‚ è¿™äº›æ˜¯æ¯”è¾ƒå®˜æ–¹çš„å®šä¹‰ï¼Œç®€å•ç†è§£å°±æ˜¯è¿è¡Œä¸€æ®µç¨‹åºï¼Œéœ€è¦ä¸€å®šçš„èµ„æºï¼Œå¦‚cpuï¼Œç³»ç»Ÿå†…æ ¸ä¼šåˆ†é…ç»™è¿›ç¨‹ï¼Œè‡³äºæ€ä¹ˆåˆ†é…è¿™äº›èµ„æºå¯ç”±çº¿ç¨‹å»æŠ¢ï¼Œå¦‚æœæŸä¸ªçº¿ç¨‹å ç”¨èµ„æº(cpu)æ—¶é—´å¤ªé•¿ï¼Œå†…æ ¸ä¸ºäº†å¹³è¡¡ï¼Œä¼šå¼ºè¡Œä¸­æ–­ï¼Œåˆ‡æ¢ç»™å…¶ä»–çš„çº¿ç¨‹æ‰§è¡Œï¼Œä½†æ˜¯æ¯æ¬¡åˆ‡æ¢éƒ½æ˜¯æœ‰ä»£ä»·çš„ï¼Œéœ€è¦æŠŠæ‰§è¡Œç°åœºä¿ç•™ä»¥ç¡®ä¿åç»­æ¢å¤çš„æ—¶å€™å¯ä»¥æ­£å¸¸æ‰§è¡Œï¼Œè¿™å°±æœ‰äº†å†…æ ¸å’Œç”¨æˆ·æ€çš„åˆ‡æ¢ï¼ˆè¿›ç¨‹å’Œçº¿ç¨‹éƒ½æ˜¯å—å†…æ ¸æ§åˆ¶çš„ï¼‰ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå¦‚æœåªåœ¨ç”¨æˆ·æ€åˆ‡æ¢ï¼Œå²‚ä¸æ˜¯å¾ˆå¥½ï¼Ÿè¿˜çœŸæ˜¯è¿™æ ·ï¼Œgo è¯­è¨€å°±æ˜¯è¿™æ ·å®ç°ã€‚ ","date":"2020-11-16","objectID":"/python/multithread/:3:0","tags":["python","å¤šçº¿ç¨‹","å¤šè¿›ç¨‹"],"title":"pythonä¸­çš„å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ï¼ˆä¸€ï¼‰","uri":"/python/multithread/"},{"categories":null,"content":"python å¤šçº¿ç¨‹æ—¶é‡åˆ°çš„å‘ python ä¸­å¦‚æœè¦ç”¨å¤šçº¿ç¨‹æˆ–è€…å¤šè¿›ç¨‹æ—¶éœ€è¦è‡ªå·±åˆ›å»ºçº¿ç¨‹æˆ–è€…è¿›ç¨‹ï¼Œè¿™å’Œgoè¯­è¨€ä¸ä¸€æ ·ï¼Œgoè¯­è¨€åªéœ€è¦é€šè¿‡ go å…³é”®å­—åˆ›å»ºå‡ºåç¨‹ï¼Œç„¶åç”±runtime è¿›è¡Œè°ƒåº¦ï¼ˆä¸éœ€è¦è‡ªå·±å¤„ç†è¿›ç¨‹ä¸çº¿ç¨‹ï¼‰ã€‚ä»Šå¤©å…ˆçœ‹çœ‹python ä¸­å¦‚ä½•ä½¿ç”¨å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ã€‚python ç¯å¢ƒä¸º 2.7.15 ã€‚ å…ˆçœ‹ä¸€æ®µç®€å•çš„ä»£ç  import threading import time â€‹ lock = threading.Lock() â€‹ def runner(i, p1, p2, p3=\"\", p4=\"\", **kwargs): \"\"\" :return: \"\"\" count = 0 print(\"çº¿ç¨‹{} param1:====\".format(i), p1) print(\"çº¿ç¨‹{} param2:====\".format(i), p2) print(\"çº¿ç¨‹{} param3:====\".format(i), p3) print(\"çº¿ç¨‹{} param3:====\".format(i), p4) while True: with lock: count += 1 print(\"çº¿ç¨‹{} ç¬¬ {} ç§’ å: ......\".format(i, count)) time.sleep(1) if count == 5: break def main_thread(): \"\"\" ä¸»çº¿ç¨‹çš„è¿è¡Œä»£ç  :return: \"\"\" print(\"ä¸»çº¿ç¨‹å¼€å§‹æ‰§è¡Œ\") time.sleep(1) print(\"ä¸»çº¿ç¨‹æ‰§è¡Œç»“æŸ\") â€‹ def main(): \"\"\" :return: \"\"\" for i in range(5): thread = threading.Thread(target=runner, args=(i, \"a1\", \"a2\"), kwargs={\"p3\": \"p2\", \"p4\": \"p4\"}) thread.setName(\"çº¿ç¨‹{}\".format(i)) thread.start() â€‹ main_thread() â€‹ if __name__ == \"__main__\": main() â€‹ è¿™ä¸ªåº”è¯¥èƒ½æƒ³çš„å‡ºæ¥ä¸åŒçš„çº¿ç¨‹çš„è¾“å‡ºæ˜¯äº¤å‰æ‰“å°å‡ºæ¥çš„ï¼Œè¯´æ˜è¿™æ˜¯å¤šä¸ªçº¿ç¨‹å¹¶å‘æ‰§è¡Œçš„ã€‚ ç°åœ¨å‡è®¾æœ‰è¿™ä¹ˆä¸€ä¸ªåœºæ™¯ï¼Œæœ‰10å°æœºå™¨ï¼Œæ¯ä¸ªæœºå™¨ä¸Šæœ‰10ä¸ªå®¹å™¨éœ€è¦é‡å¯ï¼Œå¦‚æœè¦å¹¶å‘çš„æ‰§è¡Œåº”è¯¥æ€ä¹ˆåšå‘¢? çœ‹çœ‹ä¸‹é¢çš„ä»£ç æœ‰æ²¡æœ‰é—®é¢˜? import os â€‹ import threading â€‹ def runnner(hostip) : appIds = [ \"app-{}\".format(i) for i in range(10)] cmd = \"docker restart {}\".format(\" \".join(appIds)) print(cmd) os.system(\"ssh {hostip} {cmd}\".format(hostip=hostip,cmd=cmd)) â€‹ hosts = [\"10.0.0.1\", \"10.0.0.2\", \"10.0.0.3\" , \"10.0.0.4\", \"10.0.0.5\",\"10.0.0.6\", \"10.0.0.7\", \"10.0.0.8\" , \"10.0.0.9\", \"10.0.0.10\"] â€‹ for hostip in hosts : thread = threading.Thread(target=runnner, args=(hostip,)) thread.start() çœ‹èµ·æ¥åº”è¯¥æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œç„¶è€ŒçœŸæ­£æ‰§è¡Œçš„è¿˜æ˜¯ä¸²è¡Œï¼Œæ²¡æœ‰åˆ°è¾¾å¹¶å‘æ‰§è¡Œçš„ç›®çš„ã€‚é—®é¢˜å‡ºåœ¨å“ªé‡Œå‘¢ï¼Ÿ åœ¨python ä¸­çº¿ç¨‹æ‰§è¡Œéœ€è¦å…ˆè·å–GILé”ï¼ˆå…¨å±€è§£é‡Šå™¨é”ï¼‰ï¼Œçœ‹èµ·æ¥æ˜¯åˆ›å»ºäº†å¤šä¸ªçº¿ç¨‹ï¼Œä½†æ˜¯åŒä¸€ä¸ªæ—¶é—´ç‚¹æ¯ä¸ªè¿›ç¨‹åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è·å–è¿™ä¸ªé”å¹¶ä¸”æ‰§è¡Œï¼Œæ˜¯ä¸€ç§ä¼ªå¤šçº¿ç¨‹ï¼Œå¦‚æœåœ¨å¯†é›†è®¡ç®—çš„åœºæ™¯ï¼Œå°±ä¼šé¢‘ç¹çš„å‘ç”Ÿçº¿ç¨‹åˆ‡æ¢ï¼Œè¿™ä¸ªæ˜¯å¾ˆè€—æ—¶é—´çš„ï¼Œè¿˜æ²¡æœ‰å•çº¿ç¨‹æ•ˆæœå¥½ã€‚é‚£ä¹ˆé—®é¢˜åˆæ¥äº†ï¼Œä»€ä¹ˆä¼šå‘ç”Ÿçº¿ç¨‹åˆ‡æ¢å‘¢? å¦‚æœé‡åˆ°ioç­‰å¾…æˆ–è€…sleep æ—¶è‚¯å®šä¼šå‘ç”Ÿåˆ‡æ¢ï¼Œè¿˜æœ‰å°±æ˜¯æ¯100æ¡æŒ‡ä»¤åˆ‡æ¢ä¸€æ¬¡çº¿ç¨‹ã€‚å¯ä»¥é€šè¿‡å¦‚ä¸‹æŒ‡ä»¤è®¾ç½®: sys.setcheckinterval ä¸Šé¢è¿™é‡Œä¾‹å­å°±æ²¡æœ‰è§¦å‘çº¿ç¨‹çš„åˆ‡æ¢ï¼Œå½“å‰é¢çš„çº¿ç¨‹æ‰§è¡Œå®Œé€€å‡ºä¹‹åé‡Šæ”¾GILé”ï¼Œåç»­çš„çº¿ç¨‹æ‰èƒ½æ‰§è¡Œï¼Œæ‰€ä»¥æ‰æœ‰çœ‹èµ·æ¥æ˜¯å¤šçº¿ç¨‹çš„å†™æ³•ï¼Œä½†æ˜¯ç¡®å®å•çº¿ç¨‹çš„æ•ˆæœã€‚ æ”¹è¿›çš„æ–¹æ³•å½“ç„¶ä½¿ç”¨å¤šè¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„GILé”ï¼Œå¯ä»¥çœŸæ­£çš„å®ç°å¹¶å‘ã€‚è¿›ç¨‹å¹¶ä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼Œåˆ›å»ºè¿›ç¨‹å¼€é”€æ¯”çº¿ç¨‹è¦å¤§å¾ˆå¤šï¼Œå¦‚æœè¿›ç¨‹ä¹‹é—´æœ‰æ•°æ®äº¤æ¢ä¹Ÿæ¯”çº¿ç¨‹å¤æ‚ï¼Œå¹¶ä¸”çœŸæ­£æ‰§è¡Œè¿˜æ˜¯è¦è½åˆ°cpuä¸Šå»æ‰§è¡Œï¼Œè¿›ç¨‹å¤šäº†ä¹Ÿä¼šé€ æˆæ’é˜Ÿï¼Œç†è®ºä¸Šå’Œåˆ›å»ºå’Œcpuç›¸åŒä¸ªæ•°çš„è¿›ç¨‹æ€§èƒ½æœ€å¥½ã€‚ä¸‹é¢çœ‹çœ‹å¤šè¿›ç¨‹çš„å†™æ³•ã€‚ import os from multiprocessing import Process â€‹ def runnner(hostip) : appIds = [ \"app-{}\".format(i) for i in range(10)] cmd = \"docker restart {}\".format(\" \".join(appIds)) print(cmd) os.system(\"ssh {hostip} {cmd}\".format(hostip=hostip,cmd=cmd)) â€‹ â€‹ hosts = [\"10.0.0.{}\".format(i) for i in range(10)] â€‹ â€‹ for hostip in hosts : process = Process(target=runnner, args=(hostip,)) process.start() å½“ç„¶å¯ä»¥ç”¨è¿›ç¨‹æ± æ§åˆ¶è¿›ç¨‹çš„ä¸ªæ•°ï¼Œå¦‚: import os â€‹ from multiprocessing import Pool â€‹ def runnner(hostip) : appIds = [ \"app-{}\".format(i) for i in range(10)] cmd = \"docker restart {}\".format(\" \".join(appIds)) print(cmd) os.system(\"ssh {hostip} {cmd}\".format(hostip=hostip,cmd=cmd)) â€‹ â€‹ hosts = [\"10.0.0.{}\".format(i) for i in range(10)] â€‹ p = Pool(4) â€‹ for hostip in hosts : p.apply_async(runnner, args=(hostip,)) # å¼‚æ­¥æ‰§è¡Œ p.close() p.join() ","date":"2020-11-16","objectID":"/python/multithread/:4:0","tags":["python","å¤šçº¿ç¨‹","å¤šè¿›ç¨‹"],"title":"pythonä¸­çš„å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ï¼ˆä¸€ï¼‰","uri":"/python/multithread/"},{"categories":null,"content":"å‚è€ƒ https://docs.python.org/2/library/sys.html#sys.setcheckinterval https://mp.weixin.qq.com/s/nrT8iIe73POFTBpCdfXupA ","date":"2020-11-16","objectID":"/python/multithread/:5:0","tags":["python","å¤šçº¿ç¨‹","å¤šè¿›ç¨‹"],"title":"pythonä¸­çš„å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ï¼ˆä¸€ï¼‰","uri":"/python/multithread/"},{"categories":null,"content":"æŠ•ç¨¿åˆ° servicemesh ç¤¾åŒºçš„æ–‡ç« ","date":"2020-11-10","objectID":"/elk/","tags":["kubernetes","istio"],"title":"istioä¸­çš„ELKå®è·µ","uri":"/elk/"},{"categories":null,"content":"ELK è¿™ç¯‡æ–‡æ¡£æ˜¯ç”±æˆ‘æŠ•ç¨¿çš„äº‘åŸç”Ÿç¤¾åŒºçš„æ–‡ç« ï¼ŒèŠ‚é€‰è‡ª istio-handbookï¼Œå¦‚æœæœ‰å…´è¶£å¯ä»¥å‚è€ƒè¿™æœ¬ä¹¦ã€‚ ELK æŒ‡çš„æ˜¯ç”± Elasticsearch + Logstash + Kibana ç»„æˆçš„æ—¥å¿—é‡‡é›†ã€å­˜å‚¨ã€å±•ç¤ºä¸ºä¸€ä½“çš„æ—¥å¿—è§£å†³æ–¹æ¡ˆï¼Œç®€ç§° â€œELK Stackâ€ã€‚ELK Stack è¿˜åŒ…å« Beatsï¼ˆå¦‚Filebeatã€Metricbeatã€Heartbeatç­‰ï¼‰ã€Kafkaç­‰æˆå‘˜ï¼Œæ˜¯ç›®å‰ä¸»æµçš„ä¸€ç§æ—¥å¿—è§£å†³æ–¹æ¡ˆã€‚ Elasticsearch æ˜¯ä¸ªå¼€æºåˆ†å¸ƒå¼æœç´¢å¼•æ“ï¼Œæä¾›æœé›†ã€åˆ†æã€å­˜å‚¨æ•°æ®ä¸‰å¤§åŠŸèƒ½ã€‚ Logstash æ˜¯å…è´¹ä¸”å¼€æ”¾çš„æœåŠ¡å™¨ç«¯æ•°æ®å¤„ç†ç®¡é“ï¼Œèƒ½å¤Ÿä»å¤šä¸ªæ¥æºé‡‡é›†æ•°æ®ï¼Œè½¬æ¢æ•°æ®ï¼Œç„¶åå°†æ•°æ®å‘é€åˆ°æ‚¨æœ€å–œæ¬¢çš„â€œå­˜å‚¨åº“â€ä¸­ã€‚Logstash æ¯”è¾ƒè€—èµ„æºï¼Œåœ¨å®è·µä¸­æˆ‘ä»¬ä¸€èˆ¬ç”¨ä½œå®æ—¶è§£æå’Œè½¬æ¢æ•°æ®ã€‚Logstash é‡‡ç”¨å¯æ’æ‹”æ¡†æ¶ï¼Œæ‹¥æœ‰ 200 å¤šä¸ªæ’ä»¶ã€‚æ‚¨å¯ä»¥å°†ä¸åŒçš„è¾“å…¥é€‰æ‹©ã€è¿‡æ»¤å™¨å’Œè¾“å‡ºé€‰æ‹©æ··åˆæ­é…ã€ç²¾å¿ƒå®‰æ’ï¼Œè®©å®ƒä»¬åœ¨ç®¡é“ä¸­å’Œè°åœ°è¿è¡Œã€‚ Kibana æ˜¯ä¸€ä¸ªå¼€æºå’Œå…è´¹çš„å·¥å…·ï¼ŒKibanaå¯ä»¥ä¸º Logstash å’Œ ElasticSearch æä¾›çš„æ—¥å¿—åˆ†æå‹å¥½çš„ Web ç•Œé¢ï¼Œå¯ä»¥å¸®åŠ©æ±‡æ€»ã€åˆ†æå’Œæœç´¢é‡è¦æ•°æ®æ—¥å¿—ã€‚ Kafka æ˜¯ç”± Apache è½¯ä»¶åŸºé‡‘ä¼šå¼€å‘çš„ä¸€ä¸ªå¼€æºæµå¤„ç†å¹³å°ï¼Œç”± Scala å’Œ Java ç¼–å†™ã€‚ç”¨æ¥åšç¼“å†²ï¼Œå½“æ—¥å¿—é‡æ¯”è¾ƒå¤§çš„æ—¶å€™å¯ä»¥ç¼“è§£åç«¯ Elasticsearch çš„å‹åŠ›ã€‚ Beats æ˜¯æ•°æ®é‡‡é›†çš„å¾—åŠ›å·¥å…·ã€‚Beatså®¶æ—æˆå‘˜åŒ…æ‹¬å¦‚ä¸‹ï¼š Filebeatï¼šç”¨äºæ—¥å¿—æ–‡ä»¶é‡‡é›†ï¼Œå†…ç½®äº†å¤šç§æ¨¡å—ï¼ˆApacheã€Cisco ASAã€Microsoft Azureã€NGINXã€MySQL ç­‰ç­‰ï¼‰ã€‚ Metricbeatï¼š ç”¨äºæŒ‡æ ‡é‡‡é›†ã€‚ Packetbeatï¼šç”¨äºç½‘ç»œæ•°æ®é‡‡é›†ã€‚ Winlogbeatï¼šç”¨äºWindows äº‹ä»¶é‡‡é›†ã€‚ Auditbeatï¼šç”¨äºå®¡è®¡æ—¥å¿—é‡‡é›†ã€‚ Heartbeatï¼šç”¨äºè¿è¡Œæ—¶é—´é‡‡é›†ã€‚ å…¶ä¸­ Filebeat è¢«ç»å¸¸ç”¨æ¥æ”¶é›† Node æˆ–è€… Pod ä¸­çš„æ—¥å¿—ã€‚ Beats ç”¨äºæ”¶é›†å®¢æˆ·ç«¯çš„æ—¥å¿—ï¼Œå‘é€ç»™ç¼“å­˜é˜Ÿåˆ—å¦‚Kafkaï¼Œç›®çš„æ˜¯ä¸ºäº†è§£è€¦æ•°æ®æ”¶é›†ä¸è§£æå…¥åº“çš„è¿‡ç¨‹ï¼ŒåŒæ—¶æé«˜äº†å¯æ‰©å±•æ€§ï¼Œä½¿æ—¥å¿—ç³»ç»Ÿæœ‰å³°å€¼å¤„ç†èƒ½åŠ›ï¼Œä¸ä¼šå› ä¸ºçªå‘çš„è®¿é—®å‹åŠ›é€ æˆæ—¥å¿—ç³»ç»Ÿå¥”æºƒã€‚ç¼“å­˜é˜Ÿåˆ—å¯é€‰çš„è¿˜æœ‰ Redisï¼Œç”±äº Redis æ˜¯å†…å­˜å‹ï¼Œå¾ˆå®¹æ˜“å†™æ»¡ï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®ç”¨ kafkaã€‚Logstash ä» ç¼“å­˜é˜Ÿåˆ—ä¸­æ¶ˆè´¹æ—¥å¿—è§£æå¤„ç†ä¹‹åå†™åˆ° Elasticsearchï¼Œé€šè¿‡ Kibana å±•ç¤ºç»™æœ€ç»ˆç”¨æˆ·ã€‚ ","date":"2020-11-10","objectID":"/elk/:0:0","tags":["kubernetes","istio"],"title":"istioä¸­çš„ELKå®è·µ","uri":"/elk/"},{"categories":null,"content":"é‡‡é›†æ–¹æ¡ˆ Filebeat æœ‰ä¸¤ç§éƒ¨ç½²æ¨¡å¼ï¼Œä¸€æ˜¯é€šè¿‡ DaemonSet æ–¹å¼éƒ¨ç½²ï¼ŒäºŒæ˜¯é€šè¿‡ Sidecar æ–¹å¼éƒ¨ç½²ï¼ŒFilebeat é‡‡é›†åå‘é€åˆ° Kafka ï¼Œå†ç”± Logstash ä» Kafka ä¸­æ¶ˆè´¹å†™åˆ° Elasticsearchã€‚ ","date":"2020-11-10","objectID":"/elk/:1:0","tags":["kubernetes","istio"],"title":"istioä¸­çš„ELKå®è·µ","uri":"/elk/"},{"categories":null,"content":"DaemonSet æ–¹å¼éƒ¨ç½² å¼€å¯ Envoy çš„è®¿é—®æ—¥å¿—è¾“å‡ºåˆ° stdout ï¼Œä»¥ DaemonSet çš„æ–¹å¼åœ¨æ¯ä¸€å°é›†ç¾¤èŠ‚ç‚¹éƒ¨ç½² Filebeat ï¼Œå¹¶å°†æ—¥å¿—ç›®å½•æŒ‚è½½è‡³ Filebeat Podï¼Œå®ç°å¯¹ Envoy è®¿é—®æ—¥å¿—çš„é‡‡é›†ã€‚ ","date":"2020-11-10","objectID":"/elk/:1:1","tags":["kubernetes","istio"],"title":"istioä¸­çš„ELKå®è·µ","uri":"/elk/"},{"categories":null,"content":"Sidecar æ–¹å¼éƒ¨ç½² Filebeat å’Œ Envoy éƒ¨ç½²åœ¨åŒä¸€ä¸ª Pod å†…ï¼Œå…±äº«æ—¥å¿—æ•°æ®å·ï¼Œ Envoy å†™ï¼ŒFilebeat è¯»ï¼Œå®ç°å¯¹ Envoy è®¿é—®æ—¥å¿—çš„é‡‡é›†ã€‚ ","date":"2020-11-10","objectID":"/elk/:1:2","tags":["kubernetes","istio"],"title":"istioä¸­çš„ELKå®è·µ","uri":"/elk/"},{"categories":null,"content":"éƒ¨ç½² ELK æœ‰äº†ä»¥ä¸Šçš„åŸºç¡€ï¼Œæˆ‘ä»¬å¼€å§‹éƒ¨ç½² ELK Stack ","date":"2020-11-10","objectID":"/elk/:2:0","tags":["kubernetes","istio"],"title":"istioä¸­çš„ELKå®è·µ","uri":"/elk/"},{"categories":null,"content":"éƒ¨ç½² Kafka é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ namespace ç”¨äºéƒ¨ç½² ELK Stackï¼š # Logging Namespace. All below are a part of this namespace. apiVersion: v1 kind: Namespace metadata: name: logging æ¥ä¸‹æ¥ï¼Œéƒ¨ç½² Kafka æœåŠ¡ã€‚ Kafka é€šè¿‡ Zookeeper ç®¡ç†é›†ç¾¤é…ç½®ï¼Œæ‰€ä»¥åœ¨éƒ¨ç½² Kafka éœ€è¦å…ˆéƒ¨ç½² Zookeeperã€‚ Zookeeper æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„ï¼Œå¼€æ”¾æºç çš„åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºåè°ƒæœåŠ¡ã€‚ Kafka ä¸ Zookeeper éƒ½æ˜¯æœ‰çŠ¶æ€æœåŠ¡ï¼Œéƒ¨ç½²æ—¶éœ€è¦é€‰æ‹© StatefulSet ã€‚ éƒ¨ç½² Zookeeper Service apiVersion:v1kind:Servicemetadata:name:zookeeper-clusternamespace:loggingspec:selector:app:zookeeper-clusterports:- name:httpport:2181targetPort:2181type:ClusterIP Zookeeper åœ¨é›†ç¾¤å†…ä½¿ç”¨ï¼Œä¾› Kafka ä½¿ç”¨ï¼Œåˆ›å»ºç±»å‹ä¸º ClusterIP çš„ Service ã€‚ Zookeeper çš„é»˜è®¤ç«¯å£æ˜¯2181ã€‚ éƒ¨ç½² Zookeeper ConfigMap apiVersion:v1kind:ConfigMapmetadata:name:zookeeper-confignamespace:loggingdata:ZOO_CONF_DIR:/confZOO_PORT:\"2181\" Zookeeper é…ç½®æ–‡ä»¶ä¸­çš„ key éƒ½å¯ä»¥ ä»¥ ZOO_ åŠ å¤§å†™çš„æ–¹å¼è®¾ç½®åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼Œä½¿ä¹‹ç”Ÿæ•ˆã€‚ è¿™é‡Œä»…åˆ—ä¸¾éƒ¨åˆ†é…ç½®ã€‚ éƒ¨ç½² Zookeeper StatefulSet apiVersion:apps/v1kind:StatefulSetmetadata:name:zookeepernamespace:loggingspec:serviceName:zookeeper-clusterreplicas:1updateStrategy:type:RollingUpdateselector:matchLabels:app:zookeeper-clustertemplate:metadata:labels:app:zookeeper-clusterannotations:sidecar.istio.io/inject:\"false\"spec:containers:- name:zookeeperresources:requests:cpu:10mmemory:100Milimits:memory:200Miimage:zookeeperimagePullPolicy:IfNotPresentenvFrom:- configMapRef:name:zookeeper-configreadinessProbe:tcpSocket:port:2181initialDelaySeconds:5periodSeconds:10livenessProbe:tcpSocket:port:2181initialDelaySeconds:15periodSeconds:20ports:- containerPort:2181name:zk-client sidecar.istio.io/inject=false æ ‡è¯†æ­¤æœåŠ¡æ— éœ€ sidecar æ³¨å…¥ã€‚ éƒ¨ç½² Kafka Service apiVersion:v1kind:Servicemetadata:name:bootstrap-kafkanamespace:loggingspec:clusterIP:Noneports:- port:9092selector:app:kafka---apiVersion:v1kind:Servicemetadata:name:kafka-clusternamespace:loggingspec:ports:- name:httptargetPort:9092port:9092selector:app:kafkatype:ClusterIP éƒ¨ç½²ä¸¤ä¸ª Service ã€‚ bootstrap-kafka ä¸ºåç»­éƒ¨ç½² Kafka Statefulset ä½¿ç”¨ã€‚ kafka-cluster ä¸º Kafka çš„è®¿é—®å…¥å£ï¼Œåœ¨ç”Ÿäº§ä¸­ä½¿ç”¨å¯ä»¥ç”¨å…¶ä»–çš„ Service ç±»å‹ã€‚ kafka çš„é»˜è®¤ç«¯å£æ˜¯9092 éƒ¨ç½² Kafka ConfigMap apiVersion:v1kind:ConfigMapmetadata:name:kafka-confignamespace:loggingdata:KAFKA_ADVERTISED_LISTENERS:\"PLAINTEXT://kafka-cluster:9092\"KAFKA_LISTENERS:\"PLAINTEXT://0.0.0.0:9092\"KAFKA_ZOOKEEPER_CONNECT:\"zookeeper-cluster:2181\"KAFKA_LOG_RETENTION_HOURS:\"48\"KAFKA_NUM_PARTITIONS:\"30\" Kafka é…ç½®æ–‡ä»¶ï¼ˆserver.propertiesï¼‰ä¸­çš„ key éƒ½å¯ä»¥ ä»¥ KAFKA_ åŠ å¤§å†™çš„æ–¹å¼è®¾ç½®åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼Œä½¿ä¹‹ç”Ÿæ•ˆã€‚ KAFKA_ADVERTISED_LISTENERS ä¸º Kafka ç›‘å¬çš„æœåŠ¡åœ°å€ã€‚ KAFKA_ZOOKEEPER_CONNECT ä¸ºå‰é¢éƒ¨ç½²çš„ Zookeeper çš„æœåŠ¡åœ°å€ã€‚ KAFKA_LOG_RETENTION_HOURS ä¸º Kafka æ•°æ®ä¿ç•™çš„æ—¶é—´ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´å°†ä¼šè¢«æ¸…ç†ï¼Œå¯ä»¥æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œè°ƒæ•´ã€‚ KAFKA_NUM_PARTITIONS ä¸ºåˆ›å»º Kafka topic æ—¶çš„é»˜è®¤åˆ†ç‰‡æ•°ï¼Œè®¾ç½®å¤§ä¸€äº›å¯ä»¥å¢åŠ  Kafka çš„ååé‡ã€‚ è¿™é‡Œä»…åˆ—ä¸¾éƒ¨åˆ†é…ç½®ã€‚ éƒ¨ç½² Kafka StatefulSet apiVersion:apps/v1kind:StatefulSetmetadata:name:kafkanamespace:loggingspec:selector:matchLabels:app:kafkaserviceName:bootstrap-kafkareplicas:1template:metadata:labels:app:kafkaannotations:sidecar.istio.io/inject:\"false\"spec:containers:- name:kafka-brokerimage:russellgao/kafka:2.12-2.0.1ports:- name:insidecontainerPort:9092resources:requests:cpu:0.1memory:1024Milimits:memory:3069MireadinessProbe:tcpSocket:port:9092timeoutSeconds:1initialDelaySeconds:5periodSeconds:10livenessProbe:tcpSocket:port:9092timeoutSeconds:1initialDelaySeconds:15periodSeconds:20envFrom:- configMapRef:name:kafka-config kafka å¯¹ç£ç›˜çš„ IO è¦æ±‚è¾ƒé«˜ï¼Œå¯ä»¥é€‰æ‹©å›ºæ€ç¡¬ç›˜æˆ–è€…ç»è¿‡IOä¼˜åŒ–çš„ç£ç›˜ï¼Œå¦åˆ™å¯èƒ½ä¼šæˆä¸ºæ—¥å¿—ç³»ç»Ÿçš„ç“¶é¢ˆã€‚ è¯·æ³¨æ„ï¼Œæœ¬æ¬¡å®è·µæ²¡æœ‰æŠŠæ•°æ®å·æ˜ å°„å‡ºæ¥ï¼Œåœ¨ç”Ÿäº§å®è·µä¸­ä½¿ç”¨ volumeClaimTemplates æ¥ä¸º Pod æä¾›æŒä¹…åŒ–å­˜å‚¨ã€‚resources å¯ä»¥æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´ã€‚ ","date":"2020-11-10","objectID":"/elk/:2:1","tags":["kubernetes","istio"],"title":"istioä¸­çš„ELKå®è·µ","uri":"/elk/"},{"categories":null,"content":"éƒ¨ç½² Logstash Logstash æ˜¯ä¸€ä¸ªæ— çŠ¶æ€æœåŠ¡ï¼Œé€šè¿‡ Deployment è¿›è¡Œéƒ¨ç½²ã€‚ éƒ¨ç½² Logstash ConfigMap apiVersion:v1kind:ConfigMapmetadata:name:logstash-confnamespace:loggingdata:logstash.conf:| input {http{host=\u003e\"0.0.0.0\"# default: 0.0.0.0port =\u003e 8080 # default:8080user=\u003e\"logstash\"password=\u003e\"aoDJ0JVgkfNPjarn\"response_headers=\u003e{\"Content-Type\"=\u003e\"text/plain\"\"Access-Control-Allow-Origin\"=\u003e\"*\"\"Access-Control-Allow-Methods\"=\u003e\"GET, POST, DELETE, PUT\"\"Access-Control-Allow-Headers\"=\u003e\"authorization, content-type\"\"Access-Control-Allow-Credentials\"=\u003etrue}}kafka{topics=\u003e\"istio\"bootstrap_servers=\u003e\"kafka-cluster:9092\"auto_offset_reset=\u003e\"earliest\"group_id=\u003e\"istio_kafka_gr\"consumer_threads=\u003e3codec=\u003e\"json\"}}filter{grok{match=\u003e{\"message\"=\u003e\"(?m)\\[%{TIMESTAMP_ISO8601:timestamp}\\] \"%{NOTSPACE:method}%{NOTSPACE:path}%{NOTSPACE:protocol}\" %{NUMBER:response_code:int} %{NOTSPACE:response_flags} \"%{NOTSPACE:istio_policy_status}\" \"%{NOTSPACE:upstream_transport_failure_reason}\" %{NUMBER:bytes_received:int} %{NUMBER:bytes_sent:int} %{NUMBER:duration:int} %{NUMBER:upstream_service_time:int} \"%{NOTSPACE:x_forwarded_for}\" \"%{NOTSPACE:user_agent}\" \"%{NOTSPACE:request_id}\" \"%{NOTSPACE:authority}\" \"%{NOTSPACE:upstream_host}\" %{NOTSPACE:upstream_cluster} %{NOTSPACE:upstream_local_address} %{NOTSPACE:downstream_local_address} %{NOTSPACE:downstream_remote_address} %{NOTSPACE:requested_server_name} %{NOTSPACE:route_name}\"}remove_field=\u003e[\"message\"]}date{match=\u003e[\"timestamp\",\"yyyy-MM-ddTHH:mm:ss.SSSZ\"]timezone=\u003e\"Asia/Shanghai\"}ruby{code=\u003e\"event.set('[@metadata][index_day]',(event.get('@timestamp').time.localtime + 8*60*60 ).strftime('%Y.%m.%d'))\"}}output{if\"_grokparsefailure\"notin[tags]{elasticsearch{user=\u003e\"elastic\"password=\u003e\"elastic\"hosts=\u003e[\"elasticsearch.com:9200\"]index=\u003e\"istio-%{[@metadata][index_day]}\"}}} Logstash é…ç½®ç”±3éƒ¨åˆ†ç»„æˆï¼š input Logstash input æ”¯æŒéå¸¸å¤šçš„æ•°æ®æºï¼Œå¦‚ Fileã€Elasticsearchã€Beatsã€Redisã€Kafkaã€Httpç­‰ã€‚ Http input ç”¨äºLogstash çš„å¥åº·æ£€æŸ¥ï¼Œä¹Ÿå¯é€šè¿‡ http æ¥å£å°†æ—¥å¿—ç›´æ¥å‘é€åˆ° Logstashï¼Œä¸»è¦ç”¨äºç§»åŠ¨ç«¯çš„åœºæ™¯ã€‚ Kafka input ç”¨äºæ”¶é›†æ—¥å¿—ï¼Œä¸€ä¸ªinputåªèƒ½ä»ä¸€ä¸ª Topic ä¸­è¯»å–æ•°æ®ï¼Œéœ€è¦å’Œåç»­çš„ Filebeat output å¯¹åº”ã€‚ filter Logstash filter æ”¯æŒéå¸¸å¤šçš„æ’ä»¶ï¼Œå¯ä»¥å¯¹æ•°æ®è¿›è¡Œè§£æã€åŠ å·¥ã€è½¬æ¢ï¼Œå¦‚ grokã€dateã€rubyã€jsonã€dropç­‰ã€‚ grok ç”¨äºå¯¹æ—¥å¿—è¿›è¡Œè§£æã€‚ date ç”¨äºæŠŠ timestamp è½¬åŒ–æˆ elasticsearch ä¸­çš„ @timestamp å­—æ®µï¼Œå¯ä»¥æŒ‡å®šæ—¶åŒºã€‚ ruby æ’ä»¶æ”¯æŒæ‰§è¡Œ ruby ä»£ç ï¼Œå¯ä»¥è¿›è¡Œå¤æ‚é€»è¾‘çš„å¤„ç†ï¼Œæ­¤å¤„çš„ç”¨æ³•æ˜¯ @timestamp å­—æ®µçš„æ—¶é—´åŠ 8å°æ—¶ï¼Œè§£å†³è‡ªåŠ¨ç”Ÿæˆçš„ç´¢å¼•æ—¶å·®é—®é¢˜ã€‚ output Logstash output æ”¯æŒéå¸¸å¤šçš„æ•°æ®æºï¼Œå¦‚ elasticsearchã€cvsã€jdbc ç­‰ã€‚ æ­¤å¤„æ˜¯æŠŠ grok è§£ææˆåŠŸçš„æ—¥å¿—å†™åˆ° elasticsearch ã€‚ éƒ¨ç½² Logstash Deployment apiVersion:apps/v1beta2kind:Deploymentmetadata:name:logstashnamespace:loggingspec:replicas:2selector:matchLabels:app:logstashtemplate:metadata:labels:app:logstashannotations:sidecar.istio.io/inject:\"false\"spec:volumes:- name:configconfigMap:name:logstash-confhostname:logstashcontainers:- name:logstashimage:logstash:7.2.0args:[\"-f\",\"/usr/share/logstash/pipeline/logstash.conf\",]imagePullPolicy:IfNotPresentvolumeMounts:- name:configmountPath:\"/usr/share/logstash/pipeline/logstash.conf\"readOnly:truesubPath:logstash.confresources:requests:cpu:0.5memory:1024Milimits:cpu:1.5memory:3072MireadinessProbe:tcpSocket:port:8080initialDelaySeconds:5periodSeconds:10livenessProbe:tcpSocket:port:8080initialDelaySeconds:15periodSeconds:20 Logstash ä¸éœ€è¦å¯¹å¤–å‘å¸ƒæœåŠ¡ï¼Œå³ä¸éœ€è¦åˆ›å»º Serviceï¼Œä» Kafka ä¸­æ¶ˆè´¹æ—¥å¿—ï¼Œå¤„ç†å®Œæˆä¹‹åå†™åˆ° Elasticsearch ã€‚ Logstash åªéœ€è¦æŠŠé…ç½®æ–‡ä»¶æŒ‚è½½è¿›å»ï¼Œæ— éœ€æŒ‚è½½å…¶ä»–ç›®å½•ï¼Œæ’æŸ¥é”™è¯¯æ—¶å¯é€šè¿‡ Logstash Console Log è¿›è¡ŒæŸ¥çœ‹ã€‚ éƒ¨ç½² Logstash HorizontalPodAutoscaler apiVersion:autoscaling/v2beta1kind:HorizontalPodAutoscalermetadata:name:logstashnamespace:loggingspec:scaleTargetRef:apiVersion:apps/v1beta2kind:Deploymentname:logstashminReplicas:2maxReplicas:10metrics:- type:Resourceresource:name:cputargetAverageUtilization:80 Logstash æ¯”è¾ƒæ¶ˆè´¹ CPU ï¼Œå¯ä»¥éƒ¨ç½² HPAï¼Œå¯ä»¥æ ¹æ®æ—¥å¿—é‡åŠ¨æ€çš„æ‰©æ‰€å®¹ã€‚ Logstash çš„å‹åŠ›å¯¹ CPU æ¯”è¾ƒæ•æ„Ÿï¼Œå¯ä»¥åªæ ¹æ® CPU è¿™ä¸€ä¸ªæŒ‡æ ‡è¿›è¡Œ HPAã€‚ Logstash çš„é…ç½®æ–‡ä»¶æ”¯æŒif/elseæ¡ä»¶åˆ¤æ–­ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ï¼Œä¸€ä¸ª Logstash é›†ç¾¤å¯ä»¥æ”¯æŒæ¯”è¾ƒå¤šçš„æ—¥å¿—æ ¼å¼ã€‚å¦å¤– Logstash çš„ grok è¯­æ³•ç›¸å¯¹å¤æ‚ï¼Œå¯ä»¥ä½¿ç”¨ Kibana Dev Tools å·¥å…·è¿›è¡Œè°ƒè¯•ï¼Œå¦‚ä¸‹å›¾ï¼š ","date":"2020-11-10","objectID":"/elk/:2:2","tags":["kubernetes","istio"],"title":"istioä¸­çš„ELKå®è·µ","uri":"/elk/"},{"categories":null,"content":"éƒ¨ç½² Filebeat è¿™é‡Œä»…ç»™å‡º Filebeat DaemonSet çš„éƒ¨ç½²è¿‡ç¨‹ã€‚ éƒ¨ç½² Filebeat ConfigMap apiVersion:v1kind:ConfigMapmetadata:name:filebeat-confnamespace:loggingdata:filebeat.yml:| filebeat:inputs:- paths:- /var/log- /var/lib/docker/containersignore_older:1hforce_close_files:true#å¼ºåˆ¶filebeatåœ¨æ–‡ä»¶åæ”¹å˜æ—¶ï¼Œå…³é—­æ–‡ä»¶ï¼Œä¼šæœ‰ä¸¢å¤±æ—¥å¿—çš„é£é™©close_older:1mfields_under_root:trueoutput:kafka:enabled:truehosts:[\"kafka-cluster:9092\"]topic:\"istio\"version:\"2.0.0\"partition.round_robin:reachable_only:falseworker:2max_retries:3bulk_max_size:2048timeout:30sbroker_timeout:10schannel_buffer_size:256keep_alive:60compression:gzipmax_message_bytes:1000000required_acks:1 input.paths ä»£è¡¨ Filebeat ç›‘å¬çš„æ—¥å¿—è·¯å¾„ã€‚ input.ignore_older ä»£è¡¨æ—¥å¿—æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´è¶…è¿‡è¿™ä¸ªä¹‹é—´ï¼Œå°†ä¼šå¿½ç•¥ï¼Œè¿™ä¸ªåœ¨ Filebeat é‡å¯æ—¶å¾ˆæœ‰æ•ˆæœï¼Œè§£å†³é‡å¤è¯»å–æ—¥å¿—çš„é—®é¢˜ã€‚ out.kafka.hosts å’Œä¹‹å‰éƒ¨ç½²çš„ Kafka Service å¯¹åº”ã€‚ out.kafka.topic å’Œä¹‹å‰éƒ¨ç½²çš„ Logstash ConfigMap ä¸­çš„ input å¯¹åº”ã€‚ éƒ¨ç½² Filebeat DaemonSet apiVersion:apps/v1kind:DaemonSetmetadata:name:filebeatnamespace:logginglabels:app:filebeatspec:selector:matchLabels:app:filebeattemplate:metadata:labels:app:filebeatannotations:sidecar.istio.io/inject:\"false\"spec:containers:- name:filebeatimage:elastic/filebeat:7.2.0imagePullPolicy:IfNotPresentvolumeMounts:- name:configmountPath:\"/usr/share/filebeat/filebeat.yml\"readOnly:truesubPath:filebeat.yml- name:varlogmountPath:/var/log- name:varlibdockercontainersmountPath:/var/lib/docker/containersresources:requests:cpu:0.1memory:200Milimits:cpu:0.3memory:600Mivolumes:- name:varloghostPath:path:/var/log- name:varlibdockercontainershostPath:path:/var/lib/docker/containers- name:configconfigMap:name:filebeat-conf è¿™é‡Œå£°æ˜äº†ä¸¤ä¸ª hostPath ç±»å‹çš„æ•°æ®å·ï¼Œè·¯å¾„ä¸ºæ—¥å¿—å­˜å‚¨çš„è·¯å¾„ã€‚ å°†å®¿ä¸»æœºçš„ /var/log å’Œ /var/lib/docker/containers æŒ‚è½½åˆ°äº† Filebeat Pod å†…ä¾¿äº Filebeat æ”¶é›†æ—¥å¿—ã€‚ Filebeat ä¸éœ€è¦éƒ¨ç½² Service ã€‚ Filebeat å¯¹èµ„æºæ¶ˆè€—æ¯”è¾ƒå°‘ï¼Œå¯å¿½ç•¥å¯¹ Node çš„èµ„æºæ¶ˆè€—ã€‚ ","date":"2020-11-10","objectID":"/elk/:2:3","tags":["kubernetes","istio"],"title":"istioä¸­çš„ELKå®è·µ","uri":"/elk/"},{"categories":null,"content":"å°ç»“ æœ¬èŠ‚ä¸ºå¤§å®¶ä»‹ç»äº† ELK çš„åŸç†å’Œå®‰è£…éƒ¨ç½²ï¼Œä»¥åŠå¦‚ä½•æ”¶é›†æ—¥å¿—ã€‚ ","date":"2020-11-10","objectID":"/elk/:3:0","tags":["kubernetes","istio"],"title":"istioä¸­çš„ELKå®è·µ","uri":"/elk/"},{"categories":null,"content":"å‚è€ƒ Beats Logstash Zookeeper ","date":"2020-11-10","objectID":"/elk/:4:0","tags":["kubernetes","istio"],"title":"istioä¸­çš„ELKå®è·µ","uri":"/elk/"},{"categories":null,"content":"Hugo, the world's fastest framework for building websites","date":"2020-11-08","objectID":"/about/","tags":null,"title":"å…³äºæˆ‘","uri":"/about/"},{"categories":null,"content":"ç®€ä»‹ é«˜ç»´å®—ï¼ˆrussellgaoï¼‰ï¼Œç°å°±èŒäºä¸Šæµ·æµ·é¼ä¿¡æ¯å·¥ç¨‹è‚¡ä»½æœ‰é™å…¬å¸ï¼Œæ‹…ä»»è¿ç»´å¼€å‘ç»ç†ã€‚ ","date":"2020-11-08","objectID":"/about/:1:0","tags":null,"title":"å…³äºæˆ‘","uri":"/about/"},{"categories":null,"content":"å…³æ³¨é¢†åŸŸ ä¸“æ³¨äºdevopsï¼Œaiopsï¼Œgolongï¼Œpythonï¼Œkubernetesï¼Œservicemeshï¼Œäº‘åŸç”Ÿï¼Œç®—æ³•ç­‰é¢†åŸŸï¼Œçƒ­è¡·äºå‚ä¸å¼€æºè½¯ä»¶å’Œå¼€æºç¤¾åŒºã€‚ ","date":"2020-11-08","objectID":"/about/:2:0","tags":null,"title":"å…³äºæˆ‘","uri":"/about/"},{"categories":null,"content":"ä¸ªäººå…¬ä¼—å· ","date":"2020-11-08","objectID":"/about/:3:0","tags":null,"title":"å…³äºæˆ‘","uri":"/about/"},{"categories":null,"content":"æŠ•ç¨¿ å¦‚æœæœ‰å¥½çš„æ–‡ç« éœ€è¦åˆ†äº«ä¹Ÿå¯ä»¥æŠ•ç¨¿ç»™ä½œè€…å“Ÿï¼ ","date":"2020-11-08","objectID":"/about/:4:0","tags":null,"title":"å…³äºæˆ‘","uri":"/about/"},{"categories":null,"content":"æŠ•ç¨¿æŒ‡å— æ–‡ç« é¡»ä¸ºåŸåˆ›çš„æŠ€æœ¯æ–‡ç«  é¡»åŒ…å«ä½œè€…çš„å§“åï¼Œå…¬å¸å¤´è¡”å’Œç®€è¦ä»‹ç» é¡»é€šè¿‡åœ¨ github æäº¤ PR çš„æ–¹å¼æä¾› ","date":"2020-11-08","objectID":"/about/:4:1","tags":null,"title":"å…³äºæˆ‘","uri":"/about/"},{"categories":null,"content":"åŸåˆ›ç”³æ˜ æœ¬åšå®¢ä¸Šçš„æ‰€æœ‰æ–‡æ¡£å‡ä¸ºåŸåˆ›ï¼Œåœ¨å†™å…¥è¿‡ç¨‹ä¸­ä¸å…å‚è€ƒå…¶ä»–äººä¼˜ç§€çš„æ–‡ç« ï¼Œä¸€èˆ¬éƒ½ä¼šåœ¨æ–‡æœ«ç”³æ˜å‚è€ƒçš„æ–‡ç« ï¼Œå¦‚æœ‰ä¾µçŠ¯åˆ°æ‚¨çš„æƒç›Šè¯·è”ç³»ä½œè€…ç¬¬ä¸€æ—¶é—´ä¿®æ”¹ã€‚ ","date":"2020-11-08","objectID":"/about/:5:0","tags":null,"title":"å…³äºæˆ‘","uri":"/about/"},{"categories":null,"content":"è½¬è½½è¯´æ˜ å¦‚éœ€è½¬è½½ï¼Œè¯·åŠ æ³¨åŸæ–‡å‡ºå¤„ã€‚ ","date":"2020-11-08","objectID":"/about/:6:0","tags":null,"title":"å…³äºæˆ‘","uri":"/about/"},{"categories":null,"content":"Hugo, the world's fastest framework for building websites","date":"2020-11-08","objectID":"/golang/defer/","tags":["golang","defer"],"title":"ç»†è°ˆ Golang ä¸­é‚£äº›è®¾è®¡ä¼˜ç¾çš„ç»†èŠ‚-defer","uri":"/golang/defer/"},{"categories":null,"content":"èƒŒæ™¯ åœ¨å­¦ä¹ å’Œä½¿ç”¨ Go çš„è¿‡ç¨‹ä¸­å‘ç°ï¼ŒGo åœ¨è¯­è¨€å±‚é¢çš„è®¾è®¡æœ‰å¾ˆå¤šæœ‰è¶£çš„åœ°æ–¹ï¼Œæ‰€ä»¥å‡†å¤‡ç”¨ä¸€ä¸ªç³»åˆ—æ¥ç»†æ•°è¿™äº›æœ‰è¶£çš„åœ°æ–¹ã€‚å†™è¿™ä¸ªç³»åˆ—ä¸€æ˜¯ä¸ºäº†åŠ æ·±è‡ªå·±çš„ç†è§£ï¼ŒäºŒæ˜¯æ„¿æ„åˆ†äº«ï¼Œåˆ†äº« Go ä¸­æœ‰è¶£çš„è®¾è®¡ç»†èŠ‚ã€‚æ¯ç¯‡éƒ½ä¼šé€šè¿‡ä¸€ä¸ªä¾‹å­è®²è¿°ä¸€ä¸ªç»†èŠ‚ï¼Œæ„Ÿå…´è¶£çš„è¯å¯ä»¥å…³æ³¨ä¸€ä¸‹å“Ÿï¼ ","date":"2020-11-08","objectID":"/golang/defer/:1:0","tags":["golang","defer"],"title":"ç»†è°ˆ Golang ä¸­é‚£äº›è®¾è®¡ä¼˜ç¾çš„ç»†èŠ‚-defer","uri":"/golang/defer/"},{"categories":null,"content":"Go ä»‹ç» Goï¼ˆåˆç§° Golangï¼‰æ˜¯ Google çš„ Robert Griesemerï¼ŒRob Pike åŠ Ken Thompson å¼€å‘çš„ä¸€ç§é™æ€å¼ºç±»å‹ã€ç¼–è¯‘å‹è¯­è¨€ã€‚Go è¯­è¨€è¯­æ³•ä¸ C ç›¸è¿‘ï¼Œä½†åŠŸèƒ½ä¸Šæœ‰ï¼šå†…å­˜å®‰å…¨ï¼ŒGCï¼ˆåƒåœ¾å›æ”¶ï¼‰ï¼Œç»“æ„å½¢æ€åŠ CSP-style å¹¶å‘è®¡ç®—ã€‚ Go æ˜¯ç”±è¿™3ä½å¤§ä½¬ä»2007å¹´9æœˆå¼€å§‹è®¾è®¡Goï¼Œ2009å¹´æ­£å¼æ¨å‡ºï¼Œåˆ°ç›®å‰ä¸ºæ­¢å·²ç»å‘äº†15ä¸ªå¤§ç‰ˆæœ¬ï¼Œæœ€æ–°ç‰ˆä¸º1.15.4ã€‚Go ç°åœ¨å¹¿æ³›åº”ç”¨äºäº‘åŸç”Ÿã€ä¸­é—´ä»¶ã€è¿˜æœ‰å„ä¸ªä¸šåŠ¡å¹³å°ï¼Œå¦‚ dockerã€kubernetesã€etcdç­‰éƒ½æ˜¯Goè¯­è¨€ç¼–å†™ã€‚æ‰€ä»¥è¿˜æ˜¯å¾ˆæœ‰å¿…è¦äº†è§£ä¸€ä¸‹å“Ÿï¼ ä¸‹é¢ç®€å•è¯´è¯´Goçš„ä¼˜ç¼ºç‚¹ï¼Œä¿—è¯è¯´ï¼šä¸€ä¸‡ä¸ªäººçœ¼ä¸­æœ‰ä¸€ä¸‡ä¸ªå“ˆå§†é›·ç‰¹ï¼Œæ‰€ä»¥ä¼˜ç¼ºç‚¹éƒ½æ˜¯ç›¸å¯¹è€Œè¨€ï¼Œå°±è°ˆè°ˆè‡ªå·±ä½¿ç”¨è¿‡ç¨‹ä¸­çš„æ„Ÿå—ï¼Œå…·ä½“çš„ä¼˜ç¼ºç‚¹ä¼šåœ¨åé¢çš„ç³»åˆ—æ–‡ç« ä¸­ä¸€ä¸€æåˆ°ï¼Œè¿™é‡Œæ˜¯æŠ›ç –å¼•ç‰ã€‚ ","date":"2020-11-08","objectID":"/golang/defer/:2:0","tags":["golang","defer"],"title":"ç»†è°ˆ Golang ä¸­é‚£äº›è®¾è®¡ä¼˜ç¾çš„ç»†èŠ‚-defer","uri":"/golang/defer/"},{"categories":null,"content":"Go ä¼˜ç‚¹ è¯­è¨€å±‚é¢æ”¯æŒå¹¶å‘ï¼šä¸€ä¸ª go å…³é”®å­—å³å¯å®ç°å¹¶å‘ï¼Œå…¶ä»–ç¼–ç¨‹è¯­è¨€ä¾èµ–äºåº“å®ç°å¹¶å‘ï¼Œè¿™æ˜¯æœ‰æœ¬è´¨çš„åŒºåˆ« é«˜æ€§èƒ½ ç¼–è¯‘å®Œä¹‹åç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯å…å»ç¯å¢ƒä¾èµ– defer æœºåˆ¶ å†…ç½®runtime å†…åµŒCæ”¯æŒï¼ŒGoé‡Œé¢ä¹Ÿå¯ä»¥ç›´æ¥åŒ…å«Cä»£ç ï¼Œåˆ©ç”¨ç°æœ‰çš„ä¸°å¯Œçš„Cåº“ è·¨å¹³å°ç¼–è¯‘ ã€‚ã€‚ã€‚ ","date":"2020-11-08","objectID":"/golang/defer/:3:0","tags":["golang","defer"],"title":"ç»†è°ˆ Golang ä¸­é‚£äº›è®¾è®¡ä¼˜ç¾çš„ç»†èŠ‚-defer","uri":"/golang/defer/"},{"categories":null,"content":"Go ç¼ºç‚¹ åŒ…ç®¡ç† ã€‚ã€‚ã€‚ ","date":"2020-11-08","objectID":"/golang/defer/:4:0","tags":["golang","defer"],"title":"ç»†è°ˆ Golang ä¸­é‚£äº›è®¾è®¡ä¼˜ç¾çš„ç»†èŠ‚-defer","uri":"/golang/defer/"},{"categories":null,"content":"defer è¯´èµ· Go è¯­è¨€çš„æœ€å¼ºå¤§çš„åœ°æ–¹ï¼Œä¸å¾—ä¸è¯´ Go çš„å¹¶å‘æœºåˆ¶å’Œè°ƒåº¦åŸç†ï¼Œä½†æ˜¯ä»Šå¤©ä¸è®²è¿™äº›é«˜æ·±çš„ç†è®ºï¼Œå…ˆä»ç®€å•çš„å¼€å§‹ã€‚å…ˆæ€è€ƒè¿™ä¹ˆå‡ ä¸ªé—®é¢˜ï¼ˆå¯ä»¥ç”¨è‡ªå·±ç†Ÿæ‚‰çš„è¯­è¨€æ€è€ƒå¦‚ä½•è§£å†³ï¼‰: å¯¹äºæ–‡ä»¶çš„æ‰“å¼€å…³é—­ï¼Œç½‘ç»œè¿æ¥çš„å»ºç«‹æ–­å¼€åœºæ™¯ï¼Œå½“æ‰“å¼€æ—¶å€™åº”è¯¥ä½•æ—¶å…³é—­? å½“è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå¸Œæœ›åœ¨å‡½æ•°è¿”å›æ—¶ä¿®æ”¹å®ƒçš„å€¼ï¼Œè¯¥å¦‚ä½•è§£å†³? å…ˆçœ‹çœ‹defer çš„å®˜æ–¹å®šä¹‰ ï¼š A â€œdeferâ€ statement invokes a function whose execution is deferred to the moment the surrounding function returns, either because the surrounding function executed a return statement, reached the end of its function body, or because the corresponding goroutine is panicking. æ„æ€æ˜¯è¯´ï¼Œå½“åŒ…è£¹defer çš„å‡½æ•°è¿”å›æ—¶æˆ–è€…åŒ…è£¹deferçš„å‡½æ•°æ‰§è¡Œåˆ°æœ«å°¾æ—¶æˆ–è€…æ‰€åœ¨çš„goroutineå‘ç”Ÿpanicæ—¶æ‰ä¼šæ‰§è¡Œã€‚ æ¢å¥è¯è¯´å°±æ˜¯å½“å‡½æ•°æ‰§è¡Œå®Œä¹‹åæˆ–è€…å‘ç”Ÿå¼‚å¸¸æ—¶å†æ‰§è¡Œdeferè¯­å¥ï¼Œå°±æ˜¯è¯´åœ¨è¢«è°ƒå‡½æ•°è¿”å›ä¹‹åï¼Œèµ‹å€¼ç»™è°ƒç”¨å‡½æ•°ä¹‹å‰ï¼Œè¿˜æœ‰æœºä¼šæ‰§è¡Œå…¶ä»–æŒ‡ä»¤ï¼Œæ˜¯ä¸æ˜¯å¾ˆç¥å¥‡ã€‚å…ˆçœ‹ä¸€æ®µpython ä»£ç  : def f(x,y) : z = x / y z += 1 return z â€‹ if __name__ == \"__main__\" : result = f(4 /2) å½“è°ƒç”¨å‡½æ•°fï¼Œfè¿”å›ç»™zå¹¶ä¸”èµ‹å€¼ç»™resultï¼Œåœ¨è¿™æ—¶é—´ï¼Œæ˜¯æ²¡æœ‰ä»»ä½•æœºä¼šæ‰§è¡Œå…¶ä»–çš„å‡½æ•°ä»£ç çš„ã€‚å†çœ‹ä¸€æ®µgoä»£ç : package main func main() { result := f(4, 2) fmt.Println(result) } â€‹ func f(x, y int) (r int) { r = x / y r += 1 defer func() { r += 2 }() return } å½“è°ƒç”¨å‡½æ•°fï¼Œfè¿”å›ä¹‹åï¼Œåœ¨èµ‹å€¼ä¹‹å‰æ‰§è¡Œäº†r +=2 ã€‚ç°åœ¨å›æƒ³ä¸€ä¸‹ä¹‹å‰çš„ä¸¤ä¸ªé—®é¢˜ï¼Œå¦‚æœæœ‰defer æœºåˆ¶ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥å¾ˆå¥½çš„è§£å†³ã€‚å¦‚å¯¹äºç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨defer è¯­å¥ä¸­å¤„ç†æ–‡ä»¶çš„å…³é—­ï¼Œè¿æ¥çš„é‡Šæ”¾ç­‰ï¼Œè€Œä¸ç”¨è€ƒè™‘ä¸€äº›å¼‚å¸¸æƒ…å†µã€‚ é‚£deferçš„å®ç°åŸç†æ˜¯æ€æ ·çš„å‘¢? defer å…¶å®æ˜¯è°ƒç”¨runtime.deferproc è¿›è¡Œå®ç°ï¼Œåœ¨defer å‡ºç°çš„åœ°æ–¹ï¼Œæ’å…¥äº†call runtime.deferprocï¼Œç„¶ååœ¨å‡½æ•°è¿”å›ä¹‹å‰çš„åœ°æ–¹ï¼Œæ’å…¥æŒ‡ä»¤call runtime.deferreturnã€‚ æ™®é€šå‡½æ•°è¿”å›æ—¶ï¼Œæ±‡ç¼–ä»£ç ç±»ä¼¼äº: add xx SP return å¦‚æœåŒ…å«äº†defer è¯­å¥ï¼Œæ±‡ç¼–ä»£ç ç±»ä¼¼äº: call runtime.deferreturnï¼Œ add xx SP return goroutineçš„æ§åˆ¶ç»“æ„ä¸­ï¼Œæœ‰ä¸€å¼ è¡¨è®°å½•deferï¼Œè°ƒç”¨runtime.deferprocæ—¶ä¼šå°†éœ€è¦deferçš„è¡¨è¾¾å¼è®°å½•åœ¨è¡¨ä¸­ï¼Œè€Œåœ¨è°ƒç”¨runtime.deferreturnçš„æ—¶å€™ï¼Œåˆ™ä¼šä¾æ¬¡ä»deferè¡¨ä¸­å‡ºæ ˆå¹¶æ‰§è¡Œã€‚ defer åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¹Ÿå­˜åœ¨ä¸€äº›å‘ï¼Œçœ‹å‡ ä¸ªä¾‹å­: ä¾‹1: func f() (result int) { defer func() { result++ }() return 10 } ä¾‹2: func f() (result int) { t := 10 defer func() { t = t + 1 }() return t } ä¾‹3: func f() (result int) { defer func(result int) { result = result + 1 }(result) return 10 } å¤§å®¶å¯ä»¥å…ˆå¿ƒé‡Œé»˜é»˜ç®—ä¸€ä¸‹ä»–ä»¬çš„ç»“æœ ç¬¬ä¸€ä¸ªæ˜¯11ï¼Œç¬¬äºŒä¸ªæ˜¯10ï¼Œç¬¬ä¸‰ä¸ªæ˜¯10ã€‚ deferè¡¨è¾¾å¼å¯èƒ½ä¼šåœ¨è®¾ç½®å‡½æ•°è¿”å›å€¼ä¹‹åï¼Œåœ¨è¿”å›åˆ°è°ƒç”¨å‡½æ•°ä¹‹å‰ï¼Œä¿®æ”¹è¿”å›å€¼ï¼Œä½¿æœ€ç»ˆçš„å‡½æ•°è¿”å›å€¼ä¸ä½ æƒ³è±¡çš„ä¸ä¸€è‡´ã€‚å…¶å®ä½¿ç”¨deferæ—¶ï¼Œç”¨ä¸€ä¸ªç®€å•çš„è½¬æ¢è§„åˆ™æ”¹å†™ä¸€ä¸‹ï¼Œå°±ä¸ä¼šè¿·ç³Šäº†ã€‚æ”¹å†™è§„åˆ™æ˜¯å°†returnè¯­å¥æ‹†æˆä¸¤å¥å†™ï¼Œreturn xxxä¼šè¢«æ”¹å†™æˆ: è¿”å›å€¼ = xxx è°ƒç”¨deferå‡½æ•° ç©ºçš„return ä¾‹1 ä¼šè¢«æ”¹å†™æˆ: func f() (result int) { result = 10 // returnè¯­å¥ä¸æ˜¯ä¸€æ¡åŸå­è°ƒç”¨ï¼Œreturn xxxå…¶å®æ˜¯èµ‹å€¼ï¼‹retæŒ‡ä»¤ defer func() { result++ }() return // ç©ºçš„returnæŒ‡ä»¤ } æ‰€ä»¥è¿”å›å€¼æ˜¯11 ä¾‹2 ä¼šè¢«æ”¹å†™æˆ: func f() (result int) { t := 10 result = t // èµ‹å€¼æŒ‡ä»¤ defer func() { t = t + 1 //deferè¢«æ’å…¥åˆ°èµ‹å€¼ä¸è¿”å›ä¹‹é—´æ‰§è¡Œï¼Œè¿™ä¸ªä¾‹å­ä¸­è¿”å›å€¼ resultæ²¡è¢«ä¿®æ”¹è¿‡ }() return // ç©ºçš„returnæŒ‡ä»¤ } æ‰€ä»¥è¿”å›å€¼æ˜¯10 ä¾‹3 å°±ç•™ç»™å¤§å®¶è‡ªå·±æ”¹å†™ä¸€ä¸‹å•¦ï¼Œæœ‰å…´è¶£å¯ä»¥ç§æˆ‘æ²Ÿé€šå“Ÿï¼ ","date":"2020-11-08","objectID":"/golang/defer/:5:0","tags":["golang","defer"],"title":"ç»†è°ˆ Golang ä¸­é‚£äº›è®¾è®¡ä¼˜ç¾çš„ç»†èŠ‚-defer","uri":"/golang/defer/"},{"categories":null,"content":"æ€»ç»“ è¿™ç¯‡ä¸»è¦åšäº†å¯¹Goè¯­è¨€çš„ä»‹ç»å’Œä¼˜ç¼ºç‚¹ï¼Œåˆ†æäº†defer çš„ç”¨æ³•ä»¥åŠå®ç°åŸç†ï¼Œæœ€åç”¨ä¾‹å­å±•ç¤ºäº†ä½¿ç”¨è¿‡ç¨‹ä¸­å¯èƒ½ä¼šå­˜åœ¨çš„å‘ã€‚ä¸‹ç¯‡é¢„å‘Š: Go çš„è°ƒåº¦æ¨¡å‹ï¼Œæ¬¢è¿å…³æ³¨!!! å¦‚æœæœ‰ç†è§£ä¸æ­£ç¡®çš„åœ°æ–¹ï¼Œæ¬¢è¿æŒ‡å‡ºã€‚ ","date":"2020-11-08","objectID":"/golang/defer/:6:0","tags":["golang","defer"],"title":"ç»†è°ˆ Golang ä¸­é‚£äº›è®¾è®¡ä¼˜ç¾çš„ç»†èŠ‚-defer","uri":"/golang/defer/"},{"categories":null,"content":"Hugo, the world's fastest framework for building websites","date":"2020-11-08","objectID":"/defer/","tags":["golang","defer"],"title":"ç»†è°ˆ Golang ä¸­é‚£äº›è®¾è®¡ä¼˜ç¾çš„ç»†èŠ‚-defer","uri":"/defer/"},{"categories":null,"content":"èƒŒæ™¯ åœ¨å­¦ä¹ å’Œä½¿ç”¨ Go çš„è¿‡ç¨‹ä¸­å‘ç°ï¼ŒGo åœ¨è¯­è¨€å±‚é¢çš„è®¾è®¡æœ‰å¾ˆå¤šæœ‰è¶£çš„åœ°æ–¹ï¼Œæ‰€ä»¥å‡†å¤‡ç”¨ä¸€ä¸ªç³»åˆ—æ¥ç»†æ•°è¿™äº›æœ‰è¶£çš„åœ°æ–¹ã€‚å†™è¿™ä¸ªç³»åˆ—ä¸€æ˜¯ä¸ºäº†åŠ æ·±è‡ªå·±çš„ç†è§£ï¼ŒäºŒæ˜¯æ„¿æ„åˆ†äº«ï¼Œåˆ†äº« Go ä¸­æœ‰è¶£çš„è®¾è®¡ç»†èŠ‚ã€‚æ¯ç¯‡éƒ½ä¼šé€šè¿‡ä¸€ä¸ªä¾‹å­è®²è¿°ä¸€ä¸ªç»†èŠ‚ï¼Œæ„Ÿå…´è¶£çš„è¯å¯ä»¥å…³æ³¨ä¸€ä¸‹å“Ÿï¼ ","date":"2020-11-08","objectID":"/defer/:1:0","tags":["golang","defer"],"title":"ç»†è°ˆ Golang ä¸­é‚£äº›è®¾è®¡ä¼˜ç¾çš„ç»†èŠ‚-defer","uri":"/defer/"},{"categories":null,"content":"Go ä»‹ç» Goï¼ˆåˆç§° Golangï¼‰æ˜¯ Google çš„ Robert Griesemerï¼ŒRob Pike åŠ Ken Thompson å¼€å‘çš„ä¸€ç§é™æ€å¼ºç±»å‹ã€ç¼–è¯‘å‹è¯­è¨€ã€‚Go è¯­è¨€è¯­æ³•ä¸ C ç›¸è¿‘ï¼Œä½†åŠŸèƒ½ä¸Šæœ‰ï¼šå†…å­˜å®‰å…¨ï¼ŒGCï¼ˆåƒåœ¾å›æ”¶ï¼‰ï¼Œç»“æ„å½¢æ€åŠ CSP-style å¹¶å‘è®¡ç®—ã€‚ Go æ˜¯ç”±è¿™3ä½å¤§ä½¬ä»2007å¹´9æœˆå¼€å§‹è®¾è®¡Goï¼Œ2009å¹´æ­£å¼æ¨å‡ºï¼Œåˆ°ç›®å‰ä¸ºæ­¢å·²ç»å‘äº†15ä¸ªå¤§ç‰ˆæœ¬ï¼Œæœ€æ–°ç‰ˆä¸º1.15.4ã€‚Go ç°åœ¨å¹¿æ³›åº”ç”¨äºäº‘åŸç”Ÿã€ä¸­é—´ä»¶ã€è¿˜æœ‰å„ä¸ªä¸šåŠ¡å¹³å°ï¼Œå¦‚ dockerã€kubernetesã€etcdç­‰éƒ½æ˜¯Goè¯­è¨€ç¼–å†™ã€‚æ‰€ä»¥è¿˜æ˜¯å¾ˆæœ‰å¿…è¦äº†è§£ä¸€ä¸‹å“Ÿï¼ ä¸‹é¢ç®€å•è¯´è¯´Goçš„ä¼˜ç¼ºç‚¹ï¼Œä¿—è¯è¯´ï¼šä¸€ä¸‡ä¸ªäººçœ¼ä¸­æœ‰ä¸€ä¸‡ä¸ªå“ˆå§†é›·ç‰¹ï¼Œæ‰€ä»¥ä¼˜ç¼ºç‚¹éƒ½æ˜¯ç›¸å¯¹è€Œè¨€ï¼Œå°±è°ˆè°ˆè‡ªå·±ä½¿ç”¨è¿‡ç¨‹ä¸­çš„æ„Ÿå—ï¼Œå…·ä½“çš„ä¼˜ç¼ºç‚¹ä¼šåœ¨åé¢çš„ç³»åˆ—æ–‡ç« ä¸­ä¸€ä¸€æåˆ°ï¼Œè¿™é‡Œæ˜¯æŠ›ç –å¼•ç‰ã€‚ ","date":"2020-11-08","objectID":"/defer/:2:0","tags":["golang","defer"],"title":"ç»†è°ˆ Golang ä¸­é‚£äº›è®¾è®¡ä¼˜ç¾çš„ç»†èŠ‚-defer","uri":"/defer/"},{"categories":null,"content":"Go ä¼˜ç‚¹ è¯­è¨€å±‚é¢æ”¯æŒå¹¶å‘ï¼šä¸€ä¸ª go å…³é”®å­—å³å¯å®ç°å¹¶å‘ï¼Œå…¶ä»–ç¼–ç¨‹è¯­è¨€ä¾èµ–äºåº“å®ç°å¹¶å‘ï¼Œè¿™æ˜¯æœ‰æœ¬è´¨çš„åŒºåˆ« é«˜æ€§èƒ½ ç¼–è¯‘å®Œä¹‹åç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯å…å»ç¯å¢ƒä¾èµ– defer æœºåˆ¶ å†…ç½®runtime å†…åµŒCæ”¯æŒï¼ŒGoé‡Œé¢ä¹Ÿå¯ä»¥ç›´æ¥åŒ…å«Cä»£ç ï¼Œåˆ©ç”¨ç°æœ‰çš„ä¸°å¯Œçš„Cåº“ è·¨å¹³å°ç¼–è¯‘ ã€‚ã€‚ã€‚ ","date":"2020-11-08","objectID":"/defer/:3:0","tags":["golang","defer"],"title":"ç»†è°ˆ Golang ä¸­é‚£äº›è®¾è®¡ä¼˜ç¾çš„ç»†èŠ‚-defer","uri":"/defer/"},{"categories":null,"content":"Go ç¼ºç‚¹ åŒ…ç®¡ç† ã€‚ã€‚ã€‚ ","date":"2020-11-08","objectID":"/defer/:4:0","tags":["golang","defer"],"title":"ç»†è°ˆ Golang ä¸­é‚£äº›è®¾è®¡ä¼˜ç¾çš„ç»†èŠ‚-defer","uri":"/defer/"},{"categories":null,"content":"defer è¯´èµ· Go è¯­è¨€çš„æœ€å¼ºå¤§çš„åœ°æ–¹ï¼Œä¸å¾—ä¸è¯´ Go çš„å¹¶å‘æœºåˆ¶å’Œè°ƒåº¦åŸç†ï¼Œä½†æ˜¯ä»Šå¤©ä¸è®²è¿™äº›é«˜æ·±çš„ç†è®ºï¼Œå…ˆä»ç®€å•çš„å¼€å§‹ã€‚å…ˆæ€è€ƒè¿™ä¹ˆå‡ ä¸ªé—®é¢˜ï¼ˆå¯ä»¥ç”¨è‡ªå·±ç†Ÿæ‚‰çš„è¯­è¨€æ€è€ƒå¦‚ä½•è§£å†³ï¼‰: å¯¹äºæ–‡ä»¶çš„æ‰“å¼€å…³é—­ï¼Œç½‘ç»œè¿æ¥çš„å»ºç«‹æ–­å¼€åœºæ™¯ï¼Œå½“æ‰“å¼€æ—¶å€™åº”è¯¥ä½•æ—¶å…³é—­? å½“è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå¸Œæœ›åœ¨å‡½æ•°è¿”å›æ—¶ä¿®æ”¹å®ƒçš„å€¼ï¼Œè¯¥å¦‚ä½•è§£å†³? å…ˆçœ‹çœ‹defer çš„å®˜æ–¹å®šä¹‰ ï¼š A â€œdeferâ€ statement invokes a function whose execution is deferred to the moment the surrounding function returns, either because the surrounding function executed a return statement, reached the end of its function body, or because the corresponding goroutine is panicking. æ„æ€æ˜¯è¯´ï¼Œå½“åŒ…è£¹defer çš„å‡½æ•°è¿”å›æ—¶æˆ–è€…åŒ…è£¹deferçš„å‡½æ•°æ‰§è¡Œåˆ°æœ«å°¾æ—¶æˆ–è€…æ‰€åœ¨çš„goroutineå‘ç”Ÿpanicæ—¶æ‰ä¼šæ‰§è¡Œã€‚ æ¢å¥è¯è¯´å°±æ˜¯å½“å‡½æ•°æ‰§è¡Œå®Œä¹‹åæˆ–è€…å‘ç”Ÿå¼‚å¸¸æ—¶å†æ‰§è¡Œdeferè¯­å¥ï¼Œå°±æ˜¯è¯´åœ¨è¢«è°ƒå‡½æ•°è¿”å›ä¹‹åï¼Œèµ‹å€¼ç»™è°ƒç”¨å‡½æ•°ä¹‹å‰ï¼Œè¿˜æœ‰æœºä¼šæ‰§è¡Œå…¶ä»–æŒ‡ä»¤ï¼Œæ˜¯ä¸æ˜¯å¾ˆç¥å¥‡ã€‚å…ˆçœ‹ä¸€æ®µpython ä»£ç  : def f(x,y) : z = x / y z += 1 return z â€‹ if __name__ == \"__main__\" : result = f(4 /2) å½“è°ƒç”¨å‡½æ•°fï¼Œfè¿”å›ç»™zå¹¶ä¸”èµ‹å€¼ç»™resultï¼Œåœ¨è¿™æ—¶é—´ï¼Œæ˜¯æ²¡æœ‰ä»»ä½•æœºä¼šæ‰§è¡Œå…¶ä»–çš„å‡½æ•°ä»£ç çš„ã€‚å†çœ‹ä¸€æ®µgoä»£ç : package main func main() { result := f(4, 2) fmt.Println(result) } â€‹ func f(x, y int) (r int) { r = x / y r += 1 defer func() { r += 2 }() return } å½“è°ƒç”¨å‡½æ•°fï¼Œfè¿”å›ä¹‹åï¼Œåœ¨èµ‹å€¼ä¹‹å‰æ‰§è¡Œäº†r +=2 ã€‚ç°åœ¨å›æƒ³ä¸€ä¸‹ä¹‹å‰çš„ä¸¤ä¸ªé—®é¢˜ï¼Œå¦‚æœæœ‰defer æœºåˆ¶ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥å¾ˆå¥½çš„è§£å†³ã€‚å¦‚å¯¹äºç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨defer è¯­å¥ä¸­å¤„ç†æ–‡ä»¶çš„å…³é—­ï¼Œè¿æ¥çš„é‡Šæ”¾ç­‰ï¼Œè€Œä¸ç”¨è€ƒè™‘ä¸€äº›å¼‚å¸¸æƒ…å†µã€‚ é‚£deferçš„å®ç°åŸç†æ˜¯æ€æ ·çš„å‘¢? defer å…¶å®æ˜¯è°ƒç”¨runtime.deferproc è¿›è¡Œå®ç°ï¼Œåœ¨defer å‡ºç°çš„åœ°æ–¹ï¼Œæ’å…¥äº†call runtime.deferprocï¼Œç„¶ååœ¨å‡½æ•°è¿”å›ä¹‹å‰çš„åœ°æ–¹ï¼Œæ’å…¥æŒ‡ä»¤call runtime.deferreturnã€‚ æ™®é€šå‡½æ•°è¿”å›æ—¶ï¼Œæ±‡ç¼–ä»£ç ç±»ä¼¼äº: add xx SP return å¦‚æœåŒ…å«äº†defer è¯­å¥ï¼Œæ±‡ç¼–ä»£ç ç±»ä¼¼äº: call runtime.deferreturnï¼Œ add xx SP return goroutineçš„æ§åˆ¶ç»“æ„ä¸­ï¼Œæœ‰ä¸€å¼ è¡¨è®°å½•deferï¼Œè°ƒç”¨runtime.deferprocæ—¶ä¼šå°†éœ€è¦deferçš„è¡¨è¾¾å¼è®°å½•åœ¨è¡¨ä¸­ï¼Œè€Œåœ¨è°ƒç”¨runtime.deferreturnçš„æ—¶å€™ï¼Œåˆ™ä¼šä¾æ¬¡ä»deferè¡¨ä¸­å‡ºæ ˆå¹¶æ‰§è¡Œã€‚ defer åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¹Ÿå­˜åœ¨ä¸€äº›å‘ï¼Œçœ‹å‡ ä¸ªä¾‹å­: ä¾‹1: func f() (result int) { defer func() { result++ }() return 10 } ä¾‹2: func f() (result int) { t := 10 defer func() { t = t + 1 }() return t } ä¾‹3: func f() (result int) { defer func(result int) { result = result + 1 }(result) return 10 } å¤§å®¶å¯ä»¥å…ˆå¿ƒé‡Œé»˜é»˜ç®—ä¸€ä¸‹ä»–ä»¬çš„ç»“æœ ç¬¬ä¸€ä¸ªæ˜¯11ï¼Œç¬¬äºŒä¸ªæ˜¯10ï¼Œç¬¬ä¸‰ä¸ªæ˜¯10ã€‚ deferè¡¨è¾¾å¼å¯èƒ½ä¼šåœ¨è®¾ç½®å‡½æ•°è¿”å›å€¼ä¹‹åï¼Œåœ¨è¿”å›åˆ°è°ƒç”¨å‡½æ•°ä¹‹å‰ï¼Œä¿®æ”¹è¿”å›å€¼ï¼Œä½¿æœ€ç»ˆçš„å‡½æ•°è¿”å›å€¼ä¸ä½ æƒ³è±¡çš„ä¸ä¸€è‡´ã€‚å…¶å®ä½¿ç”¨deferæ—¶ï¼Œç”¨ä¸€ä¸ªç®€å•çš„è½¬æ¢è§„åˆ™æ”¹å†™ä¸€ä¸‹ï¼Œå°±ä¸ä¼šè¿·ç³Šäº†ã€‚æ”¹å†™è§„åˆ™æ˜¯å°†returnè¯­å¥æ‹†æˆä¸¤å¥å†™ï¼Œreturn xxxä¼šè¢«æ”¹å†™æˆ: è¿”å›å€¼ = xxx è°ƒç”¨deferå‡½æ•° ç©ºçš„return ä¾‹1 ä¼šè¢«æ”¹å†™æˆ: func f() (result int) { result = 10 // returnè¯­å¥ä¸æ˜¯ä¸€æ¡åŸå­è°ƒç”¨ï¼Œreturn xxxå…¶å®æ˜¯èµ‹å€¼ï¼‹retæŒ‡ä»¤ defer func() { result++ }() return // ç©ºçš„returnæŒ‡ä»¤ } æ‰€ä»¥è¿”å›å€¼æ˜¯11 ä¾‹2 ä¼šè¢«æ”¹å†™æˆ: func f() (result int) { t := 10 result = t // èµ‹å€¼æŒ‡ä»¤ defer func() { t = t + 1 //deferè¢«æ’å…¥åˆ°èµ‹å€¼ä¸è¿”å›ä¹‹é—´æ‰§è¡Œï¼Œè¿™ä¸ªä¾‹å­ä¸­è¿”å›å€¼ resultæ²¡è¢«ä¿®æ”¹è¿‡ }() return // ç©ºçš„returnæŒ‡ä»¤ } æ‰€ä»¥è¿”å›å€¼æ˜¯10 ä¾‹3 å°±ç•™ç»™å¤§å®¶è‡ªå·±æ”¹å†™ä¸€ä¸‹å•¦ï¼Œæœ‰å…´è¶£å¯ä»¥ç§æˆ‘æ²Ÿé€šå“Ÿï¼ ","date":"2020-11-08","objectID":"/defer/:5:0","tags":["golang","defer"],"title":"ç»†è°ˆ Golang ä¸­é‚£äº›è®¾è®¡ä¼˜ç¾çš„ç»†èŠ‚-defer","uri":"/defer/"},{"categories":null,"content":"æ€»ç»“ è¿™ç¯‡ä¸»è¦åšäº†å¯¹Goè¯­è¨€çš„ä»‹ç»å’Œä¼˜ç¼ºç‚¹ï¼Œåˆ†æäº†defer çš„ç”¨æ³•ä»¥åŠå®ç°åŸç†ï¼Œæœ€åç”¨ä¾‹å­å±•ç¤ºäº†ä½¿ç”¨è¿‡ç¨‹ä¸­å¯èƒ½ä¼šå­˜åœ¨çš„å‘ã€‚ä¸‹ç¯‡é¢„å‘Š: Go çš„è°ƒåº¦æ¨¡å‹ï¼Œæ¬¢è¿å…³æ³¨!!! å¦‚æœæœ‰ç†è§£ä¸æ­£ç¡®çš„åœ°æ–¹ï¼Œæ¬¢è¿æŒ‡å‡ºã€‚ ","date":"2020-11-08","objectID":"/defer/:6:0","tags":["golang","defer"],"title":"ç»†è°ˆ Golang ä¸­é‚£äº›è®¾è®¡ä¼˜ç¾çš„ç»†èŠ‚-defer","uri":"/defer/"},{"categories":null,"content":"è‡ªå·±å¼€æºçš„é¡¹ç›®","date":"2020-11-08","objectID":"/opensrouce/toolkit/","tags":["golang","toolkit"],"title":"è‡ªå·±å¼€æºçš„é¡¹ç›® - toolkit","uri":"/opensrouce/toolkit/"},{"categories":null,"content":"toolkit ","date":"2020-11-08","objectID":"/opensrouce/toolkit/:0:0","tags":["golang","toolkit"],"title":"è‡ªå·±å¼€æºçš„é¡¹ç›® - toolkit","uri":"/opensrouce/toolkit/"},{"categories":null,"content":"ä½œç”¨ ç”¨äºæä¾›å·¥ä½œæ•ˆç‡çš„å·¥å…·ç®±ï¼Œé‡Œé¢æœ‰å„ç§å·¥å…·ï¼Œå°±æ¯”å¦‚çœŸå®å·¥å…·ç®±ä¸­é‡Œé¢æœ‰æ‰³æ‰‹ï¼Œå„ç§å¤§å°çš„èµ·å­ï¼Œé’³å­ç­‰ æŸäº›åœºæ™¯ä¸‹ç¡®å®å¯ä»¥è¾¾åˆ°äº‹åŠåŠŸå€çš„æ•ˆæœ ","date":"2020-11-08","objectID":"/opensrouce/toolkit/:1:0","tags":["golang","toolkit"],"title":"è‡ªå·±å¼€æºçš„é¡¹ç›® - toolkit","uri":"/opensrouce/toolkit/"},{"categories":null,"content":"å®‰è£… ","date":"2020-11-08","objectID":"/opensrouce/toolkit/:2:0","tags":["golang","toolkit"],"title":"è‡ªå·±å¼€æºçš„é¡¹ç›® - toolkit","uri":"/opensrouce/toolkit/"},{"categories":null,"content":"æºç å®‰è£… æœ‰ go è¯­è¨€ç¯å¢ƒçš„å¯ä»¥ç›´æ¥ç”¨æºç è¿›è¡Œç¼–è¯‘è¿è¡Œ git clone https://github.com/russellgao/toolkit.git cd toolkit make ","date":"2020-11-08","objectID":"/opensrouce/toolkit/:2:1","tags":["golang","toolkit"],"title":"è‡ªå·±å¼€æºçš„é¡¹ç›® - toolkit","uri":"/opensrouce/toolkit/"},{"categories":null,"content":"äºŒè¿›åˆ¶ å¯ä»¥ç›´æ¥åœ¨release é¡µé¢è¿›è¡Œä¸‹è½½å¯¹åº”çš„æ“ä½œç³»ç»Ÿçš„äºŒè¿›åˆ¶æ–‡ä»¶ https://github.com/russellgao/toolkit/releases/ ","date":"2020-11-08","objectID":"/opensrouce/toolkit/:2:2","tags":["golang","toolkit"],"title":"è‡ªå·±å¼€æºçš„é¡¹ç›® - toolkit","uri":"/opensrouce/toolkit/"},{"categories":null,"content":"ç”¨æ³• ","date":"2020-11-08","objectID":"/opensrouce/toolkit/:3:0","tags":["golang","toolkit"],"title":"è‡ªå·±å¼€æºçš„é¡¹ç›® - toolkit","uri":"/opensrouce/toolkit/"},{"categories":null,"content":"æœ¬æœºè¿è¡Œ å¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤è¿›è¡Œ gwz:toolkit gaoweizong$ tkctl --help tkctl is a toolkit entrypoint,run `tkctl --help` get more information. Usage: tkctl [flags] tkctl [command] Available Commands: help Help about any command replace æ–‡æœ¬æ›¿æ¢ï¼Œæ”¯æŒæ­£åˆ™æ›¿æ¢å’Œéæ­£åˆ™æ›¿æ¢ï¼Œç±»ä¼¼ä¸linuxä¸‹çš„sedï¼Œä½†æ¯”sedæ›´å¥½ç”¨ï¼Œè€Œä¸”å¯ä»¥è·¨å¹³å°ä½¿ç”¨ secret ç”Ÿæˆéšæœºå¯†ç ï¼Œæ”¯æŒ1ï½100ä½é•¿åº¦ï¼Œå¯ä»¥æŒ‡å®šæ˜¯å¦åŒ…å«ç‰¹æ®Šå­—ç¬¦ version tkctl version Flags: -h, --help help for tkctl -v, --version show the version and exit Use \"tkctl [command] --help\" for more information about a command. tkctl ä¸­çš„å­å‘½ä»¤ä¼šä¸æ–­æ›´æ–°ï¼ŒæŸä¸ªå…·ä½“çš„åŠŸèƒ½è¯·æŸ¥çœ‹Available Commands:ä¸‹çš„å¸®åŠ©æ–‡æ¡£ï¼Œå¦‚æ–‡æœ¬æ›¿æ¢ tkctl replace --help æ–‡æœ¬æ›¿æ¢ï¼Œæ”¯æŒæ­£åˆ™æ›¿æ¢å’Œéæ­£åˆ™æ›¿æ¢ï¼Œç±»ä¼¼ä¸linuxä¸‹çš„sedï¼Œä½†æ¯”sedæ›´å¥½ç”¨ï¼Œè€Œä¸”å¯ä»¥è·¨å¹³å°ä½¿ç”¨ Usage: tkctl replace [flags] Flags: -d, --dirs string éœ€è¦æ›¿æ¢çš„ç›®å½•, é»˜è®¤ä¸ºå½“å‰è·¯å¾„ (default \".\") -h, --help help for replace -m, --mode string æ›¿æ¢çš„æ¨¡å¼ï¼Œæ”¯æŒæ­£åˆ™ï¼ˆregexpï¼‰å’Œéæ­£åˆ™ï¼ˆtextï¼‰ä¸¤ç§æ¨¡å¼ï¼Œé»˜è®¤éæ­£åˆ™ï¼Œ (default \"text\") -p, --pattern string éœ€è¦æ›¿æ¢çš„pattern [required] -r, --repl string ç›®æ ‡å­—ç¬¦ä¸² [required] ","date":"2020-11-08","objectID":"/opensrouce/toolkit/:3:1","tags":["golang","toolkit"],"title":"è‡ªå·±å¼€æºçš„é¡¹ç›® - toolkit","uri":"/opensrouce/toolkit/"},{"categories":null,"content":"docker å¦‚æœæœ¬åœ°æœ‰dockerç¯å¢ƒï¼Œä¹Ÿå¯ä»¥ä¸ç”¨ä¸‹è½½äºŒè¿›åˆ¶çš„åˆ¶å“ï¼Œå¯ä»¥é€šè¿‡docker ç¯å¢ƒç›´æ¥è¿è¡Œ docker run -it --rm russellgao/toolkit:latest tkctl --help # å¦‚æœæœ‰éœ€è¦å¯ä»¥æŠŠç›®å½•æŒ‚è½½è¿›å» docker run -it -v /data:/data --rm russellgao/toolkit:latest tkctl --help ","date":"2020-11-08","objectID":"/opensrouce/toolkit/:3:2","tags":["golang","toolkit"],"title":"è‡ªå·±å¼€æºçš„é¡¹ç›® - toolkit","uri":"/opensrouce/toolkit/"},{"categories":null,"content":"é€‚ç”¨èŒƒå›´ å¯ä»¥è·¨å¹³å°ä½¿ç”¨ mac windows linux ","date":"2020-11-08","objectID":"/opensrouce/toolkit/:4:0","tags":["golang","toolkit"],"title":"è‡ªå·±å¼€æºçš„é¡¹ç›® - toolkit","uri":"/opensrouce/toolkit/"},{"categories":null,"content":"å¼€å‘ç¯å¢ƒ go 1.14.2 ","date":"2020-11-08","objectID":"/opensrouce/toolkit/:5:0","tags":["golang","toolkit"],"title":"è‡ªå·±å¼€æºçš„é¡¹ç›® - toolkit","uri":"/opensrouce/toolkit/"},{"categories":null,"content":"æ”¯æŒçš„åŠŸèƒ½ ","date":"2020-11-08","objectID":"/opensrouce/toolkit/:6:0","tags":["golang","toolkit"],"title":"è‡ªå·±å¼€æºçš„é¡¹ç›® - toolkit","uri":"/opensrouce/toolkit/"},{"categories":null,"content":"1.0.0 æ–‡æœ¬æ­£åˆ™æ›¿æ¢ ç”Ÿæˆéšæœºå¯†ç  ","date":"2020-11-08","objectID":"/opensrouce/toolkit/:6:1","tags":["golang","toolkit"],"title":"è‡ªå·±å¼€æºçš„é¡¹ç›® - toolkit","uri":"/opensrouce/toolkit/"},{"categories":null,"content":"æœªæ¥å±•æœ› æœŸæœ›å¯ä»¥æˆä¸ºä¸€ä¸ªå®Œæ•´çš„å·¥å…·ç®±ï¼Œå¯ä»¥è§£å†³æ—¥å¸¸å·¥ä½œä¸­çš„ç¹æ‚äº‹æƒ…ã€‚ ","date":"2020-11-08","objectID":"/opensrouce/toolkit/:7:0","tags":["golang","toolkit"],"title":"è‡ªå·±å¼€æºçš„é¡¹ç›® - toolkit","uri":"/opensrouce/toolkit/"},{"categories":null,"content":"é¡¹ç›®åœ°å€ https://github.com/russellgao/toolkit ","date":"2020-11-08","objectID":"/opensrouce/toolkit/:8:0","tags":["golang","toolkit"],"title":"è‡ªå·±å¼€æºçš„é¡¹ç›® - toolkit","uri":"/opensrouce/toolkit/"},{"categories":null,"content":"å¦‚ä½•åˆ©ç”¨ python æ“çºµ oracle","date":"2020-07-09","objectID":"/oracle/","tags":["python","oracle","æ•°æ®åº“"],"title":"å¦‚ä½•åˆ©ç”¨ python æ“çºµ oracle","uri":"/oracle/"},{"categories":null,"content":"å®‰è£…åº“ pip3 install sqlalchemy pip3 install cx_Oracle ","date":"2020-07-09","objectID":"/oracle/:1:0","tags":["python","oracle","æ•°æ®åº“"],"title":"å¦‚ä½•åˆ©ç”¨ python æ“çºµ oracle","uri":"/oracle/"},{"categories":null,"content":"å®‰è£…å®¢æˆ·ç«¯ oracle å®¢æˆ·ç«¯ä¸‹è½½é¡µé¢: https://www.oracle.com/database/technologies/instant-client/downloads.html ","date":"2020-07-09","objectID":"/oracle/:2:0","tags":["python","oracle","æ•°æ®åº“"],"title":"å¦‚ä½•åˆ©ç”¨ python æ“çºµ oracle","uri":"/oracle/"},{"categories":null,"content":"mac https://www.oracle.com/database/technologies/instant-client/macos-intel-x86-downloads.html åœ¨ä¸Šé¢çš„é¡µé¢ä¸‹è½½ä¹‹åæ‰§è¡Œ: # è§£å‹ cd ~ unzip instantclient-basic-macos.x64-19.3.0.0.0dbru.zip # åˆ›å»ºlink mkdir ~/lib ln -s ~/instantclient_19_3/libclntsh.dylib ~/lib/ ","date":"2020-07-09","objectID":"/oracle/:2:1","tags":["python","oracle","æ•°æ®åº“"],"title":"å¦‚ä½•åˆ©ç”¨ python æ“çºµ oracle","uri":"/oracle/"},{"categories":null,"content":"linux https://www.oracle.com/database/technologies/instant-client/linux-x86-64-downloads.html ","date":"2020-07-09","objectID":"/oracle/:2:2","tags":["python","oracle","æ•°æ®åº“"],"title":"å¦‚ä½•åˆ©ç”¨ python æ“çºµ oracle","uri":"/oracle/"},{"categories":null,"content":"windows https://www.oracle.com/database/technologies/instant-client/winx64-64-downloads.html ","date":"2020-07-09","objectID":"/oracle/:2:3","tags":["python","oracle","æ•°æ®åº“"],"title":"å¦‚ä½•åˆ©ç”¨ python æ“çºµ oracle","uri":"/oracle/"},{"categories":null,"content":"ä½¿ç”¨ åœ¨ä¸Šé¢è£…å¥½åº“å’Œoracle client å°±å¯ä»¥ç”¨python æ“ä½œ oracle äº† ç®€å•ç”¨æ³•å‚è§ : from sqlalchemy import * # è¿æ¥oracle engine = create_engine('oracle://username:passwoed@xxxxx', encoding=\"utf8\",echo=True) connection = engine.connect() # table, ä¼šæ ¹æ®è¡¨åè‡ªåŠ¨ç”ŸæˆTable å¯¹è±¡ meta = MetaData() t = Table(\"abcd\",meta,autoload=True,autoload_with=engine) # è·å–åˆ— columns = t.c print(columns) # æŸ¥è¯¢ # s = select([t]) # s = select([t]).where(t.c.name == \"xxxx\") s = select([t]).where(t.c.code == \"xxxx\") result = connection.execute(s) for row in result : print(row[t.c.gid],row[t.c.code],row[t.c.name],row[t.c.note]) result.close() print(\"end\") ","date":"2020-07-09","objectID":"/oracle/:3:0","tags":["python","oracle","æ•°æ®åº“"],"title":"å¦‚ä½•åˆ©ç”¨ python æ“çºµ oracle","uri":"/oracle/"},{"categories":null,"content":"æŠ¥é”™ å¦‚æœæŠ¥å¦‚ä¸‹é”™è¯¯: sqlalchemy.exc.DatabaseError: (cx_Oracle.DatabaseError) DPI-1047: Cannot locate a 64-bit Oracle Client library: \"dlopen(libclntsh.dylib, 1): image not found\". See https://cx-oracle.readthedocs.io/en/latest/user_guide/installation.html for help (Background on this error at: http://sqlalche.me/e/13/4xp6) è¯´æ˜oracleçš„ client æ²¡æœ‰æ­£ç¡®å®‰è£… å¦‚æœæŠ¥é”™å¦‚ä¸‹: sqlalchemy.exc.DatabaseError: (cx_Oracle.DatabaseError) ORA-01017: invalid username/password; logon denied (Background on this error at: http://sqlalche.me/e/13/4xp6) è¯´æ˜oracle çš„ç”¨æˆ·å¯†ç ä¸æ­£ç¡® ","date":"2020-07-09","objectID":"/oracle/:4:0","tags":["python","oracle","æ•°æ®åº“"],"title":"å¦‚ä½•åˆ©ç”¨ python æ“çºµ oracle","uri":"/oracle/"},{"categories":null,"content":"å‚è€ƒ https://docs.sqlalchemy.org/en/13/dialects/oracle.html https://www.cnblogs.com/iupoint/p/10932069.html ","date":"2020-07-09","objectID":"/oracle/:5:0","tags":["python","oracle","æ•°æ®åº“"],"title":"å¦‚ä½•åˆ©ç”¨ python æ“çºµ oracle","uri":"/oracle/"},{"categories":null,"content":"å¦‚ä½•åˆ©ç”¨ python æ“çºµ oracle","date":"2020-07-09","objectID":"/python/oracle/","tags":["python","oracle","æ•°æ®åº“"],"title":"å¦‚ä½•åˆ©ç”¨ python æ“çºµ oracle","uri":"/python/oracle/"},{"categories":null,"content":"å®‰è£…åº“ pip3 install sqlalchemy pip3 install cx_Oracle ","date":"2020-07-09","objectID":"/python/oracle/:1:0","tags":["python","oracle","æ•°æ®åº“"],"title":"å¦‚ä½•åˆ©ç”¨ python æ“çºµ oracle","uri":"/python/oracle/"},{"categories":null,"content":"å®‰è£…å®¢æˆ·ç«¯ oracle å®¢æˆ·ç«¯ä¸‹è½½é¡µé¢: https://www.oracle.com/database/technologies/instant-client/downloads.html ","date":"2020-07-09","objectID":"/python/oracle/:2:0","tags":["python","oracle","æ•°æ®åº“"],"title":"å¦‚ä½•åˆ©ç”¨ python æ“çºµ oracle","uri":"/python/oracle/"},{"categories":null,"content":"mac https://www.oracle.com/database/technologies/instant-client/macos-intel-x86-downloads.html åœ¨ä¸Šé¢çš„é¡µé¢ä¸‹è½½ä¹‹åæ‰§è¡Œ: # è§£å‹ cd ~ unzip instantclient-basic-macos.x64-19.3.0.0.0dbru.zip # åˆ›å»ºlink mkdir ~/lib ln -s ~/instantclient_19_3/libclntsh.dylib ~/lib/ ","date":"2020-07-09","objectID":"/python/oracle/:2:1","tags":["python","oracle","æ•°æ®åº“"],"title":"å¦‚ä½•åˆ©ç”¨ python æ“çºµ oracle","uri":"/python/oracle/"},{"categories":null,"content":"linux https://www.oracle.com/database/technologies/instant-client/linux-x86-64-downloads.html ","date":"2020-07-09","objectID":"/python/oracle/:2:2","tags":["python","oracle","æ•°æ®åº“"],"title":"å¦‚ä½•åˆ©ç”¨ python æ“çºµ oracle","uri":"/python/oracle/"},{"categories":null,"content":"windows https://www.oracle.com/database/technologies/instant-client/winx64-64-downloads.html ","date":"2020-07-09","objectID":"/python/oracle/:2:3","tags":["python","oracle","æ•°æ®åº“"],"title":"å¦‚ä½•åˆ©ç”¨ python æ“çºµ oracle","uri":"/python/oracle/"},{"categories":null,"content":"ä½¿ç”¨ åœ¨ä¸Šé¢è£…å¥½åº“å’Œoracle client å°±å¯ä»¥ç”¨python æ“ä½œ oracle äº† ç®€å•ç”¨æ³•å‚è§ : from sqlalchemy import * # è¿æ¥oracle engine = create_engine('oracle://username:passwoed@xxxxx', encoding=\"utf8\",echo=True) connection = engine.connect() # table, ä¼šæ ¹æ®è¡¨åè‡ªåŠ¨ç”ŸæˆTable å¯¹è±¡ meta = MetaData() t = Table(\"abcd\",meta,autoload=True,autoload_with=engine) # è·å–åˆ— columns = t.c print(columns) # æŸ¥è¯¢ # s = select([t]) # s = select([t]).where(t.c.name == \"xxxx\") s = select([t]).where(t.c.code == \"xxxx\") result = connection.execute(s) for row in result : print(row[t.c.gid],row[t.c.code],row[t.c.name],row[t.c.note]) result.close() print(\"end\") ","date":"2020-07-09","objectID":"/python/oracle/:3:0","tags":["python","oracle","æ•°æ®åº“"],"title":"å¦‚ä½•åˆ©ç”¨ python æ“çºµ oracle","uri":"/python/oracle/"},{"categories":null,"content":"æŠ¥é”™ å¦‚æœæŠ¥å¦‚ä¸‹é”™è¯¯: sqlalchemy.exc.DatabaseError: (cx_Oracle.DatabaseError) DPI-1047: Cannot locate a 64-bit Oracle Client library: \"dlopen(libclntsh.dylib, 1): image not found\". See https://cx-oracle.readthedocs.io/en/latest/user_guide/installation.html for help (Background on this error at: http://sqlalche.me/e/13/4xp6) è¯´æ˜oracleçš„ client æ²¡æœ‰æ­£ç¡®å®‰è£… å¦‚æœæŠ¥é”™å¦‚ä¸‹: sqlalchemy.exc.DatabaseError: (cx_Oracle.DatabaseError) ORA-01017: invalid username/password; logon denied (Background on this error at: http://sqlalche.me/e/13/4xp6) è¯´æ˜oracle çš„ç”¨æˆ·å¯†ç ä¸æ­£ç¡® ","date":"2020-07-09","objectID":"/python/oracle/:4:0","tags":["python","oracle","æ•°æ®åº“"],"title":"å¦‚ä½•åˆ©ç”¨ python æ“çºµ oracle","uri":"/python/oracle/"},{"categories":null,"content":"å‚è€ƒ https://docs.sqlalchemy.org/en/13/dialects/oracle.html https://www.cnblogs.com/iupoint/p/10932069.html ","date":"2020-07-09","objectID":"/python/oracle/:5:0","tags":["python","oracle","æ•°æ®åº“"],"title":"å¦‚ä½•åˆ©ç”¨ python æ“çºµ oracle","uri":"/python/oracle/"},{"categories":null,"content":"pod é…ç½®æ–‡ä»¶è¯´æ˜","date":"2020-06-18","objectID":"/kubernetes/pod%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%B4%E6%98%8E/","tags":["kubernetes","pod"],"title":"pod é…ç½®æ–‡ä»¶è¯´æ˜","uri":"/kubernetes/pod%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%B4%E6%98%8E/"},{"categories":null,"content":"Podçš„å®šä¹‰æ–‡ä»¶ apiVersion:v1kind:Podmetadata:name:stringnamaspace:stringlabels:- name:stringannotations:- name:stringspec:containers:- name:string# ä½¿ç”¨çš„é•œåƒimage:stringimagePullPolicy:[Always|Never|IfNotPresent]command:[string]args:[string]# å·¥ä½œç›®å½•workingDir:stringvolumeMounts:- name:stringmountPath:stringreadOnly:booleanports:- name:stringcontainerPort:inthostPort:intprotocol:stringenv:- name:stringvalue:stringresources:limits:cpu:stringmemory:stringrequests:cpu:stringmemory:stringlivenessProbe:exec:command:[string]httpGet:path:stringport:inthost:stringscheme:stringhttpHeaders:- name:stringvalue:stringtcpSocket:port:int# å¤šä¹…ä¹‹åå»æ£€æŸ¥initialDelaySeconds:number# å¥åº·æ£€æŸ¥è¶…æ—¶æ—¶é—´timeoutSeconds:number# å¤šé•¿æ—¶é—´æ£€æŸ¥ä¸€æ¬¡periodSeconds:number# æˆåŠŸçš„é˜€å€¼ï¼Œæ£€æŸ¥å‡ æ¬¡æˆåŠŸæ‰ç®—æˆåŠŸsuccessThreshold:0# å¤±è´¥çš„é˜€å€¼ï¼Œæ£€æŸ¥å‡ æ¬¡å¤±è´¥æ‰ç®—å¤±è´¥failureThreshold:0securityContext:# è¯¦ç»†å‚è§ pod_SecurityContext ç« èŠ‚# securityContext å¯ä»¥é…ç½®pod æˆ–è€…container çº§åˆ«runAsUser:1000# è¿è¡Œçš„ç”¨æˆ·runAsGroup:3000# è¿è¡Œçš„ç”¨æˆ·ç»„fsGroup:2000privileged:bool# æ˜¯å¦ä»¥privileged æƒé™è¿è¡Œï¼Œå³è¿™æ˜¯è¿™ä¸ªè¿›ç¨‹æ‹¥æœ‰ç‰¹æƒallowPrivilegeEscalation:bool# æ§åˆ¶ä¸€ä¸ªè¿›ç¨‹æ˜¯å¦èƒ½æ¯”å…¶çˆ¶è¿›ç¨‹è·å–æ›´å¤šçš„æƒé™ï¼Œå¦‚æœä¸€ä¸ªå®¹å™¨ä»¥privilegedæƒé™è¿è¡Œæˆ–å…·æœ‰CAP_SYS_ADMINæƒé™ï¼Œåˆ™AllowPrivilegeEscalationçš„å€¼å°†æ€»æ˜¯truecapabilities:add:[\"NET_ADMIN\",\"SYS_TIME\",\"...\"]# ç»™æŸä¸ªç‰¹å®šçš„è¿›ç¨‹privilegedæƒé™ï¼Œè€Œä¸ç”¨ç»™rootç”¨æˆ·æ‰€æœ‰çš„privilegedæƒé™terminationMessagePath:/dev/termination-log# å®¹å™¨ç»ˆæ­¢çš„æ—¥å¿—æ–‡ä»¶terminationMessagePolicy:[File|FallbackToLogsOnError]# é»˜è®¤ä¸ºFile, å®¹å™¨ç»ˆæ­¢æ¶ˆæ¯è¾“å‡ºåˆ°æ–‡ä»¶restartPolicy:[Always|Never|OnFailure]# é‡å¯ç­–ç•¥ï¼Œé»˜è®¤ä¸º AlwaysnodeSelector:object# é€šè¿‡label é€‰å–nodednsPolicy:ClusterFirst# pod çš„ dns ç­–ç•¥ ,å¯ä»¥é…ç½®å¦‚ä¸‹å€¼# Default : å’Œå®¿ä¸»æœºçš„DNSå®Œå…¨ä¸€è‡´# ClusterFirst: æŠŠé›†ç¾¤çš„DNSå†™å…¥åˆ°Podçš„DNSé…ç½®ï¼Œä½†æ˜¯å¦‚æœè®¾ç½®äº†HostNetwork=trueï¼Œå°±ä¼šå¼ºåˆ¶è®¾ç½®ä¸ºDefault# ClusterFirstWithHostNet: æŠŠé›†ç¾¤çš„DNSå†™å…¥åˆ°Podçš„DNSé…ç½®ï¼Œä¸ç®¡æ˜¯å¦è®¾ç½®HostNetwork# None: å¿½ç•¥æ‰€æœ‰çš„DNSé…ç½®ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œè®¾ç½®äº†Noneä¹‹åä¼šè‡ªå·±æ‰‹åŠ¨å†è®¾ç½®dnsConfigenableServiceLinks:true# Kubernetesæ”¯æŒä¸¤ç§æŸ¥æ‰¾æœåŠ¡çš„ä¸»è¦æ¨¡å¼: ç¯å¢ƒå˜é‡å’ŒDNS, å¦‚æœä¸éœ€è¦æœåŠ¡ç¯å¢ƒå˜é‡, å°† `enableServiceLinks` æ ‡å¿—è®¾ç½®ä¸º `false` æ¥ç¦ç”¨æ­¤æ¨¡å¼terminationGracePeriodSeconds:10# å‘å‡ºåˆ é™¤podæŒ‡ä»¤åå¤šä¹…ä¹‹åçœŸæ­£çš„åˆ é™¤podserviceAccountName:jenkins# pod ç»‘å®šçš„serviceAccountpriorityClassName:# ç»™pod è®¾ç½®ä¼˜å…ˆçº§ï¼Œå‚è€ƒ : https://kubernetes.io/docs/concepts/configuration/pod-priority-preemption/schedulerName:default-scheduler# å¦‚æœä¸é…ç½®åˆ™ä½¿ç”¨kubernetes é»˜è®¤çš„default-schedulerï¼Œå¦‚æœè¿™ä¸ªä¸æ»¡è¶³è¦æ±‚åˆ™å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªscheduler# https://kubernetes.io/zh/docs/tasks/administer-cluster/configure-multiple-schedulers/affinity:# äº²å’Œæ€§è®¾ç½®tolerations:- effect:NoExecutekey:node.kubernetes.io/not-readyoperator:ExiststolerationSeconds:300- effect:NoExecutekey:node.kubernetes.io/unreachableoperator:ExiststolerationSeconds:300# å®¹å¿è®¾ç½®imagePullSecrets:- name:string# é•œåƒæ‹‰å–ç­–ç•¥hostNetwork:false# æ˜¯å¦ä½¿ç”¨ä¸»æœºç½‘ç»œï¼Œé»˜è®¤ä¸ºfalseï¼Œå¦‚æœä¸ºtrueï¼Œpodç›´æ¥ç”¨ä¸»æœºç½‘ç»œï¼Œåœ¨podä¸­å¯ä»¥çœ‹åˆ°ä¸»æœºçš„ç½‘ç»œæ¥å£volumes:- name:stringemptyDir:{}hostPath:path:stringsecret:secretName:stringitems:- key:stringpath:stringconfigMap:name:stringitems:- key:stringpath:string# ç›®å½•æŒ‚è½½ ","date":"2020-06-18","objectID":"/kubernetes/pod%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%B4%E6%98%8E/:1:0","tags":["kubernetes","pod"],"title":"pod é…ç½®æ–‡ä»¶è¯´æ˜","uri":"/kubernetes/pod%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%B4%E6%98%8E/"},{"categories":null,"content":"pod å…·ä½“çš„æ ·ä¾‹ apiVersion:v1kind:Podmetadata:labels:app:elastic-clustername:enode-0spec:containers:- env:- name:ES_JAVA_OPTSvalueFrom:configMapKeyRef:key:ES_JAVA_OPTSname:es-configimage:elasticsearch:6.7.2imagePullPolicy:IfNotPresentlivenessProbe:failureThreshold:3httpGet:path:/_cluster/health?local=trueport:9200scheme:HTTPperiodSeconds:600successThreshold:1timeoutSeconds:1name:elasticsearchports:- containerPort:9200name:es-httpprotocol:TCP- containerPort:9300name:es-transportprotocol:TCPreadinessProbe:failureThreshold:3httpGet:path:/_cluster/health?local=trueport:9200scheme:HTTPinitialDelaySeconds:30periodSeconds:20successThreshold:1timeoutSeconds:1resources:limits:cpu:\"2\"memory:10Girequests:cpu:\"1\"memory:8GisecurityContext:capabilities:add:- IPC_LOCK- SYS_RESOURCEprivileged:truerunAsUser:1000terminationMessagePath:/dev/termination-logterminationMessagePolicy:FilevolumeMounts:- mountPath:/usr/share/elasticsearch/dataname:es-data- mountPath:/usr/share/elasticsearch/logsname:es-logs- mountPath:/usr/share/elasticsearch/config/elasticsearch.ymlname:elasticsearch-configsubPath:elasticsearch.yml- mountPath:/var/run/secrets/kubernetes.io/serviceaccountname:default-token-k4r6freadOnly:truednsPolicy:ClusterFirstenableServiceLinks:truehostname:enode-0initContainers:- command:- sysctl- -w- vm.max_map_count=262144image:busyboximagePullPolicy:IfNotPresentname:init-sysctlresources:{}securityContext:privileged:trueterminationMessagePath:/dev/termination-logterminationMessagePolicy:FilevolumeMounts:- mountPath:/var/run/secrets/kubernetes.io/serviceaccountname:default-token-k4r6freadOnly:truepriority:0restartPolicy:AlwaysschedulerName:default-schedulersecurityContext:fsGroup:1000serviceAccount:defaultserviceAccountName:defaultsubdomain:elasticsearch-clusterterminationGracePeriodSeconds:30tolerations:- effect:NoExecutekey:node.kubernetes.io/not-readyoperator:ExiststolerationSeconds:300- effect:NoExecutekey:node.kubernetes.io/unreachableoperator:ExiststolerationSeconds:300volumes:- name:es-datapersistentVolumeClaim:claimName:es-data-enode-0- name:es-logspersistentVolumeClaim:claimName:es-logs-enode-0- configMap:defaultMode:420items:- key:elasticsearch.ymlpath:elasticsearch.ymlname:es-configname:elasticsearch-config- name:default-token-k4r6fsecret:defaultMode:420secretName:default-token-k4r6f ","date":"2020-06-18","objectID":"/kubernetes/pod%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%B4%E6%98%8E/:2:0","tags":["kubernetes","pod"],"title":"pod é…ç½®æ–‡ä»¶è¯´æ˜","uri":"/kubernetes/pod%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%B4%E6%98%8E/"},{"categories":null,"content":"pod é…ç½®æ–‡ä»¶è¯´æ˜","date":"2020-06-18","objectID":"/pod%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%B4%E6%98%8E/","tags":["kubernetes","pod"],"title":"pod é…ç½®æ–‡ä»¶è¯´æ˜","uri":"/pod%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%B4%E6%98%8E/"},{"categories":null,"content":"Podçš„å®šä¹‰æ–‡ä»¶ apiVersion:v1kind:Podmetadata:name:stringnamaspace:stringlabels:- name:stringannotations:- name:stringspec:containers:- name:string# ä½¿ç”¨çš„é•œåƒimage:stringimagePullPolicy:[Always|Never|IfNotPresent]command:[string]args:[string]# å·¥ä½œç›®å½•workingDir:stringvolumeMounts:- name:stringmountPath:stringreadOnly:booleanports:- name:stringcontainerPort:inthostPort:intprotocol:stringenv:- name:stringvalue:stringresources:limits:cpu:stringmemory:stringrequests:cpu:stringmemory:stringlivenessProbe:exec:command:[string]httpGet:path:stringport:inthost:stringscheme:stringhttpHeaders:- name:stringvalue:stringtcpSocket:port:int# å¤šä¹…ä¹‹åå»æ£€æŸ¥initialDelaySeconds:number# å¥åº·æ£€æŸ¥è¶…æ—¶æ—¶é—´timeoutSeconds:number# å¤šé•¿æ—¶é—´æ£€æŸ¥ä¸€æ¬¡periodSeconds:number# æˆåŠŸçš„é˜€å€¼ï¼Œæ£€æŸ¥å‡ æ¬¡æˆåŠŸæ‰ç®—æˆåŠŸsuccessThreshold:0# å¤±è´¥çš„é˜€å€¼ï¼Œæ£€æŸ¥å‡ æ¬¡å¤±è´¥æ‰ç®—å¤±è´¥failureThreshold:0securityContext:# è¯¦ç»†å‚è§ pod_SecurityContext ç« èŠ‚# securityContext å¯ä»¥é…ç½®pod æˆ–è€…container çº§åˆ«runAsUser:1000# è¿è¡Œçš„ç”¨æˆ·runAsGroup:3000# è¿è¡Œçš„ç”¨æˆ·ç»„fsGroup:2000privileged:bool# æ˜¯å¦ä»¥privileged æƒé™è¿è¡Œï¼Œå³è¿™æ˜¯è¿™ä¸ªè¿›ç¨‹æ‹¥æœ‰ç‰¹æƒallowPrivilegeEscalation:bool# æ§åˆ¶ä¸€ä¸ªè¿›ç¨‹æ˜¯å¦èƒ½æ¯”å…¶çˆ¶è¿›ç¨‹è·å–æ›´å¤šçš„æƒé™ï¼Œå¦‚æœä¸€ä¸ªå®¹å™¨ä»¥privilegedæƒé™è¿è¡Œæˆ–å…·æœ‰CAP_SYS_ADMINæƒé™ï¼Œåˆ™AllowPrivilegeEscalationçš„å€¼å°†æ€»æ˜¯truecapabilities:add:[\"NET_ADMIN\",\"SYS_TIME\",\"...\"]# ç»™æŸä¸ªç‰¹å®šçš„è¿›ç¨‹privilegedæƒé™ï¼Œè€Œä¸ç”¨ç»™rootç”¨æˆ·æ‰€æœ‰çš„privilegedæƒé™terminationMessagePath:/dev/termination-log# å®¹å™¨ç»ˆæ­¢çš„æ—¥å¿—æ–‡ä»¶terminationMessagePolicy:[File|FallbackToLogsOnError]# é»˜è®¤ä¸ºFile, å®¹å™¨ç»ˆæ­¢æ¶ˆæ¯è¾“å‡ºåˆ°æ–‡ä»¶restartPolicy:[Always|Never|OnFailure]# é‡å¯ç­–ç•¥ï¼Œé»˜è®¤ä¸º AlwaysnodeSelector:object# é€šè¿‡label é€‰å–nodednsPolicy:ClusterFirst# pod çš„ dns ç­–ç•¥ ,å¯ä»¥é…ç½®å¦‚ä¸‹å€¼# Default : å’Œå®¿ä¸»æœºçš„DNSå®Œå…¨ä¸€è‡´# ClusterFirst: æŠŠé›†ç¾¤çš„DNSå†™å…¥åˆ°Podçš„DNSé…ç½®ï¼Œä½†æ˜¯å¦‚æœè®¾ç½®äº†HostNetwork=trueï¼Œå°±ä¼šå¼ºåˆ¶è®¾ç½®ä¸ºDefault# ClusterFirstWithHostNet: æŠŠé›†ç¾¤çš„DNSå†™å…¥åˆ°Podçš„DNSé…ç½®ï¼Œä¸ç®¡æ˜¯å¦è®¾ç½®HostNetwork# None: å¿½ç•¥æ‰€æœ‰çš„DNSé…ç½®ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œè®¾ç½®äº†Noneä¹‹åä¼šè‡ªå·±æ‰‹åŠ¨å†è®¾ç½®dnsConfigenableServiceLinks:true# Kubernetesæ”¯æŒä¸¤ç§æŸ¥æ‰¾æœåŠ¡çš„ä¸»è¦æ¨¡å¼: ç¯å¢ƒå˜é‡å’ŒDNS, å¦‚æœä¸éœ€è¦æœåŠ¡ç¯å¢ƒå˜é‡, å°† `enableServiceLinks` æ ‡å¿—è®¾ç½®ä¸º `false` æ¥ç¦ç”¨æ­¤æ¨¡å¼terminationGracePeriodSeconds:10# å‘å‡ºåˆ é™¤podæŒ‡ä»¤åå¤šä¹…ä¹‹åçœŸæ­£çš„åˆ é™¤podserviceAccountName:jenkins# pod ç»‘å®šçš„serviceAccountpriorityClassName:# ç»™pod è®¾ç½®ä¼˜å…ˆçº§ï¼Œå‚è€ƒ : https://kubernetes.io/docs/concepts/configuration/pod-priority-preemption/schedulerName:default-scheduler# å¦‚æœä¸é…ç½®åˆ™ä½¿ç”¨kubernetes é»˜è®¤çš„default-schedulerï¼Œå¦‚æœè¿™ä¸ªä¸æ»¡è¶³è¦æ±‚åˆ™å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªscheduler# https://kubernetes.io/zh/docs/tasks/administer-cluster/configure-multiple-schedulers/affinity:# äº²å’Œæ€§è®¾ç½®tolerations:- effect:NoExecutekey:node.kubernetes.io/not-readyoperator:ExiststolerationSeconds:300- effect:NoExecutekey:node.kubernetes.io/unreachableoperator:ExiststolerationSeconds:300# å®¹å¿è®¾ç½®imagePullSecrets:- name:string# é•œåƒæ‹‰å–ç­–ç•¥hostNetwork:false# æ˜¯å¦ä½¿ç”¨ä¸»æœºç½‘ç»œï¼Œé»˜è®¤ä¸ºfalseï¼Œå¦‚æœä¸ºtrueï¼Œpodç›´æ¥ç”¨ä¸»æœºç½‘ç»œï¼Œåœ¨podä¸­å¯ä»¥çœ‹åˆ°ä¸»æœºçš„ç½‘ç»œæ¥å£volumes:- name:stringemptyDir:{}hostPath:path:stringsecret:secretName:stringitems:- key:stringpath:stringconfigMap:name:stringitems:- key:stringpath:string# ç›®å½•æŒ‚è½½ ","date":"2020-06-18","objectID":"/pod%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%B4%E6%98%8E/:1:0","tags":["kubernetes","pod"],"title":"pod é…ç½®æ–‡ä»¶è¯´æ˜","uri":"/pod%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%B4%E6%98%8E/"},{"categories":null,"content":"pod å…·ä½“çš„æ ·ä¾‹ apiVersion:v1kind:Podmetadata:labels:app:elastic-clustername:enode-0spec:containers:- env:- name:ES_JAVA_OPTSvalueFrom:configMapKeyRef:key:ES_JAVA_OPTSname:es-configimage:elasticsearch:6.7.2imagePullPolicy:IfNotPresentlivenessProbe:failureThreshold:3httpGet:path:/_cluster/health?local=trueport:9200scheme:HTTPperiodSeconds:600successThreshold:1timeoutSeconds:1name:elasticsearchports:- containerPort:9200name:es-httpprotocol:TCP- containerPort:9300name:es-transportprotocol:TCPreadinessProbe:failureThreshold:3httpGet:path:/_cluster/health?local=trueport:9200scheme:HTTPinitialDelaySeconds:30periodSeconds:20successThreshold:1timeoutSeconds:1resources:limits:cpu:\"2\"memory:10Girequests:cpu:\"1\"memory:8GisecurityContext:capabilities:add:- IPC_LOCK- SYS_RESOURCEprivileged:truerunAsUser:1000terminationMessagePath:/dev/termination-logterminationMessagePolicy:FilevolumeMounts:- mountPath:/usr/share/elasticsearch/dataname:es-data- mountPath:/usr/share/elasticsearch/logsname:es-logs- mountPath:/usr/share/elasticsearch/config/elasticsearch.ymlname:elasticsearch-configsubPath:elasticsearch.yml- mountPath:/var/run/secrets/kubernetes.io/serviceaccountname:default-token-k4r6freadOnly:truednsPolicy:ClusterFirstenableServiceLinks:truehostname:enode-0initContainers:- command:- sysctl- -w- vm.max_map_count=262144image:busyboximagePullPolicy:IfNotPresentname:init-sysctlresources:{}securityContext:privileged:trueterminationMessagePath:/dev/termination-logterminationMessagePolicy:FilevolumeMounts:- mountPath:/var/run/secrets/kubernetes.io/serviceaccountname:default-token-k4r6freadOnly:truepriority:0restartPolicy:AlwaysschedulerName:default-schedulersecurityContext:fsGroup:1000serviceAccount:defaultserviceAccountName:defaultsubdomain:elasticsearch-clusterterminationGracePeriodSeconds:30tolerations:- effect:NoExecutekey:node.kubernetes.io/not-readyoperator:ExiststolerationSeconds:300- effect:NoExecutekey:node.kubernetes.io/unreachableoperator:ExiststolerationSeconds:300volumes:- name:es-datapersistentVolumeClaim:claimName:es-data-enode-0- name:es-logspersistentVolumeClaim:claimName:es-logs-enode-0- configMap:defaultMode:420items:- key:elasticsearch.ymlpath:elasticsearch.ymlname:es-configname:elasticsearch-config- name:default-token-k4r6fsecret:defaultMode:420secretName:default-token-k4r6f ","date":"2020-06-18","objectID":"/pod%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%B4%E6%98%8E/:2:0","tags":["kubernetes","pod"],"title":"pod é…ç½®æ–‡ä»¶è¯´æ˜","uri":"/pod%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%B4%E6%98%8E/"},{"categories":null,"content":"ä½è¿ç®—åˆé›†","date":"2020-05-30","objectID":"/argorithm/bit/","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"ä½è¿ç®— è®¡ç®—æœºä¸­çš„æ•°åœ¨å†…å­˜ä¸­éƒ½æ˜¯ä»¥äºŒè¿›åˆ¶å½¢å¼è¿›è¡Œå­˜å‚¨çš„ï¼Œç”¨ä½è¿ç®—å°±æ˜¯ç›´æ¥å¯¹æ•´æ•°åœ¨å†…å­˜ä¸­çš„äºŒè¿›åˆ¶ä½è¿›è¡Œæ“ä½œï¼Œå› æ­¤å…¶æ‰§è¡Œæ•ˆç‡éå¸¸é«˜ï¼Œåœ¨ç¨‹åºä¸­å°½é‡ä½¿ç”¨ä½è¿ç®—è¿›è¡Œæ“ä½œï¼Œè¿™ä¼šå¤§å¤§æé«˜ç¨‹åºçš„æ€§èƒ½ã€‚ ","date":"2020-05-30","objectID":"/argorithm/bit/:0:0","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"ä½æ“ä½œç¬¦ ","date":"2020-05-30","objectID":"/argorithm/bit/:1:0","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"\u0026 ä¸è¿ç®— \u0026 ä¸è¿ç®— ä¸¤ä¸ªä½éƒ½æ˜¯ 1 æ—¶ï¼Œç»“æœæ‰ä¸º 1ï¼Œå¦åˆ™ä¸º 0ï¼Œå¦‚ 1 0 0 1 1 \u0026 1 1 0 0 1 ------------------------------ 1 0 0 0 1 ","date":"2020-05-30","objectID":"/argorithm/bit/:1:1","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"| æˆ–è¿ç®— ä¸¤ä¸ªä½éƒ½æ˜¯ 0 æ—¶ï¼Œç»“æœæ‰ä¸º 0ï¼Œå¦åˆ™ä¸º 1ï¼Œå¦‚ 1 0 0 1 1 | 1 1 0 0 1 ------------------------------ 1 1 0 1 1 ","date":"2020-05-30","objectID":"/argorithm/bit/:1:2","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"^ å¼‚æˆ–è¿ç®— ä¸¤ä¸ªä½ç›¸åŒåˆ™ä¸º 0ï¼Œä¸åŒåˆ™ä¸º 1ï¼Œå¦‚ 1 0 0 1 1 ^ 1 1 0 0 1 ----------------------------- 0 1 0 1 0 ","date":"2020-05-30","objectID":"/argorithm/bit/:1:3","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"~ å–åè¿ç®— 0 åˆ™å˜ä¸º 1ï¼Œ1 åˆ™å˜ä¸º 0ï¼Œå¦‚ ~ 1 0 0 1 1 ----------------------------- 0 1 1 0 0 ","date":"2020-05-30","objectID":"/argorithm/bit/:1:4","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"Â« å·¦ç§»è¿ç®— å‘å·¦è¿›è¡Œç§»ä½æ“ä½œï¼Œé«˜ä½ä¸¢å¼ƒï¼Œä½ä½è¡¥ 0,å¦‚ int a = 8; a \u003c\u003c 3; ç§»ä½å‰ï¼š0000 0000 0000 0000 0000 0000 0000 1000 ç§»ä½åï¼š0000 0000 0000 0000 0000 0000 0100 0000 å·¦ç§»nä¸ºçš„å€¼å³ä¸ºå½“å‰å€¼*2^n, å¦‚: a = 8 b = a\u003c\u003c3 # 64 c = a * (2 ** 3) # 64 ","date":"2020-05-30","objectID":"/argorithm/bit/:1:5","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"Â»å³ç§»è¿ç®— å‘å³è¿›è¡Œç§»ä½æ“ä½œï¼Œå¯¹æ— ç¬¦å·æ•°ï¼Œé«˜ä½è¡¥ 0ï¼Œå¯¹äºæœ‰ç¬¦å·æ•°ï¼Œé«˜ä½è¡¥ç¬¦å·ä½ï¼Œå¦‚ unsigned int a = 8; a \u003e\u003e 3; ç§»ä½å‰ï¼š0000 0000 0000 0000 0000 0000 0000 1000 ç§»ä½åï¼š0000 0000 0000 0000 0000 0000 0000 0001 â€‹ int a = -8; a \u003e\u003e 3; ç§»ä½å‰ï¼š1111 1111 1111 1111 1111 1111 1111 1000 ç§»ä½å‰ï¼š1111 1111 1111 1111 1111 1111 1111 1111 ","date":"2020-05-30","objectID":"/argorithm/bit/:1:6","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"æœ‰ç¬¦å·æ•°å’Œæ— ç¬¦å·æ•° ","date":"2020-05-30","objectID":"/argorithm/bit/:2:0","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"æœ‰ç¬¦å·æ•° æœ‰ç¬¦å·æ•°çš„å®šä¹‰æ˜¯ï¼šå­—èŠ‚çš„æœ€é«˜ä½ä½œä¸ºç¬¦å·ä½ï¼Œå…¶ä½™çš„æ˜¯æ•°å€¼ä½ã€‚ä¾‹å¦‚ä¸€ä¸ªå­—èŠ‚ä¸­å­˜å‚¨çš„äºŒè¿›åˆ¶æ•°ä¸º1100 1000ï¼Œæœ€é«˜ä½1ä½œä¸ºç¬¦å·ä½ï¼Œå…¶ä½™çš„7ä¸º 100 1000 ä½œä¸ºæ•°å€¼ä¸ºã€‚ é‚£ä¹ˆï¼Œç¬¦å·ä½å æ®1ä½ï¼Œå°±æœ‰0å’Œ1è¿™æ ·çš„ä¸¤ç§æ•°å€¼ï¼Œå°±æœ‰ï¼š å¦‚æœç¬¦å·ä½ä¸º0ï¼Œé‚£ä¹ˆå­—èŠ‚ä¸­å­˜å‚¨çš„æ•°å€¼æ˜¯æ­£æ•° å¦‚æœç¬¦å·ä½ä¸º1ï¼Œé‚£ä¹ˆå­—èŠ‚ä¸­å­˜å‚¨çš„æ•°å€¼æ˜¯è´Ÿæ•° å¯¹äº1100 1000è¿™æ ·çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œç¬¦å·ä½æ˜¯1ï¼Œå°±è¡¨ç¤ºè´Ÿæ•°ã€‚ åœ¨æœ‰ç¬¦å·æ•°ä¸­ï¼Œè¡¨ç¤ºè´Ÿæ•°çš„ç®—æ³•æ˜¯ï¼š æŠŠæ•°å€¼ä½ä¸­å­˜å‚¨çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œæ¯ä¸ªä½éƒ½å–åï¼Œå°±æ˜¯åŸæ¥ä¸º0çš„å€¼å˜ä¸º1ï¼ŒåŸæ¥ä¸º1çš„å€¼å˜ä¸º0ï¼› ç»™å¯¹å–ååçš„äºŒè¿›åˆ¶æ•°æ®åŠ 1ï¼Œå¾—åˆ°çš„æ•°å€¼å°±å¾—åˆ°è´Ÿæ•°å€¼ï¼› ","date":"2020-05-30","objectID":"/argorithm/bit/:2:1","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"æ— ç¬¦å·æ•° æ— ç¬¦å·æ•°çš„å®šä¹‰æ˜¯ï¼šæ²¡æœ‰ç¬¦å·ä½ï¼Œæ‰€æœ‰çš„ä½æ•°éƒ½æ˜¯æ•°å€¼ä½ã€‚æ‰€ä»¥è¡¨ç¤ºçš„éƒ½æ˜¯æ­£æ•°ã€‚ ","date":"2020-05-30","objectID":"/argorithm/bit/:2:2","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"ä¾‹å­ ä¾‹ä¸€ 1100 1000è¿™ä¸ªæ•°å€¼ï¼Œå¦‚æœä½œä¸ºæœ‰ç¬¦å·æ•°çœ‹å¾…ï¼Œé‚£ä¹ˆç¬¦å·ä½æ˜¯1ï¼Œæ•°å€¼ä½æ˜¯100 1000ã€‚æ‰€ä»¥ï¼Œç¬¦å·ä½æ˜¯1ï¼Œæ‰€ä»¥ï¼Œè¿™ä¸ªæ•°æ®æ˜¯è´Ÿæ•°ã€‚ç„¶åï¼Œè¡¨ç¤ºæˆåè¿›åˆ¶æ—¶ï¼Œå¯¹æ•°å€¼ä½çš„æ“ä½œæ˜¯ï¼š æ•°å€¼ä½å–åï¼Œå¾—åˆ°011 0111ï¼› å¯¹å–ååçš„æ•°å€¼ 011 0111åŠ 1å¾—åˆ°011 1000ï¼Œæ•°å€¼ä½çš„å€¼ä¸º56ï¼› é‚£ä¹ˆï¼Œ1100 1000è¿™ä¸ªäºŒè¿›åˆ¶æ•°æ®è¡¨ç¤ºä¸ºâ€œæœ‰ç¬¦å·æ•°â€æ—¶ï¼Œå°±æ˜¯-56è¿™ä¸ªæ•°å€¼ã€‚ å¦‚æœä½œä¸ºæ— ç¬¦å·æ•°çœ‹å¾…ï¼Œé‚£ä¹ˆï¼Œå°±æ²¡æœ‰ç¬¦å·ä½ï¼Œæ‰€æœ‰çš„ä½æ•°éƒ½æ˜¯æ•°å€¼ä½ï¼Œæ‰€ä»¥11001000éƒ½ä½œä¸ºæ•°å€¼ä½ï¼Œè¡¨ç¤ºçš„åè¿›åˆ¶æ•°å€¼æ˜¯200 ä¾‹äºŒ ä¾‹å¦‚ï¼Œ0111 0011è¿™ä¸ªæ•°å€¼ï¼Œå¦‚æœå½“åšâ€œæœ‰ç¬¦å·æ•°â€çœ‹å¾…ï¼Œé‚£ä¹ˆï¼Œå…¶ç¬¦å·ä½æ˜¯0ï¼Œæ‰€ä»¥ï¼Œè¡¨ç¤ºæ•´æ•°ï¼Œæ•°å€¼ä½æ˜¯115ï¼Œæ‰€ä»¥ï¼Œè¡¨ç¤ºæ­£115è¿™ä¸ªæ•°å€¼ã€‚å¦‚æœå½“åšæ— ç¬¦å·æ•°çœ‹å¾…ï¼Œæ‰€æœ‰ä½éƒ½æ˜¯æ•°å€¼ä½ï¼Œè®¡ç®—å¾—åˆ°115è¿™ä¸ªæ•°å€¼ï¼Œæ‰€ä»¥ï¼Œè¡¨ç¤ºæ­£115ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ€»ç»“ ","date":"2020-05-30","objectID":"/argorithm/bit/:2:3","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"æ€»ç»“ æ— ç¬¦å·æ•°ï¼Œæ€»æ˜¯è¡¨ç¤ºæ­£æ•°ã€‚æ‰€æœ‰ä½æ•°éƒ½è¡¨ç¤ºæ•°å€¼ä½ã€‚ æœ‰ç¬¦å·æ•°ï¼Œå¯ä»¥è¡¨ç¤ºæ­£æ•°å’Œè´Ÿæ•°ï¼Œæœ€é«˜ä½æ˜¯ç¬¦å·ä½ï¼Œå…¶ä½™ä½éƒ½æ˜¯æ•°å€¼ä½ã€‚å¦‚æœç¬¦å·ä½æ˜¯0ï¼Œåˆ™è¡¨ç¤ºæ­£æ•°ï¼›å¦‚æœç¬¦å·ä½æ˜¯1ï¼Œåˆ™è¡¨ç¤ºè´Ÿæ•°ã€‚å¯¹äºè´Ÿæ•°çš„è¡¨ç¤ºæ–¹æ³•æ˜¯ï¼šæ•°å€¼ä½å…¨éƒ¨å–åï¼Œå†åŠ 1ï¼Œå¾—åˆ°çš„æ•°å€¼å°±æ˜¯è´Ÿæ•°å€¼ã€‚ ","date":"2020-05-30","objectID":"/argorithm/bit/:2:4","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"åŸç ã€åç ã€è¡¥ç  ","date":"2020-05-30","objectID":"/argorithm/bit/:3:0","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"åŸç  åŸç çš„è¡¨ç¤ºèŒƒå›´-127~-0, +0~+127, å…±256ä¸ªæ•°å­— æ­£0çš„åŸç æ˜¯0000 0000, è´Ÿ0çš„åŸç æ˜¯1000 0000, æœ‰æ­£0è´Ÿ0ä¹‹åˆ†, ä¸ç¬¦åˆäººçš„ä¹ æƒ¯, å¾…è§£å†³. åŸç æœ‰å‡ ä¸ªç¼ºç‚¹ï¼Œé›¶åˆ†ä¸¤ç§ +0 å’Œ -0 ã€‚è¿˜æœ‰ï¼Œåœ¨è¿›è¡Œä¸åŒç¬¦å·çš„åŠ æ³•è¿ç®—æˆ–è€…åŒç¬¦å·çš„å‡æ³•è¿ç®—çš„æ—¶å€™ï¼Œä¸èƒ½ç›´æ¥åˆ¤æ–­å‡ºç»“æœçš„æ­£è´Ÿã€‚ä½ éœ€è¦å°†ä¸¤ä¸ªå€¼çš„ç»å¯¹å€¼è¿›è¡Œæ¯”è¾ƒï¼Œç„¶åè¿›è¡ŒåŠ å‡æ“ä½œ ï¼Œæœ€åç¬¦å·ä½ç”±ç»å¯¹å€¼å¤§çš„å†³å®šã€‚äºæ˜¯åç å°±äº§ç”Ÿäº†ã€‚ ","date":"2020-05-30","objectID":"/argorithm/bit/:3:1","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"åç  é™¤ç¬¦å·ä½, åŸç å…¶ä½™ä½å–åè€Œå¾— +0ï¼š0000 0000ï¼Œ-0ï¼š1111 1111 ä»ç„¶æœ‰æ­£0è´Ÿ0ä¹‹åˆ†ã€‚ æ­£æ•°çš„åç å°±æ˜¯åŸç ï¼Œè´Ÿæ•°çš„åç ç­‰äºåŸç é™¤ç¬¦å·ä½ä»¥å¤–æ‰€æœ‰çš„ä½å–å ä¸¾ä¾‹è¯´æ˜ï¼š intç±»å‹çš„ 3 çš„åç æ˜¯ 00000000 00000000 00000000 00000011 å’ŒåŸç ä¸€æ ·æ²¡ä»€ä¹ˆå¯è¯´çš„ intç±»å‹çš„ -3 çš„åç æ˜¯ 11111111 11111111 11111111 11111100 é™¤å¼€ç¬¦å·ä½ æ‰€æœ‰ä½ å–å è§£å†³äº†åŠ å‡è¿ç®—çš„é—®é¢˜ï¼Œä½†è¿˜æ˜¯æœ‰æ­£è´Ÿé›¶ä¹‹åˆ†ï¼Œç„¶åå°±åˆ°è¡¥ç äº† ","date":"2020-05-30","objectID":"/argorithm/bit/:3:2","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"è¡¥ç  åœ¨åç çš„åŸºç¡€ä¸ŠåŠ 1è€Œå¾— å¯¹åŸç çš„ä¸¤ç§0åŒæ—¶æœ«ä½åŠ 1 +0ï¼š0000 0000ï¼Œ-0ï¼š0000 0000(å› ä¸ºæº¢å‡ºå¯¼è‡´8ä½å…¨0) æ¶ˆé™¤äº†æ­£0è´Ÿ0ä¹‹åˆ«, å¦‚æ­¤ä¸€æ¥, ä¾¿èŠ‚çœå‡ºä¸€ä¸ªæ•°å€¼è¡¨ç¤ºæ–¹å¼1000 0000, ä¸èƒ½æµªè´¹, ç”¨æ¥è¡¨ç¤º-128, -128ç‰¹æ®Šä¹‹å¤„åœ¨äºæ²¡æœ‰ç›¸åº”çš„åç åŸç ã€‚ä¹Ÿå¯ä»¥è¿™æ ·è€ƒè™‘: -1ï¼š 1111 1111 -2ï¼š 1111 1110ï¼ˆåœ¨-1çš„åŸºç¡€ä¸Šå‡1ï¼Œç›´æ¥å°†è¡¥ç å‡1å³å¯ï¼‰ -3ï¼š 1111 1101ï¼ˆåœ¨-2è¡¥ç åŸºç¡€ä¸Šå‡1ï¼Œä»¥ä¸‹ç±»ä¼¼ï¼‰ -4ï¼š 1111 1100 â€¦â€¦ -127ï¼š1000 0001 -128ï¼š1000 0000 å¦‚æ­¤ä»¥æ¥ï¼š8ä½è¡¥ç è¡¨ç¤ºèŒƒå›´æ˜¯-128~+127å› ä¸º0åªæœ‰ä¸€ç§å½¢å¼æ‰€ä»¥ï¼Œä»ç„¶æ˜¯256ä¸ªæ•° è‹¥8ä½ä»£è¡¨æ— ç¬¦å·æ•°, åˆ™è¡¨ç¤ºèŒƒå›´æ˜¯ : 0~255, è¿™å°±æ˜¯ä¸ºä»€ä¹ˆé«˜çº§è¯­è¨€è®²åˆ°æ•°æ®ç±»å‹ï¼Œ æ­£æ•°çš„è¡¥ç ä¸åŸç ç›¸åŒï¼Œè´Ÿæ•°çš„è¡¥ç ä¸º å…¶åŸç é™¤ç¬¦å·ä½å¤–æ‰€æœ‰ä½å–åï¼ˆå¾—åˆ°åç äº†ï¼‰ï¼Œç„¶åæœ€ä½ä½åŠ 1 ","date":"2020-05-30","objectID":"/argorithm/bit/:3:3","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"åŸç ï¼Œåç ï¼Œè¡¥ç æ€»ç»“ æ­£æ•°çš„åç å’Œè¡¥ç éƒ½ä¸åŸç ç›¸åŒã€‚ è´Ÿæ•°çš„åç ä¸ºå¯¹è¯¥æ•°çš„åŸç é™¤ç¬¦å·ä½å¤–å„ä½å–åã€‚ è´Ÿæ•°çš„è¡¥ç ä¸ºå¯¹è¯¥æ•°çš„åŸç é™¤ç¬¦å·ä½å¤–å„ä½å–åï¼Œç„¶ååœ¨æœ€åä¸€ä½åŠ 1ã€€ ä¼˜ç¼ºç‚¹: åŸç æœ€å¥½ç†è§£äº†ï¼Œä½†æ˜¯åŠ å‡æ³•ä¸å¤Ÿæ–¹ä¾¿ï¼Œè¿˜æœ‰ä¸¤ä¸ªé›¶ã€‚ã€‚ åç ç¨å¾®å›°éš¾ä¸€äº›ï¼Œè§£å†³äº†åŠ å‡æ³•çš„é—®é¢˜ï¼Œä½†è¿˜æ˜¯æœ‰æœ‰ä¸ªé›¶ è¡¥ç ç†è§£å›°éš¾ï¼Œå…¶ä»–å°±æ²¡ä»€ä¹ˆç¼ºç‚¹äº† ","date":"2020-05-30","objectID":"/argorithm/bit/:3:4","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"å­˜å‚¨ è®¡ç®—æœºä¸­çš„æ•´æ•°æ˜¯ç”¨è¡¥ç å­˜å‚¨çš„ï¼Œæœ€é«˜ä½ä¸ºç¬¦å·ä½ å¦‚æœæœ€é«˜ä½ä¸º0åˆ™ä¸ºæ­£æ•°ï¼Œæ±‚å€¼çš„æ—¶å€™ï¼Œç›´æ¥è½¬ä¸º10è¿›åˆ¶å³å¯ã€‚ æœ€é«˜ä½å¦‚æœä¸º1ä»£è¡¨ä¸ºè´Ÿæ•°ï¼Œæ±‚å€¼çš„æ—¶å€™ï¼Œéœ€è¦å…ˆæŠŠäºŒè¿›åˆ¶çš„å€¼æŒ‰ä½å–åï¼Œç„¶ååŠ 1å¾—åˆ°è´Ÿæ•°ç»å¯¹å€¼(ç›¸åæ•°)çš„äºŒè¿›åˆ¶ç ï¼Œç„¶åè½¬ä¸º10è¿›åˆ¶ï¼ŒåŠ ä¸Šè´Ÿå·å³å¯ã€‚ ","date":"2020-05-30","objectID":"/argorithm/bit/:3:5","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"åŸç ï¼Œåç ï¼Œè¡¥ç çš„åº”ç”¨ ","date":"2020-05-30","objectID":"/argorithm/bit/:3:6","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"è´Ÿæ•°çš„åè¿›åˆ¶å’ŒäºŒè¿›åˆ¶è½¬æ¢ ","date":"2020-05-30","objectID":"/argorithm/bit/:4:0","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"åè¿›åˆ¶è½¬äºŒè¿›åˆ¶ æ–¹æ³•ä¸º: å…ˆè½¬æ¢ä¸ºäºŒè¿›åˆ¶ å¯¹äºŒè¿›åˆ¶æ•°æ±‚å å†å°†è¯¥äºŒè¿›åˆ¶æ•°åŠ ä¸€ æ€»è€Œè¨€ä¹‹: åè¿›åˆ¶æ•°è½¬æ¢ä¸ºäºŒè¿›åˆ¶æ•°æ±‚è¡¥ç å³ä¸ºç»“æœ ä¾‹å­ -32 è½¬æ¢ä¸ºäºŒè¿›åˆ¶ ç¬¬ä¸€æ­¥ï¼š32ï¼ˆ10ï¼‰=00100000ï¼ˆ2ï¼‰ ç¬¬äºŒæ­¥ï¼šæ±‚åï¼š11011111 ç¬¬ä¸‰æ­¥ï¼šåŠ 1:11100000 æ‰€ä»¥-32ï¼ˆ10ï¼‰=11100000ï¼ˆ2ï¼‰ ","date":"2020-05-30","objectID":"/argorithm/bit/:4:1","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"äºŒè¿›åˆ¶è½¬åè¿›åˆ¶ æ–¹æ³•ä¸º: æ•°å€¼ä¸ºå–å å¯¹è¯¥äºŒè¿›åˆ¶åŠ ä¸€ è½¬æ¢ä¸º10è¿›åˆ¶ ä¾‹å­ 11001000 è½¬æ¢ä¸ºåè¿›åˆ¶ ç¬¬ä¸€æ­¥ï¼ˆæ•°å€¼ä½å–åï¼‰ï¼š 10110111 ç¬¬äºŒæ­¥ï¼ˆåŠ ä¸€ï¼‰ï¼š10111000 ç¬¬ä¸‰æ­¥ï¼ˆåè¿›åˆ¶ï¼‰ï¼š-56 æ‰€ä»¥11001000ï¼ˆ2ï¼‰=-56ï¼ˆ10ï¼‰ ","date":"2020-05-30","objectID":"/argorithm/bit/:4:2","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"åè¿›åˆ¶æ•°æ±‚åçš„è§„å¾‹ ä¸‹é¢éƒ½æ˜¯ä»¥10è¿›åˆ¶è¡¨ç¤º: ","date":"2020-05-30","objectID":"/argorithm/bit/:5:0","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"è´Ÿæ•°æ±‚å è´Ÿæ•°æ±‚åç­‰äºå…¶ç»å¯¹å€¼ -1 å¦‚: num = -5 num1 = ~num # 4 ","date":"2020-05-30","objectID":"/argorithm/bit/:5:1","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"æ­£æ•°æ±‚å æ­£æ•°æ±‚åç­‰äºå…¶å€¼ +1 çš„è´Ÿæ•° å¦‚: num = 4 num1 = ~num # -5 ","date":"2020-05-30","objectID":"/argorithm/bit/:5:2","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"äºŒè¿›åˆ¶çš„åº”ç”¨åœºæ™¯ ","date":"2020-05-30","objectID":"/argorithm/bit/:6:0","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"ä½æ“ä½œå®ç°ä¹˜é™¤æ³• æ•° a å‘å³ç§»ä¸€ä½ï¼Œç›¸å½“äºå°† a é™¤ä»¥ 2ï¼›æ•° a å‘å·¦ç§»ä¸€ä½ï¼Œç›¸å½“äºå°† a ä¹˜ä»¥ 2 a = 2 a \u003e\u003e 1 # ---\u003e 1 a \u003c\u003c 1 # ---\u003e 4 ","date":"2020-05-30","objectID":"/argorithm/bit/:6:1","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"ä½æ“ä½œäº¤æ¢ä¸¤æ•° ä½æ“ä½œäº¤æ¢ä¸¤æ•°å¯ä»¥ä¸éœ€è¦ç¬¬ä¸‰ä¸ªä¸´æ—¶å˜é‡ï¼Œè™½ç„¶æ™®é€šæ“ä½œä¹Ÿå¯ä»¥åšåˆ°ï¼Œä½†æ˜¯æ²¡æœ‰å…¶æ•ˆç‡é«˜ # æ™®é€šæ“ä½œ def swap(a: int, b: int) -\u003e(int,int): a = a + b b = a - b a = a - b return a,b # ä½ä¸æ“ä½œ def swap(a: int, b: int) -\u003e (int, int): \"\"\" äº¤æ¢ä¸¤ä¸ªæ•° :param a: :param b: :return: \"\"\" a ^= b # a = (a^b) b ^= a # b = b ^ a = b ^ a ^ b a ^= b # a = a ^ b = a ^ a ^ b return a, b ","date":"2020-05-30","objectID":"/argorithm/bit/:6:2","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"ä½æ“ä½œåˆ¤æ–­å¥‡å¶æ•° åªè¦æ ¹æ®æ•°çš„æœ€åä¸€ä½æ˜¯ 0 è¿˜æ˜¯ 1 æ¥å†³å®šå³å¯ï¼Œä¸º 0 å°±æ˜¯å¶æ•°ï¼Œä¸º 1 å°±æ˜¯å¥‡æ•° if(0 == (a \u0026 1)) { //å¶æ•° } ","date":"2020-05-30","objectID":"/argorithm/bit/:6:3","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"ä½æ“ä½œäº¤æ¢ç¬¦å· äº¤æ¢ç¬¦å·å°†æ­£æ•°å˜æˆè´Ÿæ•°ï¼Œè´Ÿæ•°å˜æˆæ­£æ•° func reversal(a int) int { return ^a + 1 } def reversal(a: int) -\u003e int: \"\"\" æ±‚ç›¸åæ•° :param a: :return: \"\"\" return ~a + 1 æ­£æ•°å–ååŠ 1ï¼Œæ­£å¥½å˜æˆå…¶å¯¹åº”çš„è´Ÿæ•°(è¡¥ç è¡¨ç¤º)ï¼›è´Ÿæ•°å–ååŠ ä¸€ï¼Œåˆ™å˜ä¸ºå…¶åŸç ï¼Œå³æ­£æ•° ","date":"2020-05-30","objectID":"/argorithm/bit/:6:4","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"ä½æ“ä½œæ±‚ç»å¯¹å€¼ æ­£æ•°çš„ç»å¯¹å€¼æ˜¯å…¶æœ¬èº«ï¼Œè´Ÿæ•°çš„ç»å¯¹å€¼æ­£å¥½å¯ä»¥å¯¹å…¶è¿›è¡Œå–ååŠ ä¸€æ±‚å¾—ï¼Œå³æˆ‘ä»¬é¦–å…ˆåˆ¤æ–­å…¶ç¬¦å·ä½ï¼ˆæ•´æ•°å³ç§» 31 ä½å¾—åˆ° 0ï¼Œè´Ÿæ•°å³ç§» 31 ä½å¾—åˆ° -1,å³ 0xffffffffï¼‰ï¼Œç„¶åæ ¹æ®ç¬¦å·è¿›è¡Œç›¸åº”çš„æ“ä½œ def abs(a: int) -\u003e int: i = a \u003e\u003e 31 result = a if i == 0 else ~a + 1 return result ä¸Šé¢çš„æ“ä½œå¯ä»¥è¿›è¡Œä¼˜åŒ–ï¼Œå¯ä»¥å°† i == 0 çš„æ¡ä»¶åˆ¤æ–­è¯­å¥å»æ‰ã€‚æˆ‘ä»¬éƒ½çŸ¥é“ç¬¦å·ä½ i åªæœ‰ä¸¤ç§æƒ…å†µï¼Œå³ i = 0 ä¸ºæ­£ï¼Œi = -1 ä¸ºè´Ÿã€‚å¯¹äºä»»ä½•æ•°ä¸ 0 å¼‚æˆ–éƒ½ä¼šä¿æŒä¸å˜ï¼Œä¸ -1 å³ 0xffffffff è¿›è¡Œå¼‚æˆ–å°±ç›¸å½“äºå¯¹æ­¤æ•°è¿›è¡Œå–å,å› æ­¤å¯ä»¥å°†ä¸Šé¢ä¸‰ç›®å…ƒç®—ç¬¦è½¬æ¢ä¸º((a^i)-i)ï¼Œå³æ•´æ•°æ—¶ a ä¸ 0 å¼‚æˆ–å¾—åˆ°æœ¬èº«ï¼Œå†å‡å» 0ï¼Œè´Ÿæ•°æ—¶ä¸ 0xffffffff å¼‚æˆ–å°† a è¿›è¡Œå–åï¼Œç„¶ååœ¨åŠ ä¸Š 1ï¼Œå³å‡å» i(i =-1) def abs(a: int) -\u003e int: \"\"\" æ±‚ç»å¯¹å€¼ :param a: :return: \"\"\" i = a \u003e\u003e 31 result = (a ^ i) - i return result or func abs(a int) int { i := a \u003e\u003e 31 return (a ^ i) - i } ","date":"2020-05-30","objectID":"/argorithm/bit/:6:5","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"ä½æ“ä½œè¿›è¡Œé«˜ä½ä½äº¤æ¢ ç»™å®šä¸€ä¸ª 16 ä½çš„æ— ç¬¦å·æ•´æ•°ï¼Œå°†å…¶é«˜ 8 ä½ä¸ä½ 8 ä½è¿›è¡Œäº¤æ¢ï¼Œæ±‚å‡ºäº¤æ¢åçš„å€¼ï¼Œå¦‚ ä»ä¸Šé¢ç§»ä½æ“ä½œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œåªè¦å°†æ— ç¬¦å·æ•° aÂ»8 å³å¯å¾—åˆ°å…¶é«˜ 8 ä½ç§»åˆ°ä½ 8 ä½ï¼Œé«˜ä½è¡¥ 0ï¼›å°† a Â« 8 å³å¯å°† ä½ 8 ä½ç§»åˆ°é«˜ 8 ä½ï¼Œä½ 8 ä½è¡¥ 0ï¼Œç„¶åå°† a Â» 8 å’Œ aÂ«8 è¿›è¡Œæˆ–æ“ä½œæ—¢å¯æ±‚å¾—äº¤æ¢åçš„ç»“æœ ã€‚ unsigned short a = 34520; a = (a \u003e\u003e 8) | (a \u003c\u003c 8); ","date":"2020-05-30","objectID":"/argorithm/bit/:6:6","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"ä½æ“ä½œç»Ÿè®¡äºŒè¿›åˆ¶ä¸­ 1 çš„ä¸ªæ•° ç»Ÿè®¡äºŒè¿›åˆ¶1çš„ä¸ªæ•°å¯ä»¥åˆ†åˆ«è·å–æ¯ä¸ªäºŒè¿›åˆ¶ä½æ•°ï¼Œç„¶åå†ç»Ÿè®¡å…¶1çš„ä¸ªæ•°ï¼Œæ­¤æ–¹æ³•æ•ˆç‡æ¯”è¾ƒä½ã€‚ è¿™é‡Œä»‹ç»å¦å¤–ä¸€ç§é«˜æ•ˆçš„æ–¹æ³•ï¼ŒåŒæ ·ä»¥ 34520 ä¸ºä¾‹ï¼Œ æˆ‘ä»¬è®¡ç®—å…¶ a \u0026= (a-1)çš„ç»“æœï¼š ç¬¬ä¸€æ¬¡ï¼šè®¡ç®—å‰ï¼š1000 0110 1101 1000 è®¡ç®—åï¼š1000 0110 1101 0000 ç¬¬äºŒæ¬¡ï¼šè®¡ç®—å‰ï¼š1000 0110 1101 0000 è®¡ç®—åï¼š1000 0110 1100 0000 ç¬¬ä¸‰æ¬¡ï¼šè®¡ç®—å‰ï¼š1000 0110 1100 0000 è®¡ç®—åï¼š1000 0110 1000 0000 æˆ‘ä»¬å‘ç°ï¼Œæ¯è®¡ç®—ä¸€æ¬¡äºŒè¿›åˆ¶ä¸­å°±å°‘äº†ä¸€ä¸ª 1ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢æ–¹æ³•å»ç»Ÿè®¡ï¼šcount = 0 def count_1(a: int) -\u003e int: \"\"\" è®¡ç®—æ•°å€¼çš„äºŒè¿›åˆ¶è¡¨ç¤ºçš„1çš„æ•°é‡ :param a: :return: \"\"\" count = 0 while (a): a = a \u0026 a - 1 count += 1 return count ","date":"2020-05-30","objectID":"/argorithm/bit/:6:7","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"æ±‚å’Œ ä¸¤æ•°æ±‚å’Œ func add(a int, b int) int { for b != 0 { sum := a ^ b carry := (a \u0026 b) \u003c\u003c 1 a = sum b = carry } return a } ","date":"2020-05-30","objectID":"/argorithm/bit/:6:8","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"æ¯”ç‰¹ä½è®¡æ•° ç»™å®šä¸€ä¸ªéè´Ÿæ•´æ•° numã€‚å¯¹äº 0 â‰¤ i â‰¤ num èŒƒå›´ä¸­çš„æ¯ä¸ªæ•°å­— i ï¼Œè®¡ç®—å…¶äºŒè¿›åˆ¶æ•°ä¸­çš„ 1 çš„æ•°ç›®å¹¶å°†å®ƒä»¬ä½œä¸ºæ•°ç»„è¿”å›ã€‚ ç¤ºä¾‹ 1: è¾“å…¥: 2 è¾“å‡º: [0,1,1] ç¤ºä¾‹ 2: è¾“å…¥: 5 è¾“å‡º: [0,1,1,2,1,2] def countBits(num: int) -\u003e [int]: result = [0] * (num + 1) for i in range(1, num + 1): result[i] = result[i \u0026 i - 1] + 1 return result func countBits(num int) []int { result := make([]int, num+1) for i := 1; i \u003c num+1 ; i ++ { result[i] = result[i \u0026 (i-1)] + 1 } return result } ","date":"2020-05-30","objectID":"/argorithm/bit/:6:9","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"å¸¸ç”¨çš„ç‰¹æ®Šçš„æ•° 0xaaaaaaaa = 10101010101010101010101010101010 (å¶æ•°ä½ä¸º1ï¼Œå¥‡æ•°ä½ä¸º0ï¼‰ 0x55555555 = 1010101010101010101010101010101 (å¶æ•°ä½ä¸º0ï¼Œå¥‡æ•°ä½ä¸º1ï¼‰ 0x33333333 = 110011001100110011001100110011 (1å’Œ0æ¯éš”ä¸¤ä½äº¤æ›¿å‡ºç°) 0xcccccccc = 11001100110011001100110011001100Â (0å’Œ1æ¯éš”ä¸¤ä½äº¤æ›¿å‡ºç°) 0x0f0f0f0f = 00001111000011110000111100001111Â (1å’Œ0æ¯éš”å››ä½äº¤æ›¿å‡ºç°) 0xf0f0f0f0 = 11110000111100001111000011110000Â (0å’Œ1æ¯éš”å››ä½äº¤æ›¿å‡ºç°) 0xffffffff = 11111111111111111111111111111111 ","date":"2020-05-30","objectID":"/argorithm/bit/:7:0","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/argorithm/bit/"},{"categories":null,"content":"ä½è¿ç®—åˆé›†","date":"2020-05-30","objectID":"/bit/","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"ä½è¿ç®— è®¡ç®—æœºä¸­çš„æ•°åœ¨å†…å­˜ä¸­éƒ½æ˜¯ä»¥äºŒè¿›åˆ¶å½¢å¼è¿›è¡Œå­˜å‚¨çš„ï¼Œç”¨ä½è¿ç®—å°±æ˜¯ç›´æ¥å¯¹æ•´æ•°åœ¨å†…å­˜ä¸­çš„äºŒè¿›åˆ¶ä½è¿›è¡Œæ“ä½œï¼Œå› æ­¤å…¶æ‰§è¡Œæ•ˆç‡éå¸¸é«˜ï¼Œåœ¨ç¨‹åºä¸­å°½é‡ä½¿ç”¨ä½è¿ç®—è¿›è¡Œæ“ä½œï¼Œè¿™ä¼šå¤§å¤§æé«˜ç¨‹åºçš„æ€§èƒ½ã€‚ ","date":"2020-05-30","objectID":"/bit/:0:0","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"ä½æ“ä½œç¬¦ ","date":"2020-05-30","objectID":"/bit/:1:0","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"\u0026 ä¸è¿ç®— \u0026 ä¸è¿ç®— ä¸¤ä¸ªä½éƒ½æ˜¯ 1 æ—¶ï¼Œç»“æœæ‰ä¸º 1ï¼Œå¦åˆ™ä¸º 0ï¼Œå¦‚ 1 0 0 1 1 \u0026 1 1 0 0 1 ------------------------------ 1 0 0 0 1 ","date":"2020-05-30","objectID":"/bit/:1:1","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"| æˆ–è¿ç®— ä¸¤ä¸ªä½éƒ½æ˜¯ 0 æ—¶ï¼Œç»“æœæ‰ä¸º 0ï¼Œå¦åˆ™ä¸º 1ï¼Œå¦‚ 1 0 0 1 1 | 1 1 0 0 1 ------------------------------ 1 1 0 1 1 ","date":"2020-05-30","objectID":"/bit/:1:2","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"^ å¼‚æˆ–è¿ç®— ä¸¤ä¸ªä½ç›¸åŒåˆ™ä¸º 0ï¼Œä¸åŒåˆ™ä¸º 1ï¼Œå¦‚ 1 0 0 1 1 ^ 1 1 0 0 1 ----------------------------- 0 1 0 1 0 ","date":"2020-05-30","objectID":"/bit/:1:3","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"~ å–åè¿ç®— 0 åˆ™å˜ä¸º 1ï¼Œ1 åˆ™å˜ä¸º 0ï¼Œå¦‚ ~ 1 0 0 1 1 ----------------------------- 0 1 1 0 0 ","date":"2020-05-30","objectID":"/bit/:1:4","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"Â« å·¦ç§»è¿ç®— å‘å·¦è¿›è¡Œç§»ä½æ“ä½œï¼Œé«˜ä½ä¸¢å¼ƒï¼Œä½ä½è¡¥ 0,å¦‚ int a = 8; a \u003c\u003c 3; ç§»ä½å‰ï¼š0000 0000 0000 0000 0000 0000 0000 1000 ç§»ä½åï¼š0000 0000 0000 0000 0000 0000 0100 0000 å·¦ç§»nä¸ºçš„å€¼å³ä¸ºå½“å‰å€¼*2^n, å¦‚: a = 8 b = a\u003c\u003c3 # 64 c = a * (2 ** 3) # 64 ","date":"2020-05-30","objectID":"/bit/:1:5","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"Â»å³ç§»è¿ç®— å‘å³è¿›è¡Œç§»ä½æ“ä½œï¼Œå¯¹æ— ç¬¦å·æ•°ï¼Œé«˜ä½è¡¥ 0ï¼Œå¯¹äºæœ‰ç¬¦å·æ•°ï¼Œé«˜ä½è¡¥ç¬¦å·ä½ï¼Œå¦‚ unsigned int a = 8; a \u003e\u003e 3; ç§»ä½å‰ï¼š0000 0000 0000 0000 0000 0000 0000 1000 ç§»ä½åï¼š0000 0000 0000 0000 0000 0000 0000 0001 â€‹ int a = -8; a \u003e\u003e 3; ç§»ä½å‰ï¼š1111 1111 1111 1111 1111 1111 1111 1000 ç§»ä½å‰ï¼š1111 1111 1111 1111 1111 1111 1111 1111 ","date":"2020-05-30","objectID":"/bit/:1:6","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"æœ‰ç¬¦å·æ•°å’Œæ— ç¬¦å·æ•° ","date":"2020-05-30","objectID":"/bit/:2:0","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"æœ‰ç¬¦å·æ•° æœ‰ç¬¦å·æ•°çš„å®šä¹‰æ˜¯ï¼šå­—èŠ‚çš„æœ€é«˜ä½ä½œä¸ºç¬¦å·ä½ï¼Œå…¶ä½™çš„æ˜¯æ•°å€¼ä½ã€‚ä¾‹å¦‚ä¸€ä¸ªå­—èŠ‚ä¸­å­˜å‚¨çš„äºŒè¿›åˆ¶æ•°ä¸º1100 1000ï¼Œæœ€é«˜ä½1ä½œä¸ºç¬¦å·ä½ï¼Œå…¶ä½™çš„7ä¸º 100 1000 ä½œä¸ºæ•°å€¼ä¸ºã€‚ é‚£ä¹ˆï¼Œç¬¦å·ä½å æ®1ä½ï¼Œå°±æœ‰0å’Œ1è¿™æ ·çš„ä¸¤ç§æ•°å€¼ï¼Œå°±æœ‰ï¼š å¦‚æœç¬¦å·ä½ä¸º0ï¼Œé‚£ä¹ˆå­—èŠ‚ä¸­å­˜å‚¨çš„æ•°å€¼æ˜¯æ­£æ•° å¦‚æœç¬¦å·ä½ä¸º1ï¼Œé‚£ä¹ˆå­—èŠ‚ä¸­å­˜å‚¨çš„æ•°å€¼æ˜¯è´Ÿæ•° å¯¹äº1100 1000è¿™æ ·çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œç¬¦å·ä½æ˜¯1ï¼Œå°±è¡¨ç¤ºè´Ÿæ•°ã€‚ åœ¨æœ‰ç¬¦å·æ•°ä¸­ï¼Œè¡¨ç¤ºè´Ÿæ•°çš„ç®—æ³•æ˜¯ï¼š æŠŠæ•°å€¼ä½ä¸­å­˜å‚¨çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œæ¯ä¸ªä½éƒ½å–åï¼Œå°±æ˜¯åŸæ¥ä¸º0çš„å€¼å˜ä¸º1ï¼ŒåŸæ¥ä¸º1çš„å€¼å˜ä¸º0ï¼› ç»™å¯¹å–ååçš„äºŒè¿›åˆ¶æ•°æ®åŠ 1ï¼Œå¾—åˆ°çš„æ•°å€¼å°±å¾—åˆ°è´Ÿæ•°å€¼ï¼› ","date":"2020-05-30","objectID":"/bit/:2:1","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"æ— ç¬¦å·æ•° æ— ç¬¦å·æ•°çš„å®šä¹‰æ˜¯ï¼šæ²¡æœ‰ç¬¦å·ä½ï¼Œæ‰€æœ‰çš„ä½æ•°éƒ½æ˜¯æ•°å€¼ä½ã€‚æ‰€ä»¥è¡¨ç¤ºçš„éƒ½æ˜¯æ­£æ•°ã€‚ ","date":"2020-05-30","objectID":"/bit/:2:2","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"ä¾‹å­ ä¾‹ä¸€ 1100 1000è¿™ä¸ªæ•°å€¼ï¼Œå¦‚æœä½œä¸ºæœ‰ç¬¦å·æ•°çœ‹å¾…ï¼Œé‚£ä¹ˆç¬¦å·ä½æ˜¯1ï¼Œæ•°å€¼ä½æ˜¯100 1000ã€‚æ‰€ä»¥ï¼Œç¬¦å·ä½æ˜¯1ï¼Œæ‰€ä»¥ï¼Œè¿™ä¸ªæ•°æ®æ˜¯è´Ÿæ•°ã€‚ç„¶åï¼Œè¡¨ç¤ºæˆåè¿›åˆ¶æ—¶ï¼Œå¯¹æ•°å€¼ä½çš„æ“ä½œæ˜¯ï¼š æ•°å€¼ä½å–åï¼Œå¾—åˆ°011 0111ï¼› å¯¹å–ååçš„æ•°å€¼ 011 0111åŠ 1å¾—åˆ°011 1000ï¼Œæ•°å€¼ä½çš„å€¼ä¸º56ï¼› é‚£ä¹ˆï¼Œ1100 1000è¿™ä¸ªäºŒè¿›åˆ¶æ•°æ®è¡¨ç¤ºä¸ºâ€œæœ‰ç¬¦å·æ•°â€æ—¶ï¼Œå°±æ˜¯-56è¿™ä¸ªæ•°å€¼ã€‚ å¦‚æœä½œä¸ºæ— ç¬¦å·æ•°çœ‹å¾…ï¼Œé‚£ä¹ˆï¼Œå°±æ²¡æœ‰ç¬¦å·ä½ï¼Œæ‰€æœ‰çš„ä½æ•°éƒ½æ˜¯æ•°å€¼ä½ï¼Œæ‰€ä»¥11001000éƒ½ä½œä¸ºæ•°å€¼ä½ï¼Œè¡¨ç¤ºçš„åè¿›åˆ¶æ•°å€¼æ˜¯200 ä¾‹äºŒ ä¾‹å¦‚ï¼Œ0111 0011è¿™ä¸ªæ•°å€¼ï¼Œå¦‚æœå½“åšâ€œæœ‰ç¬¦å·æ•°â€çœ‹å¾…ï¼Œé‚£ä¹ˆï¼Œå…¶ç¬¦å·ä½æ˜¯0ï¼Œæ‰€ä»¥ï¼Œè¡¨ç¤ºæ•´æ•°ï¼Œæ•°å€¼ä½æ˜¯115ï¼Œæ‰€ä»¥ï¼Œè¡¨ç¤ºæ­£115è¿™ä¸ªæ•°å€¼ã€‚å¦‚æœå½“åšæ— ç¬¦å·æ•°çœ‹å¾…ï¼Œæ‰€æœ‰ä½éƒ½æ˜¯æ•°å€¼ä½ï¼Œè®¡ç®—å¾—åˆ°115è¿™ä¸ªæ•°å€¼ï¼Œæ‰€ä»¥ï¼Œè¡¨ç¤ºæ­£115ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ€»ç»“ ","date":"2020-05-30","objectID":"/bit/:2:3","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"æ€»ç»“ æ— ç¬¦å·æ•°ï¼Œæ€»æ˜¯è¡¨ç¤ºæ­£æ•°ã€‚æ‰€æœ‰ä½æ•°éƒ½è¡¨ç¤ºæ•°å€¼ä½ã€‚ æœ‰ç¬¦å·æ•°ï¼Œå¯ä»¥è¡¨ç¤ºæ­£æ•°å’Œè´Ÿæ•°ï¼Œæœ€é«˜ä½æ˜¯ç¬¦å·ä½ï¼Œå…¶ä½™ä½éƒ½æ˜¯æ•°å€¼ä½ã€‚å¦‚æœç¬¦å·ä½æ˜¯0ï¼Œåˆ™è¡¨ç¤ºæ­£æ•°ï¼›å¦‚æœç¬¦å·ä½æ˜¯1ï¼Œåˆ™è¡¨ç¤ºè´Ÿæ•°ã€‚å¯¹äºè´Ÿæ•°çš„è¡¨ç¤ºæ–¹æ³•æ˜¯ï¼šæ•°å€¼ä½å…¨éƒ¨å–åï¼Œå†åŠ 1ï¼Œå¾—åˆ°çš„æ•°å€¼å°±æ˜¯è´Ÿæ•°å€¼ã€‚ ","date":"2020-05-30","objectID":"/bit/:2:4","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"åŸç ã€åç ã€è¡¥ç  ","date":"2020-05-30","objectID":"/bit/:3:0","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"åŸç  åŸç çš„è¡¨ç¤ºèŒƒå›´-127~-0, +0~+127, å…±256ä¸ªæ•°å­— æ­£0çš„åŸç æ˜¯0000 0000, è´Ÿ0çš„åŸç æ˜¯1000 0000, æœ‰æ­£0è´Ÿ0ä¹‹åˆ†, ä¸ç¬¦åˆäººçš„ä¹ æƒ¯, å¾…è§£å†³. åŸç æœ‰å‡ ä¸ªç¼ºç‚¹ï¼Œé›¶åˆ†ä¸¤ç§ +0 å’Œ -0 ã€‚è¿˜æœ‰ï¼Œåœ¨è¿›è¡Œä¸åŒç¬¦å·çš„åŠ æ³•è¿ç®—æˆ–è€…åŒç¬¦å·çš„å‡æ³•è¿ç®—çš„æ—¶å€™ï¼Œä¸èƒ½ç›´æ¥åˆ¤æ–­å‡ºç»“æœçš„æ­£è´Ÿã€‚ä½ éœ€è¦å°†ä¸¤ä¸ªå€¼çš„ç»å¯¹å€¼è¿›è¡Œæ¯”è¾ƒï¼Œç„¶åè¿›è¡ŒåŠ å‡æ“ä½œ ï¼Œæœ€åç¬¦å·ä½ç”±ç»å¯¹å€¼å¤§çš„å†³å®šã€‚äºæ˜¯åç å°±äº§ç”Ÿäº†ã€‚ ","date":"2020-05-30","objectID":"/bit/:3:1","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"åç  é™¤ç¬¦å·ä½, åŸç å…¶ä½™ä½å–åè€Œå¾— +0ï¼š0000 0000ï¼Œ-0ï¼š1111 1111 ä»ç„¶æœ‰æ­£0è´Ÿ0ä¹‹åˆ†ã€‚ æ­£æ•°çš„åç å°±æ˜¯åŸç ï¼Œè´Ÿæ•°çš„åç ç­‰äºåŸç é™¤ç¬¦å·ä½ä»¥å¤–æ‰€æœ‰çš„ä½å–å ä¸¾ä¾‹è¯´æ˜ï¼š intç±»å‹çš„ 3 çš„åç æ˜¯ 00000000 00000000 00000000 00000011 å’ŒåŸç ä¸€æ ·æ²¡ä»€ä¹ˆå¯è¯´çš„ intç±»å‹çš„ -3 çš„åç æ˜¯ 11111111 11111111 11111111 11111100 é™¤å¼€ç¬¦å·ä½ æ‰€æœ‰ä½ å–å è§£å†³äº†åŠ å‡è¿ç®—çš„é—®é¢˜ï¼Œä½†è¿˜æ˜¯æœ‰æ­£è´Ÿé›¶ä¹‹åˆ†ï¼Œç„¶åå°±åˆ°è¡¥ç äº† ","date":"2020-05-30","objectID":"/bit/:3:2","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"è¡¥ç  åœ¨åç çš„åŸºç¡€ä¸ŠåŠ 1è€Œå¾— å¯¹åŸç çš„ä¸¤ç§0åŒæ—¶æœ«ä½åŠ 1 +0ï¼š0000 0000ï¼Œ-0ï¼š0000 0000(å› ä¸ºæº¢å‡ºå¯¼è‡´8ä½å…¨0) æ¶ˆé™¤äº†æ­£0è´Ÿ0ä¹‹åˆ«, å¦‚æ­¤ä¸€æ¥, ä¾¿èŠ‚çœå‡ºä¸€ä¸ªæ•°å€¼è¡¨ç¤ºæ–¹å¼1000 0000, ä¸èƒ½æµªè´¹, ç”¨æ¥è¡¨ç¤º-128, -128ç‰¹æ®Šä¹‹å¤„åœ¨äºæ²¡æœ‰ç›¸åº”çš„åç åŸç ã€‚ä¹Ÿå¯ä»¥è¿™æ ·è€ƒè™‘: -1ï¼š 1111 1111 -2ï¼š 1111 1110ï¼ˆåœ¨-1çš„åŸºç¡€ä¸Šå‡1ï¼Œç›´æ¥å°†è¡¥ç å‡1å³å¯ï¼‰ -3ï¼š 1111 1101ï¼ˆåœ¨-2è¡¥ç åŸºç¡€ä¸Šå‡1ï¼Œä»¥ä¸‹ç±»ä¼¼ï¼‰ -4ï¼š 1111 1100 â€¦â€¦ -127ï¼š1000 0001 -128ï¼š1000 0000 å¦‚æ­¤ä»¥æ¥ï¼š8ä½è¡¥ç è¡¨ç¤ºèŒƒå›´æ˜¯-128~+127å› ä¸º0åªæœ‰ä¸€ç§å½¢å¼æ‰€ä»¥ï¼Œä»ç„¶æ˜¯256ä¸ªæ•° è‹¥8ä½ä»£è¡¨æ— ç¬¦å·æ•°, åˆ™è¡¨ç¤ºèŒƒå›´æ˜¯ : 0~255, è¿™å°±æ˜¯ä¸ºä»€ä¹ˆé«˜çº§è¯­è¨€è®²åˆ°æ•°æ®ç±»å‹ï¼Œ æ­£æ•°çš„è¡¥ç ä¸åŸç ç›¸åŒï¼Œè´Ÿæ•°çš„è¡¥ç ä¸º å…¶åŸç é™¤ç¬¦å·ä½å¤–æ‰€æœ‰ä½å–åï¼ˆå¾—åˆ°åç äº†ï¼‰ï¼Œç„¶åæœ€ä½ä½åŠ 1 ","date":"2020-05-30","objectID":"/bit/:3:3","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"åŸç ï¼Œåç ï¼Œè¡¥ç æ€»ç»“ æ­£æ•°çš„åç å’Œè¡¥ç éƒ½ä¸åŸç ç›¸åŒã€‚ è´Ÿæ•°çš„åç ä¸ºå¯¹è¯¥æ•°çš„åŸç é™¤ç¬¦å·ä½å¤–å„ä½å–åã€‚ è´Ÿæ•°çš„è¡¥ç ä¸ºå¯¹è¯¥æ•°çš„åŸç é™¤ç¬¦å·ä½å¤–å„ä½å–åï¼Œç„¶ååœ¨æœ€åä¸€ä½åŠ 1ã€€ ä¼˜ç¼ºç‚¹: åŸç æœ€å¥½ç†è§£äº†ï¼Œä½†æ˜¯åŠ å‡æ³•ä¸å¤Ÿæ–¹ä¾¿ï¼Œè¿˜æœ‰ä¸¤ä¸ªé›¶ã€‚ã€‚ åç ç¨å¾®å›°éš¾ä¸€äº›ï¼Œè§£å†³äº†åŠ å‡æ³•çš„é—®é¢˜ï¼Œä½†è¿˜æ˜¯æœ‰æœ‰ä¸ªé›¶ è¡¥ç ç†è§£å›°éš¾ï¼Œå…¶ä»–å°±æ²¡ä»€ä¹ˆç¼ºç‚¹äº† ","date":"2020-05-30","objectID":"/bit/:3:4","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"å­˜å‚¨ è®¡ç®—æœºä¸­çš„æ•´æ•°æ˜¯ç”¨è¡¥ç å­˜å‚¨çš„ï¼Œæœ€é«˜ä½ä¸ºç¬¦å·ä½ å¦‚æœæœ€é«˜ä½ä¸º0åˆ™ä¸ºæ­£æ•°ï¼Œæ±‚å€¼çš„æ—¶å€™ï¼Œç›´æ¥è½¬ä¸º10è¿›åˆ¶å³å¯ã€‚ æœ€é«˜ä½å¦‚æœä¸º1ä»£è¡¨ä¸ºè´Ÿæ•°ï¼Œæ±‚å€¼çš„æ—¶å€™ï¼Œéœ€è¦å…ˆæŠŠäºŒè¿›åˆ¶çš„å€¼æŒ‰ä½å–åï¼Œç„¶ååŠ 1å¾—åˆ°è´Ÿæ•°ç»å¯¹å€¼(ç›¸åæ•°)çš„äºŒè¿›åˆ¶ç ï¼Œç„¶åè½¬ä¸º10è¿›åˆ¶ï¼ŒåŠ ä¸Šè´Ÿå·å³å¯ã€‚ ","date":"2020-05-30","objectID":"/bit/:3:5","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"åŸç ï¼Œåç ï¼Œè¡¥ç çš„åº”ç”¨ ","date":"2020-05-30","objectID":"/bit/:3:6","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"è´Ÿæ•°çš„åè¿›åˆ¶å’ŒäºŒè¿›åˆ¶è½¬æ¢ ","date":"2020-05-30","objectID":"/bit/:4:0","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"åè¿›åˆ¶è½¬äºŒè¿›åˆ¶ æ–¹æ³•ä¸º: å…ˆè½¬æ¢ä¸ºäºŒè¿›åˆ¶ å¯¹äºŒè¿›åˆ¶æ•°æ±‚å å†å°†è¯¥äºŒè¿›åˆ¶æ•°åŠ ä¸€ æ€»è€Œè¨€ä¹‹: åè¿›åˆ¶æ•°è½¬æ¢ä¸ºäºŒè¿›åˆ¶æ•°æ±‚è¡¥ç å³ä¸ºç»“æœ ä¾‹å­ -32 è½¬æ¢ä¸ºäºŒè¿›åˆ¶ ç¬¬ä¸€æ­¥ï¼š32ï¼ˆ10ï¼‰=00100000ï¼ˆ2ï¼‰ ç¬¬äºŒæ­¥ï¼šæ±‚åï¼š11011111 ç¬¬ä¸‰æ­¥ï¼šåŠ 1:11100000 æ‰€ä»¥-32ï¼ˆ10ï¼‰=11100000ï¼ˆ2ï¼‰ ","date":"2020-05-30","objectID":"/bit/:4:1","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"äºŒè¿›åˆ¶è½¬åè¿›åˆ¶ æ–¹æ³•ä¸º: æ•°å€¼ä¸ºå–å å¯¹è¯¥äºŒè¿›åˆ¶åŠ ä¸€ è½¬æ¢ä¸º10è¿›åˆ¶ ä¾‹å­ 11001000 è½¬æ¢ä¸ºåè¿›åˆ¶ ç¬¬ä¸€æ­¥ï¼ˆæ•°å€¼ä½å–åï¼‰ï¼š 10110111 ç¬¬äºŒæ­¥ï¼ˆåŠ ä¸€ï¼‰ï¼š10111000 ç¬¬ä¸‰æ­¥ï¼ˆåè¿›åˆ¶ï¼‰ï¼š-56 æ‰€ä»¥11001000ï¼ˆ2ï¼‰=-56ï¼ˆ10ï¼‰ ","date":"2020-05-30","objectID":"/bit/:4:2","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"åè¿›åˆ¶æ•°æ±‚åçš„è§„å¾‹ ä¸‹é¢éƒ½æ˜¯ä»¥10è¿›åˆ¶è¡¨ç¤º: ","date":"2020-05-30","objectID":"/bit/:5:0","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"è´Ÿæ•°æ±‚å è´Ÿæ•°æ±‚åç­‰äºå…¶ç»å¯¹å€¼ -1 å¦‚: num = -5 num1 = ~num # 4 ","date":"2020-05-30","objectID":"/bit/:5:1","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"æ­£æ•°æ±‚å æ­£æ•°æ±‚åç­‰äºå…¶å€¼ +1 çš„è´Ÿæ•° å¦‚: num = 4 num1 = ~num # -5 ","date":"2020-05-30","objectID":"/bit/:5:2","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"äºŒè¿›åˆ¶çš„åº”ç”¨åœºæ™¯ ","date":"2020-05-30","objectID":"/bit/:6:0","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"ä½æ“ä½œå®ç°ä¹˜é™¤æ³• æ•° a å‘å³ç§»ä¸€ä½ï¼Œç›¸å½“äºå°† a é™¤ä»¥ 2ï¼›æ•° a å‘å·¦ç§»ä¸€ä½ï¼Œç›¸å½“äºå°† a ä¹˜ä»¥ 2 a = 2 a \u003e\u003e 1 # ---\u003e 1 a \u003c\u003c 1 # ---\u003e 4 ","date":"2020-05-30","objectID":"/bit/:6:1","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"ä½æ“ä½œäº¤æ¢ä¸¤æ•° ä½æ“ä½œäº¤æ¢ä¸¤æ•°å¯ä»¥ä¸éœ€è¦ç¬¬ä¸‰ä¸ªä¸´æ—¶å˜é‡ï¼Œè™½ç„¶æ™®é€šæ“ä½œä¹Ÿå¯ä»¥åšåˆ°ï¼Œä½†æ˜¯æ²¡æœ‰å…¶æ•ˆç‡é«˜ # æ™®é€šæ“ä½œ def swap(a: int, b: int) -\u003e(int,int): a = a + b b = a - b a = a - b return a,b # ä½ä¸æ“ä½œ def swap(a: int, b: int) -\u003e (int, int): \"\"\" äº¤æ¢ä¸¤ä¸ªæ•° :param a: :param b: :return: \"\"\" a ^= b # a = (a^b) b ^= a # b = b ^ a = b ^ a ^ b a ^= b # a = a ^ b = a ^ a ^ b return a, b ","date":"2020-05-30","objectID":"/bit/:6:2","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"ä½æ“ä½œåˆ¤æ–­å¥‡å¶æ•° åªè¦æ ¹æ®æ•°çš„æœ€åä¸€ä½æ˜¯ 0 è¿˜æ˜¯ 1 æ¥å†³å®šå³å¯ï¼Œä¸º 0 å°±æ˜¯å¶æ•°ï¼Œä¸º 1 å°±æ˜¯å¥‡æ•° if(0 == (a \u0026 1)) { //å¶æ•° } ","date":"2020-05-30","objectID":"/bit/:6:3","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"ä½æ“ä½œäº¤æ¢ç¬¦å· äº¤æ¢ç¬¦å·å°†æ­£æ•°å˜æˆè´Ÿæ•°ï¼Œè´Ÿæ•°å˜æˆæ­£æ•° func reversal(a int) int { return ^a + 1 } def reversal(a: int) -\u003e int: \"\"\" æ±‚ç›¸åæ•° :param a: :return: \"\"\" return ~a + 1 æ­£æ•°å–ååŠ 1ï¼Œæ­£å¥½å˜æˆå…¶å¯¹åº”çš„è´Ÿæ•°(è¡¥ç è¡¨ç¤º)ï¼›è´Ÿæ•°å–ååŠ ä¸€ï¼Œåˆ™å˜ä¸ºå…¶åŸç ï¼Œå³æ­£æ•° ","date":"2020-05-30","objectID":"/bit/:6:4","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"ä½æ“ä½œæ±‚ç»å¯¹å€¼ æ­£æ•°çš„ç»å¯¹å€¼æ˜¯å…¶æœ¬èº«ï¼Œè´Ÿæ•°çš„ç»å¯¹å€¼æ­£å¥½å¯ä»¥å¯¹å…¶è¿›è¡Œå–ååŠ ä¸€æ±‚å¾—ï¼Œå³æˆ‘ä»¬é¦–å…ˆåˆ¤æ–­å…¶ç¬¦å·ä½ï¼ˆæ•´æ•°å³ç§» 31 ä½å¾—åˆ° 0ï¼Œè´Ÿæ•°å³ç§» 31 ä½å¾—åˆ° -1,å³ 0xffffffffï¼‰ï¼Œç„¶åæ ¹æ®ç¬¦å·è¿›è¡Œç›¸åº”çš„æ“ä½œ def abs(a: int) -\u003e int: i = a \u003e\u003e 31 result = a if i == 0 else ~a + 1 return result ä¸Šé¢çš„æ“ä½œå¯ä»¥è¿›è¡Œä¼˜åŒ–ï¼Œå¯ä»¥å°† i == 0 çš„æ¡ä»¶åˆ¤æ–­è¯­å¥å»æ‰ã€‚æˆ‘ä»¬éƒ½çŸ¥é“ç¬¦å·ä½ i åªæœ‰ä¸¤ç§æƒ…å†µï¼Œå³ i = 0 ä¸ºæ­£ï¼Œi = -1 ä¸ºè´Ÿã€‚å¯¹äºä»»ä½•æ•°ä¸ 0 å¼‚æˆ–éƒ½ä¼šä¿æŒä¸å˜ï¼Œä¸ -1 å³ 0xffffffff è¿›è¡Œå¼‚æˆ–å°±ç›¸å½“äºå¯¹æ­¤æ•°è¿›è¡Œå–å,å› æ­¤å¯ä»¥å°†ä¸Šé¢ä¸‰ç›®å…ƒç®—ç¬¦è½¬æ¢ä¸º((a^i)-i)ï¼Œå³æ•´æ•°æ—¶ a ä¸ 0 å¼‚æˆ–å¾—åˆ°æœ¬èº«ï¼Œå†å‡å» 0ï¼Œè´Ÿæ•°æ—¶ä¸ 0xffffffff å¼‚æˆ–å°† a è¿›è¡Œå–åï¼Œç„¶ååœ¨åŠ ä¸Š 1ï¼Œå³å‡å» i(i =-1) def abs(a: int) -\u003e int: \"\"\" æ±‚ç»å¯¹å€¼ :param a: :return: \"\"\" i = a \u003e\u003e 31 result = (a ^ i) - i return result or func abs(a int) int { i := a \u003e\u003e 31 return (a ^ i) - i } ","date":"2020-05-30","objectID":"/bit/:6:5","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"ä½æ“ä½œè¿›è¡Œé«˜ä½ä½äº¤æ¢ ç»™å®šä¸€ä¸ª 16 ä½çš„æ— ç¬¦å·æ•´æ•°ï¼Œå°†å…¶é«˜ 8 ä½ä¸ä½ 8 ä½è¿›è¡Œäº¤æ¢ï¼Œæ±‚å‡ºäº¤æ¢åçš„å€¼ï¼Œå¦‚ ä»ä¸Šé¢ç§»ä½æ“ä½œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œåªè¦å°†æ— ç¬¦å·æ•° aÂ»8 å³å¯å¾—åˆ°å…¶é«˜ 8 ä½ç§»åˆ°ä½ 8 ä½ï¼Œé«˜ä½è¡¥ 0ï¼›å°† a Â« 8 å³å¯å°† ä½ 8 ä½ç§»åˆ°é«˜ 8 ä½ï¼Œä½ 8 ä½è¡¥ 0ï¼Œç„¶åå°† a Â» 8 å’Œ aÂ«8 è¿›è¡Œæˆ–æ“ä½œæ—¢å¯æ±‚å¾—äº¤æ¢åçš„ç»“æœ ã€‚ unsigned short a = 34520; a = (a \u003e\u003e 8) | (a \u003c\u003c 8); ","date":"2020-05-30","objectID":"/bit/:6:6","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"ä½æ“ä½œç»Ÿè®¡äºŒè¿›åˆ¶ä¸­ 1 çš„ä¸ªæ•° ç»Ÿè®¡äºŒè¿›åˆ¶1çš„ä¸ªæ•°å¯ä»¥åˆ†åˆ«è·å–æ¯ä¸ªäºŒè¿›åˆ¶ä½æ•°ï¼Œç„¶åå†ç»Ÿè®¡å…¶1çš„ä¸ªæ•°ï¼Œæ­¤æ–¹æ³•æ•ˆç‡æ¯”è¾ƒä½ã€‚ è¿™é‡Œä»‹ç»å¦å¤–ä¸€ç§é«˜æ•ˆçš„æ–¹æ³•ï¼ŒåŒæ ·ä»¥ 34520 ä¸ºä¾‹ï¼Œ æˆ‘ä»¬è®¡ç®—å…¶ a \u0026= (a-1)çš„ç»“æœï¼š ç¬¬ä¸€æ¬¡ï¼šè®¡ç®—å‰ï¼š1000 0110 1101 1000 è®¡ç®—åï¼š1000 0110 1101 0000 ç¬¬äºŒæ¬¡ï¼šè®¡ç®—å‰ï¼š1000 0110 1101 0000 è®¡ç®—åï¼š1000 0110 1100 0000 ç¬¬ä¸‰æ¬¡ï¼šè®¡ç®—å‰ï¼š1000 0110 1100 0000 è®¡ç®—åï¼š1000 0110 1000 0000 æˆ‘ä»¬å‘ç°ï¼Œæ¯è®¡ç®—ä¸€æ¬¡äºŒè¿›åˆ¶ä¸­å°±å°‘äº†ä¸€ä¸ª 1ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢æ–¹æ³•å»ç»Ÿè®¡ï¼šcount = 0 def count_1(a: int) -\u003e int: \"\"\" è®¡ç®—æ•°å€¼çš„äºŒè¿›åˆ¶è¡¨ç¤ºçš„1çš„æ•°é‡ :param a: :return: \"\"\" count = 0 while (a): a = a \u0026 a - 1 count += 1 return count ","date":"2020-05-30","objectID":"/bit/:6:7","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"æ±‚å’Œ ä¸¤æ•°æ±‚å’Œ func add(a int, b int) int { for b != 0 { sum := a ^ b carry := (a \u0026 b) \u003c\u003c 1 a = sum b = carry } return a } ","date":"2020-05-30","objectID":"/bit/:6:8","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"æ¯”ç‰¹ä½è®¡æ•° ç»™å®šä¸€ä¸ªéè´Ÿæ•´æ•° numã€‚å¯¹äº 0 â‰¤ i â‰¤ num èŒƒå›´ä¸­çš„æ¯ä¸ªæ•°å­— i ï¼Œè®¡ç®—å…¶äºŒè¿›åˆ¶æ•°ä¸­çš„ 1 çš„æ•°ç›®å¹¶å°†å®ƒä»¬ä½œä¸ºæ•°ç»„è¿”å›ã€‚ ç¤ºä¾‹ 1: è¾“å…¥: 2 è¾“å‡º: [0,1,1] ç¤ºä¾‹ 2: è¾“å…¥: 5 è¾“å‡º: [0,1,1,2,1,2] def countBits(num: int) -\u003e [int]: result = [0] * (num + 1) for i in range(1, num + 1): result[i] = result[i \u0026 i - 1] + 1 return result func countBits(num int) []int { result := make([]int, num+1) for i := 1; i \u003c num+1 ; i ++ { result[i] = result[i \u0026 (i-1)] + 1 } return result } ","date":"2020-05-30","objectID":"/bit/:6:9","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"å¸¸ç”¨çš„ç‰¹æ®Šçš„æ•° 0xaaaaaaaa = 10101010101010101010101010101010 (å¶æ•°ä½ä¸º1ï¼Œå¥‡æ•°ä½ä¸º0ï¼‰ 0x55555555 = 1010101010101010101010101010101 (å¶æ•°ä½ä¸º0ï¼Œå¥‡æ•°ä½ä¸º1ï¼‰ 0x33333333 = 110011001100110011001100110011 (1å’Œ0æ¯éš”ä¸¤ä½äº¤æ›¿å‡ºç°) 0xcccccccc = 11001100110011001100110011001100Â (0å’Œ1æ¯éš”ä¸¤ä½äº¤æ›¿å‡ºç°) 0x0f0f0f0f = 00001111000011110000111100001111Â (1å’Œ0æ¯éš”å››ä½äº¤æ›¿å‡ºç°) 0xf0f0f0f0 = 11110000111100001111000011110000Â (0å’Œ1æ¯éš”å››ä½äº¤æ›¿å‡ºç°) 0xffffffff = 11111111111111111111111111111111 ","date":"2020-05-30","objectID":"/bit/:7:0","tags":["ç®—æ³•","ä½è¿ç®—","bit"],"title":"ä½è¿ç®—","uri":"/bit/"},{"categories":null,"content":"äºŒå‰æœç´¢æ ‘","date":"2020-05-05","objectID":"/argorithm/binarysearchtree/","tags":["ç®—æ³•","binarySearchTree","äºŒå‰æœç´¢æ ‘"],"title":"äºŒå‰æœç´¢æ ‘","uri":"/argorithm/binarysearchtree/"},{"categories":null,"content":"å®šä¹‰åŠç‰¹ç‚¹ äºŒå‰æŸ¥æ‰¾æ ‘ï¼ˆè‹±è¯­ï¼šBinary Search Treeï¼‰ï¼Œä¹Ÿç§°ä¸º äºŒå‰æœç´¢æ ‘ã€æœ‰åºäºŒå‰æ ‘ï¼ˆOrdered Binary Treeï¼‰æˆ–æ’åºäºŒå‰æ ‘ï¼ˆSorted Binary Treeï¼‰ï¼Œæ˜¯æŒ‡ä¸€æ£µç©ºæ ‘æˆ–è€…å…·æœ‰ä¸‹åˆ—æ€§è´¨çš„äºŒå‰æ ‘ï¼š è‹¥ä»»æ„èŠ‚ç‚¹çš„å·¦å­æ ‘ä¸ç©ºï¼Œåˆ™å·¦å­æ ‘ä¸Šæ‰€æœ‰èŠ‚ç‚¹çš„å€¼å‡å°äºå®ƒçš„æ ¹èŠ‚ç‚¹çš„å€¼ï¼› è‹¥ä»»æ„èŠ‚ç‚¹çš„å³å­æ ‘ä¸ç©ºï¼Œåˆ™å³å­æ ‘ä¸Šæ‰€æœ‰èŠ‚ç‚¹çš„å€¼å‡å¤§äºå®ƒçš„æ ¹èŠ‚ç‚¹çš„å€¼ï¼› ä»»æ„èŠ‚ç‚¹çš„å·¦ã€å³å­æ ‘ä¹Ÿåˆ†åˆ«ä¸ºäºŒå‰æŸ¥æ‰¾æ ‘ï¼› æ²¡æœ‰é”®å€¼ç›¸ç­‰çš„èŠ‚ç‚¹ã€‚ äºŒå‰æŸ¥æ‰¾æ ‘ç›¸æ¯”äºå…¶ä»–æ•°æ®ç»“æ„çš„ä¼˜åŠ¿åœ¨äºæŸ¥æ‰¾ã€æ’å…¥çš„æ—¶é—´å¤æ‚åº¦è¾ƒä½ã€‚ä¸º O(logn)ã€‚äºŒå‰æŸ¥æ‰¾æ ‘æ˜¯åŸºç¡€æ€§æ•°æ®ç»“æ„ï¼Œç”¨äºæ„å»ºæ›´ä¸ºæŠ½è±¡çš„æ•°æ®ç»“æ„ï¼Œå¦‚é›†åˆã€å¤šé‡é›†ã€å…³è”æ•°ç»„ç­‰ã€‚ äºŒå‰æŸ¥æ‰¾æ ‘çš„æŸ¥æ‰¾è¿‡ç¨‹å’Œæ¬¡ä¼˜äºŒå‰æ ‘ç±»ä¼¼ï¼Œé€šå¸¸é‡‡å–äºŒå‰é“¾è¡¨ä½œä¸ºäºŒå‰æŸ¥æ‰¾æ ‘çš„å­˜å‚¨ç»“æ„ã€‚ä¸­åºéå†äºŒå‰æŸ¥æ‰¾æ ‘å¯å¾—åˆ°ä¸€ä¸ªå…³é”®å­—çš„æœ‰åºåºåˆ—ï¼Œä¸€ä¸ªæ— åºåºåˆ—å¯ä»¥é€šè¿‡æ„é€ ä¸€æ£µäºŒå‰æŸ¥æ‰¾æ ‘å˜æˆä¸€ä¸ªæœ‰åºåºåˆ—ï¼Œæ„é€ æ ‘çš„è¿‡ç¨‹å³ä¸ºå¯¹æ— åºåºåˆ—è¿›è¡ŒæŸ¥æ‰¾çš„è¿‡ç¨‹ã€‚æ¯æ¬¡æ’å…¥çš„æ–°çš„ç»“ç‚¹éƒ½æ˜¯äºŒå‰æŸ¥æ‰¾æ ‘ä¸Šæ–°çš„å¶å­ç»“ç‚¹ï¼Œåœ¨è¿›è¡Œæ’å…¥æ“ä½œæ—¶ï¼Œä¸å¿…ç§»åŠ¨å…¶å®ƒç»“ç‚¹ï¼Œåªéœ€æ”¹åŠ¨æŸä¸ªç»“ç‚¹çš„æŒ‡é’ˆï¼Œç”±ç©ºå˜ä¸ºéç©ºå³å¯ã€‚æœç´¢ã€æ’å…¥ã€åˆ é™¤çš„å¤æ‚åº¦ç­‰äºæ ‘é«˜ï¼ŒæœŸæœ› O(\\log n)O(logn)ï¼Œæœ€å O(n)O(n)ï¼ˆæ•°åˆ—æœ‰åºï¼Œæ ‘é€€åŒ–æˆçº¿æ€§è¡¨ï¼‰ã€‚ è™½ç„¶äºŒå‰æŸ¥æ‰¾æ ‘çš„æœ€åæ•ˆç‡æ˜¯ O(n)O(n)ï¼Œä½†å®ƒæ”¯æŒåŠ¨æ€æŸ¥è¯¢ï¼Œä¸”æœ‰å¾ˆå¤šæ”¹è¿›ç‰ˆçš„äºŒå‰æŸ¥æ‰¾æ ‘å¯ä»¥ä½¿æ ‘é«˜ä¸º O(\\log n)O(logn)ï¼Œä»è€Œå°†æœ€åæ•ˆç‡é™è‡³ O(\\log n)O(logn)ï¼Œå¦‚ AVL æ ‘ã€çº¢é»‘æ ‘ç­‰ã€‚ ","date":"2020-05-05","objectID":"/argorithm/binarysearchtree/:1:0","tags":["ç®—æ³•","binarySearchTree","äºŒå‰æœç´¢æ ‘"],"title":"äºŒå‰æœç´¢æ ‘","uri":"/argorithm/binarysearchtree/"},{"categories":null,"content":"å¸¸ç”¨æ“ä½œ ","date":"2020-05-05","objectID":"/argorithm/binarysearchtree/:2:0","tags":["ç®—æ³•","binarySearchTree","äºŒå‰æœç´¢æ ‘"],"title":"äºŒå‰æœç´¢æ ‘","uri":"/argorithm/binarysearchtree/"},{"categories":null,"content":"æ ‘èŠ‚ç‚¹å®šä¹‰: class TreeNode: def __init__(self, val): self.val = val self.left = None self.right = None or type TreeNode struct { Val int Left *TreeNode Right *TreeNode } ","date":"2020-05-05","objectID":"/argorithm/binarysearchtree/:2:1","tags":["ç®—æ³•","binarySearchTree","äºŒå‰æœç´¢æ ‘"],"title":"äºŒå‰æœç´¢æ ‘","uri":"/argorithm/binarysearchtree/"},{"categories":null,"content":"æŸ¥æ‰¾ åœ¨äºŒå‰æœç´¢æ ‘bä¸­æŸ¥æ‰¾xçš„è¿‡ç¨‹ä¸ºï¼š è‹¥bæ˜¯ç©ºæ ‘ï¼Œåˆ™æœç´¢å¤±è´¥ï¼Œå¦åˆ™ï¼š è‹¥xç­‰äºbçš„æ ¹èŠ‚ç‚¹çš„æ•°æ®åŸŸä¹‹å€¼ï¼Œåˆ™æŸ¥æ‰¾æˆåŠŸï¼›å¦åˆ™ï¼š è‹¥xå°äºbçš„æ ¹èŠ‚ç‚¹çš„æ•°æ®åŸŸä¹‹å€¼ï¼Œåˆ™é€’å½’æœç´¢å·¦å­æ ‘ï¼›å¦åˆ™: é€’å½’æŸ¥æ‰¾å³å­æ ‘ ","date":"2020-05-05","objectID":"/argorithm/binarysearchtree/:2:2","tags":["ç®—æ³•","binarySearchTree","äºŒå‰æœç´¢æ ‘"],"title":"äºŒå‰æœç´¢æ ‘","uri":"/argorithm/binarysearchtree/"},{"categories":null,"content":"æ’å…¥ å‘ä¸€ä¸ªäºŒå‰æœç´¢æ ‘bä¸­æ’å…¥ä¸€ä¸ªèŠ‚ç‚¹sçš„ç®—æ³•ï¼Œè¿‡ç¨‹ä¸ºï¼š è‹¥bæ˜¯ç©ºæ ‘ï¼Œåˆ™å°†sæ‰€æŒ‡ç»“ç‚¹ä½œä¸ºæ ¹èŠ‚ç‚¹æ’å…¥ï¼Œå¦åˆ™ï¼š è‹¥s.valç­‰äºbçš„æ ¹èŠ‚ç‚¹çš„æ•°æ®åŸŸä¹‹å€¼ï¼Œåˆ™è¿”å›ï¼Œå¦åˆ™ï¼š è‹¥s.valå°äºbçš„æ ¹èŠ‚ç‚¹çš„æ•°æ®åŸŸä¹‹å€¼ï¼Œåˆ™æŠŠsæ‰€æŒ‡èŠ‚ç‚¹æ’å…¥åˆ°å·¦å­æ ‘ä¸­ï¼Œå¦åˆ™ï¼š æŠŠsæ‰€æŒ‡èŠ‚ç‚¹æ’å…¥åˆ°å³å­æ ‘ä¸­ï¼ˆæ–°æ’å…¥èŠ‚ç‚¹æ€»æ˜¯å¶å­èŠ‚ç‚¹ï¼‰ ","date":"2020-05-05","objectID":"/argorithm/binarysearchtree/:2:3","tags":["ç®—æ³•","binarySearchTree","äºŒå‰æœç´¢æ ‘"],"title":"äºŒå‰æœç´¢æ ‘","uri":"/argorithm/binarysearchtree/"},{"categories":null,"content":"åˆ é™¤ äºŒå‰æœç´¢æ ‘çš„åˆ é™¤æ“ä½œåˆ†ä¸‰ç§æƒ…å†µè®¨è®º: å¦‚æœå¾…åˆ é™¤çš„èŠ‚ç‚¹æ˜¯å¶å­èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå¯ä»¥ç«‹å³è¢«åˆ é™¤ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä¾‹ï¼šåˆ é™¤æ•°æ®ä¸º16çš„èŠ‚ç‚¹ï¼Œæ˜¯å¶å­èŠ‚ç‚¹ï¼Œå¯ä»¥ç›´æ¥åˆ é™¤ å¦‚æœæœ‰ä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œè¦å°†ä¸‹ä¸€ä¸ªå­èŠ‚ç‚¹ä¸Šç§»åˆ°å½“å‰èŠ‚ç‚¹ï¼Œå³æ›¿æ¢ä¹‹ ä¾‹ï¼šåˆ é™¤æ•°æ®ä¸º25çš„èŠ‚ç‚¹ï¼Œå®ƒä¸‹é¢æœ‰å”¯ä¸€ä¸€ä¸ªå­èŠ‚ç‚¹35, ä¸Šç§»åˆ°æ›¿æ¢ä¹‹ å¦‚æœæœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹ï¼Œåˆ™å°†å…¶å³å­æ ‘çš„æœ€å°æ•°æ®ä»£æ›¿æ­¤èŠ‚ç‚¹çš„æ•°æ®ï¼Œå¹¶å°†å…¶å³å­æ ‘çš„æœ€å°æ•°æ®åˆ é™¤ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º ä¾‹ï¼šåˆ é™¤èŠ‚ç‚¹æ•°æ®ä¸º5çš„èŠ‚ç‚¹ï¼Œæ‰¾åˆ°è¢«åˆ é™¤èŠ‚ç‚¹å³å­æ ‘çš„æœ€å°èŠ‚ç‚¹ã€‚éœ€è¦ä¸€ä¸ªä¸´æ—¶å˜é‡successorï¼Œå°†11èŠ‚ç‚¹ä¸‹é¢çš„å­èŠ‚ç‚¹è¿›è¡ŒæŸ¥è¯¢ï¼Œæ‰¾åˆ°å³å­æ ‘æœ€å°èŠ‚ç‚¹7ï¼Œå¹¶æŠŠå³å­æ ‘æœ€å°èŠ‚ç‚¹7æ›¿æ¢è¢«åˆ é™¤èŠ‚ç‚¹ï¼Œç»´æŒäºŒå‰æ ‘ç»“æ„ã€‚å¦‚ä¸‹å›¾ ","date":"2020-05-05","objectID":"/argorithm/binarysearchtree/:2:4","tags":["ç®—æ³•","binarySearchTree","äºŒå‰æœç´¢æ ‘"],"title":"äºŒå‰æœç´¢æ ‘","uri":"/argorithm/binarysearchtree/"},{"categories":null,"content":"éå† å¯ä»¥é‡‡ç”¨å‰åºï¼Œä¸­åºï¼Œååºæ¥éå†è¯¥äºŒå‰æœç´¢æ ‘ï¼Œæˆ–è€…ä½¿ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢çš„æ–¹å¼ã€‚è¿™é‡Œç”¨ä¸­åºéå†æ¥å®ç°ï¼Œå¯ä»¥ä¿è¯æŒ‰ä»å°åˆ°å¤§çš„é¡ºåºæ‰“å°ã€‚ ","date":"2020-05-05","objectID":"/argorithm/binarysearchtree/:2:5","tags":["ç®—æ³•","binarySearchTree","äºŒå‰æœç´¢æ ‘"],"title":"äºŒå‰æœç´¢æ ‘","uri":"/argorithm/binarysearchtree/"},{"categories":null,"content":"æ„é€ ä¸€é¢—äºŒå‰æŸ¥æ‰¾æ ‘ ç”¨ä¸€ç»„æ•°å€¼å»ºé€ ä¸€æ£µäºŒå‰æŸ¥æ‰¾æ ‘çš„åŒæ—¶ï¼Œä¹ŸæŠŠè¿™ç»„æ•°å€¼è¿›è¡Œäº†æ’åºã€‚å…¶æœ€å·®æ—¶é—´å¤æ‚åº¦ä¸º O(n2)ã€‚ä¾‹å¦‚ï¼Œè‹¥è¯¥ç»„æ•°å€¼ç»æ˜¯æœ‰åºçš„ï¼ˆä»å°åˆ°å¤§ï¼‰ï¼Œåˆ™å»ºé€ å‡ºæ¥çš„äºŒå‰æŸ¥æ‰¾æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œéƒ½æ²¡æœ‰å·¦å­æ ‘ ","date":"2020-05-05","objectID":"/argorithm/binarysearchtree/:2:6","tags":["ç®—æ³•","binarySearchTree","äºŒå‰æœç´¢æ ‘"],"title":"äºŒå‰æœç´¢æ ‘","uri":"/argorithm/binarysearchtree/"},{"categories":null,"content":"å¸¸ç”¨æ“ä½œçš„å®ç° pythonç‰ˆ # èŠ‚ç‚¹å®šä¹‰ class TreeNode: def __init__(self, x): self.val = x self.left = None self.right = None # æŸ¥æ‰¾ def search(root: TreeNode, val: int) -\u003e (bool, TreeNode): if root == None: return False, None elif val \u003e root.val: return search(root.right, val) elif val \u003c root.val: return search(root.left, val) else: return True, root # æ’å…¥ def insert(root: TreeNode, node: TreeNode) -\u003e TreeNode: \"\"\"insert inplace\"\"\" if root == None: root = node return root elif node.val \u003e root.val: root.right = insert(root.right, node) else: root.left = insert(root.left, node) return root # åˆ é™¤ def deleteNode(root: TreeNode, key: int) -\u003e TreeNode: \"\"\" :type root: TreeNode :type key: int :rtype: TreeNode \"\"\" if root == None: return None if key \u003c root.val: root.left = deleteNode(root.left, key) elif key \u003e root.val: root.right = deleteNode(root.right, key) else: if root.left == None: return root.right elif root.right == None: return root.left else: min_node = findMinNode(root.right) root.val = min_node.val root.right = deleteNode(root.right, root.val) return root def findMinNode(node: TreeNode) -\u003e TreeNode: while node.left: node = node.left return node # ä¸­åºéå† def traverse_binary_tree(root: TreeNode): if root is None: return traverse_binary_tree(root.left) print(root.val) traverse_binary_tree(root.right) # æ„å»ºäºŒå‰æ ‘ def build_binary_tree(values: [int]): tree = None for v in values: tree = insert(tree, TreeNode(v)) return tree if __name__ == \"__main__\": values = [17, 5, 35, 2, 11, 29, 38, 9, 16, 7] # æ„é€ äºŒå‰æ ‘ node = build_binary_tree(values) # æŸ¥æ‰¾ node_7 = search(node, 35) # éå† traverse_binary_tree(node) # åˆ é™¤ a = deleteNode(node, 5) print() golangç‰ˆ: package main import \"fmt\" type TreeNode struct { Val int Left *TreeNode Right *TreeNode } func main() { values := []int{17, 5, 35, 2, 11, 29, 38, 9, 16, 7} // æµ‹è¯•æ„é€ äºŒå‰æ ‘ node := buildBinarySearchTree(values) // éå† traverseBinarySearchTree(node) // æœç´¢ ok, child := search(node, 11) // åˆ é™¤ new_node := deleteTreenode(node, 35) fmt.Println(new_node) fmt.Println(ok, child) } // æŸ¥æ‰¾ func search(root *TreeNode, val int) (bool, *TreeNode) { if root == nil { return false, nil } if root.Val == val { return true, root } else if root.Val \u003c val { return search(root.Right, val) } else { return search(root.Left, val) } } // æ’å…¥ func insert(root, node *TreeNode) *TreeNode { if root == nil { root = node return root } if root.Val \u003e node.Val { root.Left = insert(root.Left, node) } else { root.Right = insert(root.Right, node) } return root } // åˆ é™¤ func deleteTreenode(root *TreeNode, val int) *TreeNode { if root == nil { return nil } if root.Val \u003e val { root.Left = deleteTreenode(root.Left, val) } else if root.Val \u003c val { root.Right = deleteTreenode(root.Right, val) } else { if root.Left == nil { return root.Right } else if root.Right == nil { return root.Left } else { min_node := findMinNode(root.Right) root.Val = min_node.Val root.Right = deleteTreenode(root.Right, min_node.Val) } } return root } func findMinNode(root *TreeNode) *TreeNode { for root.Left != nil { root = root.Left } return root } // ä¸­åºéå† func traverseBinarySearchTree(root *TreeNode) { if root == nil { return } traverseBinarySearchTree(root.Left) fmt.Println(root.Val) traverseBinarySearchTree(root.Right) } // æ„å»ºäºŒå‰æœç´¢æ ‘ func buildBinarySearchTree(values []int) *TreeNode { var node *TreeNode = nil for _, value := range values { node = insert(node, \u0026TreeNode{Val: value}) } return node } ","date":"2020-05-05","objectID":"/argorithm/binarysearchtree/:3:0","tags":["ç®—æ³•","binarySearchTree","äºŒå‰æœç´¢æ ‘"],"title":"äºŒå‰æœç´¢æ ‘","uri":"/argorithm/binarysearchtree/"},{"categories":null,"content":"æ€§èƒ½åˆ†æ æŸ¥æ‰¾ï¼šæœ€ä½³æƒ…å†µOlog(n), æœ€åæƒ…å†µO(n) æ’å…¥ï¼šæœ€ä½³æƒ…å†µOlog(n), æœ€åæƒ…å†µO(n) åˆ é™¤ï¼šæœ€ä½³æƒ…å†µOlog(n), æœ€åæƒ…å†µO(n) ","date":"2020-05-05","objectID":"/argorithm/binarysearchtree/:4:0","tags":["ç®—æ³•","binarySearchTree","äºŒå‰æœç´¢æ ‘"],"title":"äºŒå‰æœç´¢æ ‘","uri":"/argorithm/binarysearchtree/"},{"categories":null,"content":"äºŒå‰æœç´¢æ ‘","date":"2020-05-05","objectID":"/binarysearchtree/","tags":["ç®—æ³•","binarySearchTree","äºŒå‰æœç´¢æ ‘"],"title":"äºŒå‰æœç´¢æ ‘","uri":"/binarysearchtree/"},{"categories":null,"content":"å®šä¹‰åŠç‰¹ç‚¹ äºŒå‰æŸ¥æ‰¾æ ‘ï¼ˆè‹±è¯­ï¼šBinary Search Treeï¼‰ï¼Œä¹Ÿç§°ä¸º äºŒå‰æœç´¢æ ‘ã€æœ‰åºäºŒå‰æ ‘ï¼ˆOrdered Binary Treeï¼‰æˆ–æ’åºäºŒå‰æ ‘ï¼ˆSorted Binary Treeï¼‰ï¼Œæ˜¯æŒ‡ä¸€æ£µç©ºæ ‘æˆ–è€…å…·æœ‰ä¸‹åˆ—æ€§è´¨çš„äºŒå‰æ ‘ï¼š è‹¥ä»»æ„èŠ‚ç‚¹çš„å·¦å­æ ‘ä¸ç©ºï¼Œåˆ™å·¦å­æ ‘ä¸Šæ‰€æœ‰èŠ‚ç‚¹çš„å€¼å‡å°äºå®ƒçš„æ ¹èŠ‚ç‚¹çš„å€¼ï¼› è‹¥ä»»æ„èŠ‚ç‚¹çš„å³å­æ ‘ä¸ç©ºï¼Œåˆ™å³å­æ ‘ä¸Šæ‰€æœ‰èŠ‚ç‚¹çš„å€¼å‡å¤§äºå®ƒçš„æ ¹èŠ‚ç‚¹çš„å€¼ï¼› ä»»æ„èŠ‚ç‚¹çš„å·¦ã€å³å­æ ‘ä¹Ÿåˆ†åˆ«ä¸ºäºŒå‰æŸ¥æ‰¾æ ‘ï¼› æ²¡æœ‰é”®å€¼ç›¸ç­‰çš„èŠ‚ç‚¹ã€‚ äºŒå‰æŸ¥æ‰¾æ ‘ç›¸æ¯”äºå…¶ä»–æ•°æ®ç»“æ„çš„ä¼˜åŠ¿åœ¨äºæŸ¥æ‰¾ã€æ’å…¥çš„æ—¶é—´å¤æ‚åº¦è¾ƒä½ã€‚ä¸º O(logn)ã€‚äºŒå‰æŸ¥æ‰¾æ ‘æ˜¯åŸºç¡€æ€§æ•°æ®ç»“æ„ï¼Œç”¨äºæ„å»ºæ›´ä¸ºæŠ½è±¡çš„æ•°æ®ç»“æ„ï¼Œå¦‚é›†åˆã€å¤šé‡é›†ã€å…³è”æ•°ç»„ç­‰ã€‚ äºŒå‰æŸ¥æ‰¾æ ‘çš„æŸ¥æ‰¾è¿‡ç¨‹å’Œæ¬¡ä¼˜äºŒå‰æ ‘ç±»ä¼¼ï¼Œé€šå¸¸é‡‡å–äºŒå‰é“¾è¡¨ä½œä¸ºäºŒå‰æŸ¥æ‰¾æ ‘çš„å­˜å‚¨ç»“æ„ã€‚ä¸­åºéå†äºŒå‰æŸ¥æ‰¾æ ‘å¯å¾—åˆ°ä¸€ä¸ªå…³é”®å­—çš„æœ‰åºåºåˆ—ï¼Œä¸€ä¸ªæ— åºåºåˆ—å¯ä»¥é€šè¿‡æ„é€ ä¸€æ£µäºŒå‰æŸ¥æ‰¾æ ‘å˜æˆä¸€ä¸ªæœ‰åºåºåˆ—ï¼Œæ„é€ æ ‘çš„è¿‡ç¨‹å³ä¸ºå¯¹æ— åºåºåˆ—è¿›è¡ŒæŸ¥æ‰¾çš„è¿‡ç¨‹ã€‚æ¯æ¬¡æ’å…¥çš„æ–°çš„ç»“ç‚¹éƒ½æ˜¯äºŒå‰æŸ¥æ‰¾æ ‘ä¸Šæ–°çš„å¶å­ç»“ç‚¹ï¼Œåœ¨è¿›è¡Œæ’å…¥æ“ä½œæ—¶ï¼Œä¸å¿…ç§»åŠ¨å…¶å®ƒç»“ç‚¹ï¼Œåªéœ€æ”¹åŠ¨æŸä¸ªç»“ç‚¹çš„æŒ‡é’ˆï¼Œç”±ç©ºå˜ä¸ºéç©ºå³å¯ã€‚æœç´¢ã€æ’å…¥ã€åˆ é™¤çš„å¤æ‚åº¦ç­‰äºæ ‘é«˜ï¼ŒæœŸæœ› O(\\log n)O(logn)ï¼Œæœ€å O(n)O(n)ï¼ˆæ•°åˆ—æœ‰åºï¼Œæ ‘é€€åŒ–æˆçº¿æ€§è¡¨ï¼‰ã€‚ è™½ç„¶äºŒå‰æŸ¥æ‰¾æ ‘çš„æœ€åæ•ˆç‡æ˜¯ O(n)O(n)ï¼Œä½†å®ƒæ”¯æŒåŠ¨æ€æŸ¥è¯¢ï¼Œä¸”æœ‰å¾ˆå¤šæ”¹è¿›ç‰ˆçš„äºŒå‰æŸ¥æ‰¾æ ‘å¯ä»¥ä½¿æ ‘é«˜ä¸º O(\\log n)O(logn)ï¼Œä»è€Œå°†æœ€åæ•ˆç‡é™è‡³ O(\\log n)O(logn)ï¼Œå¦‚ AVL æ ‘ã€çº¢é»‘æ ‘ç­‰ã€‚ ","date":"2020-05-05","objectID":"/binarysearchtree/:1:0","tags":["ç®—æ³•","binarySearchTree","äºŒå‰æœç´¢æ ‘"],"title":"äºŒå‰æœç´¢æ ‘","uri":"/binarysearchtree/"},{"categories":null,"content":"å¸¸ç”¨æ“ä½œ ","date":"2020-05-05","objectID":"/binarysearchtree/:2:0","tags":["ç®—æ³•","binarySearchTree","äºŒå‰æœç´¢æ ‘"],"title":"äºŒå‰æœç´¢æ ‘","uri":"/binarysearchtree/"},{"categories":null,"content":"æ ‘èŠ‚ç‚¹å®šä¹‰: class TreeNode: def __init__(self, val): self.val = val self.left = None self.right = None or type TreeNode struct { Val int Left *TreeNode Right *TreeNode } ","date":"2020-05-05","objectID":"/binarysearchtree/:2:1","tags":["ç®—æ³•","binarySearchTree","äºŒå‰æœç´¢æ ‘"],"title":"äºŒå‰æœç´¢æ ‘","uri":"/binarysearchtree/"},{"categories":null,"content":"æŸ¥æ‰¾ åœ¨äºŒå‰æœç´¢æ ‘bä¸­æŸ¥æ‰¾xçš„è¿‡ç¨‹ä¸ºï¼š è‹¥bæ˜¯ç©ºæ ‘ï¼Œåˆ™æœç´¢å¤±è´¥ï¼Œå¦åˆ™ï¼š è‹¥xç­‰äºbçš„æ ¹èŠ‚ç‚¹çš„æ•°æ®åŸŸä¹‹å€¼ï¼Œåˆ™æŸ¥æ‰¾æˆåŠŸï¼›å¦åˆ™ï¼š è‹¥xå°äºbçš„æ ¹èŠ‚ç‚¹çš„æ•°æ®åŸŸä¹‹å€¼ï¼Œåˆ™é€’å½’æœç´¢å·¦å­æ ‘ï¼›å¦åˆ™: é€’å½’æŸ¥æ‰¾å³å­æ ‘ ","date":"2020-05-05","objectID":"/binarysearchtree/:2:2","tags":["ç®—æ³•","binarySearchTree","äºŒå‰æœç´¢æ ‘"],"title":"äºŒå‰æœç´¢æ ‘","uri":"/binarysearchtree/"},{"categories":null,"content":"æ’å…¥ å‘ä¸€ä¸ªäºŒå‰æœç´¢æ ‘bä¸­æ’å…¥ä¸€ä¸ªèŠ‚ç‚¹sçš„ç®—æ³•ï¼Œè¿‡ç¨‹ä¸ºï¼š è‹¥bæ˜¯ç©ºæ ‘ï¼Œåˆ™å°†sæ‰€æŒ‡ç»“ç‚¹ä½œä¸ºæ ¹èŠ‚ç‚¹æ’å…¥ï¼Œå¦åˆ™ï¼š è‹¥s.valç­‰äºbçš„æ ¹èŠ‚ç‚¹çš„æ•°æ®åŸŸä¹‹å€¼ï¼Œåˆ™è¿”å›ï¼Œå¦åˆ™ï¼š è‹¥s.valå°äºbçš„æ ¹èŠ‚ç‚¹çš„æ•°æ®åŸŸä¹‹å€¼ï¼Œåˆ™æŠŠsæ‰€æŒ‡èŠ‚ç‚¹æ’å…¥åˆ°å·¦å­æ ‘ä¸­ï¼Œå¦åˆ™ï¼š æŠŠsæ‰€æŒ‡èŠ‚ç‚¹æ’å…¥åˆ°å³å­æ ‘ä¸­ï¼ˆæ–°æ’å…¥èŠ‚ç‚¹æ€»æ˜¯å¶å­èŠ‚ç‚¹ï¼‰ ","date":"2020-05-05","objectID":"/binarysearchtree/:2:3","tags":["ç®—æ³•","binarySearchTree","äºŒå‰æœç´¢æ ‘"],"title":"äºŒå‰æœç´¢æ ‘","uri":"/binarysearchtree/"},{"categories":null,"content":"åˆ é™¤ äºŒå‰æœç´¢æ ‘çš„åˆ é™¤æ“ä½œåˆ†ä¸‰ç§æƒ…å†µè®¨è®º: å¦‚æœå¾…åˆ é™¤çš„èŠ‚ç‚¹æ˜¯å¶å­èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå¯ä»¥ç«‹å³è¢«åˆ é™¤ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä¾‹ï¼šåˆ é™¤æ•°æ®ä¸º16çš„èŠ‚ç‚¹ï¼Œæ˜¯å¶å­èŠ‚ç‚¹ï¼Œå¯ä»¥ç›´æ¥åˆ é™¤ å¦‚æœæœ‰ä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œè¦å°†ä¸‹ä¸€ä¸ªå­èŠ‚ç‚¹ä¸Šç§»åˆ°å½“å‰èŠ‚ç‚¹ï¼Œå³æ›¿æ¢ä¹‹ ä¾‹ï¼šåˆ é™¤æ•°æ®ä¸º25çš„èŠ‚ç‚¹ï¼Œå®ƒä¸‹é¢æœ‰å”¯ä¸€ä¸€ä¸ªå­èŠ‚ç‚¹35, ä¸Šç§»åˆ°æ›¿æ¢ä¹‹ å¦‚æœæœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹ï¼Œåˆ™å°†å…¶å³å­æ ‘çš„æœ€å°æ•°æ®ä»£æ›¿æ­¤èŠ‚ç‚¹çš„æ•°æ®ï¼Œå¹¶å°†å…¶å³å­æ ‘çš„æœ€å°æ•°æ®åˆ é™¤ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º ä¾‹ï¼šåˆ é™¤èŠ‚ç‚¹æ•°æ®ä¸º5çš„èŠ‚ç‚¹ï¼Œæ‰¾åˆ°è¢«åˆ é™¤èŠ‚ç‚¹å³å­æ ‘çš„æœ€å°èŠ‚ç‚¹ã€‚éœ€è¦ä¸€ä¸ªä¸´æ—¶å˜é‡successorï¼Œå°†11èŠ‚ç‚¹ä¸‹é¢çš„å­èŠ‚ç‚¹è¿›è¡ŒæŸ¥è¯¢ï¼Œæ‰¾åˆ°å³å­æ ‘æœ€å°èŠ‚ç‚¹7ï¼Œå¹¶æŠŠå³å­æ ‘æœ€å°èŠ‚ç‚¹7æ›¿æ¢è¢«åˆ é™¤èŠ‚ç‚¹ï¼Œç»´æŒäºŒå‰æ ‘ç»“æ„ã€‚å¦‚ä¸‹å›¾ ","date":"2020-05-05","objectID":"/binarysearchtree/:2:4","tags":["ç®—æ³•","binarySearchTree","äºŒå‰æœç´¢æ ‘"],"title":"äºŒå‰æœç´¢æ ‘","uri":"/binarysearchtree/"},{"categories":null,"content":"éå† å¯ä»¥é‡‡ç”¨å‰åºï¼Œä¸­åºï¼Œååºæ¥éå†è¯¥äºŒå‰æœç´¢æ ‘ï¼Œæˆ–è€…ä½¿ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢çš„æ–¹å¼ã€‚è¿™é‡Œç”¨ä¸­åºéå†æ¥å®ç°ï¼Œå¯ä»¥ä¿è¯æŒ‰ä»å°åˆ°å¤§çš„é¡ºåºæ‰“å°ã€‚ ","date":"2020-05-05","objectID":"/binarysearchtree/:2:5","tags":["ç®—æ³•","binarySearchTree","äºŒå‰æœç´¢æ ‘"],"title":"äºŒå‰æœç´¢æ ‘","uri":"/binarysearchtree/"},{"categories":null,"content":"æ„é€ ä¸€é¢—äºŒå‰æŸ¥æ‰¾æ ‘ ç”¨ä¸€ç»„æ•°å€¼å»ºé€ ä¸€æ£µäºŒå‰æŸ¥æ‰¾æ ‘çš„åŒæ—¶ï¼Œä¹ŸæŠŠè¿™ç»„æ•°å€¼è¿›è¡Œäº†æ’åºã€‚å…¶æœ€å·®æ—¶é—´å¤æ‚åº¦ä¸º O(n2)ã€‚ä¾‹å¦‚ï¼Œè‹¥è¯¥ç»„æ•°å€¼ç»æ˜¯æœ‰åºçš„ï¼ˆä»å°åˆ°å¤§ï¼‰ï¼Œåˆ™å»ºé€ å‡ºæ¥çš„äºŒå‰æŸ¥æ‰¾æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œéƒ½æ²¡æœ‰å·¦å­æ ‘ ","date":"2020-05-05","objectID":"/binarysearchtree/:2:6","tags":["ç®—æ³•","binarySearchTree","äºŒå‰æœç´¢æ ‘"],"title":"äºŒå‰æœç´¢æ ‘","uri":"/binarysearchtree/"},{"categories":null,"content":"å¸¸ç”¨æ“ä½œçš„å®ç° pythonç‰ˆ # èŠ‚ç‚¹å®šä¹‰ class TreeNode: def __init__(self, x): self.val = x self.left = None self.right = None # æŸ¥æ‰¾ def search(root: TreeNode, val: int) -\u003e (bool, TreeNode): if root == None: return False, None elif val \u003e root.val: return search(root.right, val) elif val \u003c root.val: return search(root.left, val) else: return True, root # æ’å…¥ def insert(root: TreeNode, node: TreeNode) -\u003e TreeNode: \"\"\"insert inplace\"\"\" if root == None: root = node return root elif node.val \u003e root.val: root.right = insert(root.right, node) else: root.left = insert(root.left, node) return root # åˆ é™¤ def deleteNode(root: TreeNode, key: int) -\u003e TreeNode: \"\"\" :type root: TreeNode :type key: int :rtype: TreeNode \"\"\" if root == None: return None if key \u003c root.val: root.left = deleteNode(root.left, key) elif key \u003e root.val: root.right = deleteNode(root.right, key) else: if root.left == None: return root.right elif root.right == None: return root.left else: min_node = findMinNode(root.right) root.val = min_node.val root.right = deleteNode(root.right, root.val) return root def findMinNode(node: TreeNode) -\u003e TreeNode: while node.left: node = node.left return node # ä¸­åºéå† def traverse_binary_tree(root: TreeNode): if root is None: return traverse_binary_tree(root.left) print(root.val) traverse_binary_tree(root.right) # æ„å»ºäºŒå‰æ ‘ def build_binary_tree(values: [int]): tree = None for v in values: tree = insert(tree, TreeNode(v)) return tree if __name__ == \"__main__\": values = [17, 5, 35, 2, 11, 29, 38, 9, 16, 7] # æ„é€ äºŒå‰æ ‘ node = build_binary_tree(values) # æŸ¥æ‰¾ node_7 = search(node, 35) # éå† traverse_binary_tree(node) # åˆ é™¤ a = deleteNode(node, 5) print() golangç‰ˆ: package main import \"fmt\" type TreeNode struct { Val int Left *TreeNode Right *TreeNode } func main() { values := []int{17, 5, 35, 2, 11, 29, 38, 9, 16, 7} // æµ‹è¯•æ„é€ äºŒå‰æ ‘ node := buildBinarySearchTree(values) // éå† traverseBinarySearchTree(node) // æœç´¢ ok, child := search(node, 11) // åˆ é™¤ new_node := deleteTreenode(node, 35) fmt.Println(new_node) fmt.Println(ok, child) } // æŸ¥æ‰¾ func search(root *TreeNode, val int) (bool, *TreeNode) { if root == nil { return false, nil } if root.Val == val { return true, root } else if root.Val \u003c val { return search(root.Right, val) } else { return search(root.Left, val) } } // æ’å…¥ func insert(root, node *TreeNode) *TreeNode { if root == nil { root = node return root } if root.Val \u003e node.Val { root.Left = insert(root.Left, node) } else { root.Right = insert(root.Right, node) } return root } // åˆ é™¤ func deleteTreenode(root *TreeNode, val int) *TreeNode { if root == nil { return nil } if root.Val \u003e val { root.Left = deleteTreenode(root.Left, val) } else if root.Val \u003c val { root.Right = deleteTreenode(root.Right, val) } else { if root.Left == nil { return root.Right } else if root.Right == nil { return root.Left } else { min_node := findMinNode(root.Right) root.Val = min_node.Val root.Right = deleteTreenode(root.Right, min_node.Val) } } return root } func findMinNode(root *TreeNode) *TreeNode { for root.Left != nil { root = root.Left } return root } // ä¸­åºéå† func traverseBinarySearchTree(root *TreeNode) { if root == nil { return } traverseBinarySearchTree(root.Left) fmt.Println(root.Val) traverseBinarySearchTree(root.Right) } // æ„å»ºäºŒå‰æœç´¢æ ‘ func buildBinarySearchTree(values []int) *TreeNode { var node *TreeNode = nil for _, value := range values { node = insert(node, \u0026TreeNode{Val: value}) } return node } ","date":"2020-05-05","objectID":"/binarysearchtree/:3:0","tags":["ç®—æ³•","binarySearchTree","äºŒå‰æœç´¢æ ‘"],"title":"äºŒå‰æœç´¢æ ‘","uri":"/binarysearchtree/"},{"categories":null,"content":"æ€§èƒ½åˆ†æ æŸ¥æ‰¾ï¼šæœ€ä½³æƒ…å†µOlog(n), æœ€åæƒ…å†µO(n) æ’å…¥ï¼šæœ€ä½³æƒ…å†µOlog(n), æœ€åæƒ…å†µO(n) åˆ é™¤ï¼šæœ€ä½³æƒ…å†µOlog(n), æœ€åæƒ…å†µO(n) ","date":"2020-05-05","objectID":"/binarysearchtree/:4:0","tags":["ç®—æ³•","binarySearchTree","äºŒå‰æœç´¢æ ‘"],"title":"äºŒå‰æœç´¢æ ‘","uri":"/binarysearchtree/"},{"categories":null,"content":"How to run jenkins on kubernetes","date":"2020-02-08","objectID":"/opensrouce/k8s_jenkins/","tags":["kubernetes","jenkins"],"title":"How to run jenkins on kubernetes","uri":"/opensrouce/k8s_jenkins/"},{"categories":null,"content":"ä½œç”¨ å¦‚ä½•åœ¨Kubernetesç¯å¢ƒä¸­è¿è¡Œjenkins ","date":"2020-02-08","objectID":"/opensrouce/k8s_jenkins/:1:0","tags":["kubernetes","jenkins"],"title":"How to run jenkins on kubernetes","uri":"/opensrouce/k8s_jenkins/"},{"categories":null,"content":"é¡¹ç›®åœ°å€ https://github.com/russellgao/k8s_jenkins ","date":"2020-02-08","objectID":"/opensrouce/k8s_jenkins/:2:0","tags":["kubernetes","jenkins"],"title":"How to run jenkins on kubernetes","uri":"/opensrouce/k8s_jenkins/"},{"categories":null,"content":"å‚è€ƒ https://mp.weixin.qq.com/s/7YFlmcUH5iOB2XOBIZ2_rA ","date":"2020-02-08","objectID":"/opensrouce/k8s_jenkins/:3:0","tags":["kubernetes","jenkins"],"title":"How to run jenkins on kubernetes","uri":"/opensrouce/k8s_jenkins/"},{"categories":null,"content":"åœ¨k8s ä¸­è¿è¡ŒEKL","date":"2020-01-04","objectID":"/opensrouce/k8s_elk/","tags":["kubernetes","ELK"],"title":"ELK stack on kubernetes","uri":"/opensrouce/k8s_elk/"},{"categories":null,"content":"ä½œç”¨ å¦‚ä½•åœ¨Kubernetesç¯å¢ƒä¸­è¿è¡ŒELK Stack ","date":"2020-01-04","objectID":"/opensrouce/k8s_elk/:1:0","tags":["kubernetes","ELK"],"title":"ELK stack on kubernetes","uri":"/opensrouce/k8s_elk/"},{"categories":null,"content":"é¡¹ç›®åœ°å€ https://github.com/russellgao/k8s_elk ","date":"2020-01-04","objectID":"/opensrouce/k8s_elk/:2:0","tags":["kubernetes","ELK"],"title":"ELK stack on kubernetes","uri":"/opensrouce/k8s_elk/"},{"categories":null,"content":"ç”¨æ³• manifests Can run in production environment experimental In the experimental stage ä½¿ç”¨ä¹‹å‰éœ€è¦ä¿®æ”¹å„ä¸ªyamlæ–‡ä»¶çš„Storageï¼ŒServiceç›¸å…³çš„å‚æ•°ï¼Œæ ¹æ®å®é™…æƒ…å†µé€‰æ‹©åˆé€‚çš„ä»‹è´¨ï¼Œä¿®æ”¹å®Œä¹‹åæ‰§è¡Œkubectl -f manifests å³å¯ã€‚ è¯¦ç»†ä¿¡æ¯å‚è€ƒ github ","date":"2020-01-04","objectID":"/opensrouce/k8s_elk/:3:0","tags":["kubernetes","ELK"],"title":"ELK stack on kubernetes","uri":"/opensrouce/k8s_elk/"},{"categories":null,"content":"æ”¯æŒçš„ç»„ä»¶ es logstash kibana kafka zookeeper ","date":"2020-01-04","objectID":"/opensrouce/k8s_elk/:4:0","tags":["kubernetes","ELK"],"title":"ELK stack on kubernetes","uri":"/opensrouce/k8s_elk/"},{"categories":null,"content":"More https://mp.weixin.qq.com/s/93_Jf8P69Q0nkw1Ip7MsFQ ","date":"2020-01-04","objectID":"/opensrouce/k8s_elk/:5:0","tags":["kubernetes","ELK"],"title":"ELK stack on kubernetes","uri":"/opensrouce/k8s_elk/"}]